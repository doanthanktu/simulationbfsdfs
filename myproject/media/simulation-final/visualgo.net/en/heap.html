<!DOCTYPE html>
<html lang="en">

<!-- Mirrored from visualgo.net/en/heap by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 16 Dec 2023 15:17:01 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8">
<meta name="description" content="A Binary (Max) Heap is a complete binary tree that maintains the Max Heap property. Binary Heap is one possible data structure to model an efficient Priority Queue (PQ) Abstract Data Type (ADT). In a PQ, each element has a &quot;priority&quot; and an element with higher priority is served before an element with lower priority (ties are either simply resolved arbitrarily or broken with standard First-In First-Out (FIFO) rule as with a normal Queue). Try clicking ExtractMax() for a sample animation on extracting the max value of random Binary Heap above. To focus the discussion scope, this visualization show a Binary Max Heap of integers where duplicates are allowed. See this for an easy conversion to Binary Min Heap. Generally, any other objects that can be compared can be stored in a Binary Max Heap, e.g., Binary Max Heap of floating points, etc.">
<meta name="keywords" content="Binary Max Min Heap Priority Queue">
 
<meta name="csrf-token" content="dOvHLDgQSeBxDYich7PEZml1cYPqAYZaOAN2Xn3H">
<meta http-equiv="X-UA-Compatible" content="IE=EDGE">
<meta property="og:image" content="../img/png/heap.png">
<title>Binary Heap (Priority Queue) - VisuAlgo</title>
<link rel="icon" href="../img/favicon.png" type="image/x-icon">
<link rel="shortcut icon" href="../img/favicon.png" type="image/x-icon">
<link rel="apple-touch-icon" href="../img/favicon.png">
<link rel="apple-touch-icon" sizes="72x72" href="../img/favicon.png">
<link rel="apple-touch-icon" sizes="114x114" href="../img/favicon.png">
<link rel="stylesheet" href="../css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="../fonts/silkscreen/stylesheet.css">
<link rel="stylesheet" type="text/css" href="../css/common-1.0.2.css">
<link rel="stylesheet" href="../css/viz-1.0.4.css">
<link rel="stylesheet" href="../css/visual.css">
<link rel="stylesheet" href="../css/drawgraph-1.0.2.css">
<style>
      #e-lecture {
        top: 45px;
        right: 130px;
        width: 400px;
        display: block;
        background: none;
        /*overflow: normal;*/
        white-space: normal;
        text-align: right;
        color: black; font-weight: bold; font-size: 20px;
        z-index: 8001;
      }
      #e-lecture-timeline {
        top: 80px;
        right: 130px;
        display: flex;
        position: absolute;
        z-index: 10000;
      }
      .e-lecture-timeline-slide {
        height: 5px;
        width: 2px;
        background: black;
        float: left;
      }
      .e-lecture-timeline-checkpoint {
        height: 20px;
        width: 3px;
        margin-left: 2px;
        margin-top: -7.5px;
        background: black;
        float: left;
      }

      #e-lecture-f1map {
        top: 102.5px;
        right: 130px;
        display: flex;
        position: absolute;
        z-index: 10000;
      }

      .e-lecture-f1map-sector {
        flex-grow: 1;
        background: black;
        float: left;
        height: 5px;
        margin-right: 1px;
      }

      .e-lecture-f1map-sector:last-child {
        margin-right: 0px;
      }

      .electure-prev, .electure-next { /* force update, copied from viz.css */
        position: absolute;
        /* bottom: -12px; */
        top: -20px;
        /*bottom: '';*/
        padding: 3px 8px;
        background: #999;
        color: white;
        cursor: pointer;
        border-radius: 2px;
      }

      .electure-read-status {
        position: absolute;
        bottom: 4px;
        right: 4px;
        font-size: 14px;
        cursor: default;
        color: #00FF7F;
        display: none;
      }

      .electure-prev {
        left: -10px;
        /* right: 30px; */
      }
      .electure-next {
        right: -10px;
        color: white;
      }
      .electure-print, .electure-end {
        position: fixed;
        top: 45px;
        height: 20px;
        width: 17px;
        right: 80px;
        padding: 3px 8px;
        background: #999;
        color: white;
        cursor: pointer;
        border-radius: 2px;
        text-align: center;
      }
      .electure-end {
        right: 45px; /* beside the X */
      }

      #change-lang-popup {
        position: fixed;
        background: green;
        left: 40px;
        top: 50px;
        width: 250px;
        height: 125px;
        border: transparent;
        border-radius: 10px;
        padding: 10px 20px;
        z-index: 9000;
      }

      #change-lang-popup p {
        font-size: medium;
        color: white;
        line-height: 2;
        font-family: "PT Sans", sans-serif;
      }

      #change-lang-popup-btn {
        text-decoration: underline;
        margin-left: 50px;
      }

      #change-lang-popup-btn:hover {
        cursor: pointer;
      }

      #rotateDeviceOverlay {
        z-index: 10000;
        width: 90%;
        height: 100%;
        align-items: center;
        justify-content: center;
        background-color: white;
        position: fixed;
        left: 0;
        top: 0;
        bottom: 0;
        right: 0;
        display: flex;
        padding-right: 5%;
        padding-left: 5%;
        overflow: hidden;
      }

      #mobile-playback-overlay {
        z-index: 9600;
        width: 90%;
        height: 100%;
        align-items: center;
        justify-content: center;
        gap: 100px;
        background-color: black;
        position: fixed;
        left: 0;
        top: 0;
        bottom: 0;
        right: 0;
        display: flex;
        padding-right: 5%;
        padding-left: 5%;
        opacity: 0.3;
        overflow: hidden;
      }
      .mobile-playback-item {
        min-width: 2.5%;
        max-width: 35px;
      }
      .mobile-playback-item img {
        width: 100%
      }
      .mobile-playback-label {
        opacity: 0;
        color: white;
        font-size: 25px;
        font-weight: bold;
        min-width: 1.5%;
        max-width: 25px;
        transition: opacity 0.25s ease-out;
        -webkit-backface-visibility: hidden;
      }
      #mobile-playback-rewind-label {
        margin-right: -70px;
      }
      #mobile-playback-forward-label {
        margin-left: -70px;
      }
      #viz-speed-value {
          font-size: 15px;
          width: 10%;
      }

      #scale {
        position: fixed;
        left: 5px;
      }
    </style>
<style>
/* copied here from common.css (perhaps need to use version numbering) until caches worldwide settles */
#reload-mobile-popup, #message-popup { /* #gdpr-popup, */
  position: fixed;
  left: 50%;
  transform: translateX(-50%);
  min-width: 320px;
  bottom: 62px;
  height: 300px;
  background-color: #0275d8;
  border-radius: 15px;
  padding: 30px 40px;
  z-index: 9500;
}
#reload-mobile-popup {
  background-color: green;
  height: 200px;
}
#message-popup {
  z-index: 9000;
  width: 40%;
  height: 130px;
  background-color: #d9534f;
}

#reload-mobile-popup p, #message-popup p { /* #gdpr-popup p, */
  font-size: large;
  color: white;
  line-height: 2;
  font-family: "PT Sans", sans-serif;
}

#reload-mobile-popup .inner-button, #message-popup .inner-button { /* #gdpr-popup .gdpr-button, */
  border: white solid 2px;
  border-radius: 4px;
  font-weight: bold;
  font-size: x-large;
  padding: 2px 8px;
  color: white;
  width: 90px;
  text-align: center;
  position: absolute;
  letter-spacing: 1px;
  text-decoration: none;
  cursor: pointer;
}

#gdpr-accept, #reload-mobile-button, #dismiss-message-btn {
  bottom: 30px;
  right: 40px;
}

#gdpr-reject, #cancel-reload-mobile-button {
  bottom: 30px;
  right: 170px;
}
    </style>
</head>
<body>
<div id="body-container" style="display: flex; flex-direction: column; min-height: 100vh;">
<style>
  #topbar {
    background-color: rgb(0,0,0);
    font-family: "PT Sans", sans-serif;
    font-size: 13px;
    height: 40px;

    padding-left: 40px;
    padding-right: 40px;

    display: flex;
    flex-wrap: wrap;
    align-items: center;
    position: relative;
    justify-content: flex-start;
  }

  #topbar a:hover {
    text-decoration: none;
  }

  #account-dropdown-btn {
    color: #198754;
    font-size: 1rem;
    padding: 0 0.5rem;
    margin-left: 0.5rem;

    border: 2px solid;
    border-radius: 0.25rem;
    height: 24px;
    line-height: 1.5;
  }

  #account-dropdown-btn:hover {
    color: #0a58ca!important;
    border-color: #198754;
    text-decoration: none;
  }

  #login-button {
    color: #198754;
    font-size: 1rem;
    padding: 0 0.5rem;
    margin-left: 0.5rem;

    border: 2px solid;
    border-radius: 0.25rem;

    height: 24px;
    line-height: 1.5;
  }

  #login-button a:hover {
    color: #0a58ca!important;
    text-decoration: none;
  }

  #account-dropdown-menu {
    display: none;
    position: absolute;
    background-color: white;
    z-index: 1000;
    min-width: 10rem;
    padding: 0.5rem 0;
    margin: 0;
    font-size: 1rem;
    color: rgb(0,0,0);
    text-align: left;
    list-style: none;
    background-clip: padding-box;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 0.25rem;
    top: 45px;
    right: 40px;
    line-height: 1.5;
  }

  .account-dropdown-item {
    display: block;
    width: auto;
    padding: 0.25rem 1rem;
    clear: both;
    font-weight: 400;
    color: rgb(0,0,0);
    text-align: inherit;
    text-decoration: none;
    white-space: nowrap;
    background-color: transparent;
    border: 0;
    height: 24px;
    font-family: SilkscreenNormal, sans-serif;
  }

  .account-dropdown-item:hover {
    background-color: #e9ecef;
    color: #0a58ca;
    text-decoration: none;
  }
</style>
<nav id="topbar">
<span style="margin-right: 0.25rem">
<a href="https://www.comp.nus.edu.sg/~stevenha" style="text-decoration: none; color: white">
<span class="colour" style="border: 1px solid; border-color: #198754!important; border-radius: .25rem!important">7</span>
</a>
<a href="https://visualgo.net/" style="font-family: SilkscreenNormal,sans-serif; font-size: 20px; margin-left: 4px;">
<span style="color: white">Visu</span><span class="colour">Algo</span><span style="font-size: 40%; color: white">.net</span>
</a>
<span style="color: white">/</span>
<select id="Language" class="select2-dropdown" onchange="changeURL()">
<option value="en" selected>en</option>
<option value="zh">zh</option>
<option value="id">id</option>
</select>
<span style="color: white; font-family: monospace">/heap</span>
</span>
<span style="max-height: 30px">
<span id="title">
<a id="title-heap" class="selected-viz">Binary Heap</a>
</span>
</span>
<span style="max-height: 30px; background-color:rgb(0,0,0)!important; color: white; margin-left: auto">
<div id="mode-menu">
<div id="mode-button" style="background-color: rgb(0,0,0)!important;" title="exploration">Exploration Mode &#9663;</div>
<div id="other-modes" style="background-color: rgb(0,0,0)!important; padding-top: 11px">
<a title="e-Lecture" style="background-color: rgb(0,0,0)!important;">e-Lecture Mode</a>
</div>
</div>
</span>
<span id="login-button" style="font-family: SilkscreenNormal,sans-serif">
<a href="https://visualgo.net/login">Login</a>
</span>
</nav>
<ul id="account-dropdown-menu">
<li><a class="account-dropdown-item" href="https://visualgo.net/profile">Profile</a></li>
<li><a class="account-dropdown-item" href="https://visualgo.net/training">Training</a></li>
<li><a class="account-dropdown-item" href="https://visualgo.net/tests">Tests</a></li>
<li><a class="account-dropdown-item" href="https://visualgo.net/logout">Log Out</a></li>
</ul>
<script>
  function changeURL() {
    let URL = window.location.href.split('https://visualgo.net/');
    URL[3] = document.getElementById("Language").value;
    window.location.assign(URL.join('https://visualgo.net/'));
  }

  function changeDefaultLanguageAndURL() {
    let URL = window.location.href.split('https://visualgo.net/');
    let val = document.getElementById("Language").value;
    URL[3] = val;

    let data = {
      '_token': "dOvHLDgQSeBxDYich7PEZml1cYPqAYZaOAN2Xn3H",
      'lang'  : val
    }
    $.post('https://visualgo.net/changeLanguage', data, function (res, status) {
      if(res['status'] === 'success') {
        window.location.assign(URL.join('https://visualgo.net/'));
      } else if (res['status'] === 'failed') {
        alert(res['message']);
      } else {
        alert('An unknown error occurred');
      }
    })
  }
</script>
<div id="dark-overlay"></div>
<div id="main-content-container" style="flex: 1">

<div id="mobile-playback-overlay" class="playing" style="display: none;">
<span id="mobile-playback-rewind-label" class="mobile-playback-label">-7</span>
<span id="mobile-playback-rewind" class="mobile-playback-item" onclick="mobilePlaybackRewind()"><img src="../img/prevFrame.png" alt="rewind 7 frames"></span>
<span id="mobile-playback-pause" class="mobile-playback-item" onclick="mobilePlaybackPauseOrPlay()"><img src="../img/pause.png" alt="pause"></span>
<span id="mobile-playback-play" class="mobile-playback-item" style="display: none;" onclick="mobilePlaybackPauseOrPlay()"><img src="../img/play.png" alt="play"></span>
<span id="mobile-playback-forward" class="mobile-playback-item" onclick="mobilePlaybackForward()"><img src="../img/nextFrame.png" alt="forward 7 frames"></span>
<span id="mobile-playback-forward-label" class="mobile-playback-label">+7</span>
</div>
<div id="status" class="panel"><p></p></div>
<div id="status-hide" class="panel-hide"><img src="../img/arrow_white_right.png" alt=">" title="show/hide status panel" /></div>
<div id="codetrace" class="panel">
<p id="code1" style="padding-top: 10px;"></p>
<p id="code2"></p>
<p id="code3"></p>
<p id="code4"></p>
<p id="code5"></p>
<p id="code6"></p>
<p id="code7" style="padding-bottom: 10px;"></p>
</div>
<div id="codetrace-hide" class="panel-hide"><img src="../img/arrow_white_right.png" alt=">" title="show/hide codetrace panel" /></div>
<div id="left-bar"></div>
<div id="right-bar"></div>
<div id="media-controls">
<div id="speed-control"><div id="speed-input"></div><div id="viz-speed-value">1x</div></div>
<span id="go-to-beginning" class="media-control-button" title="go to beginning" onclick="goToBeginning()"><img src="../img/goToBeginning.png" alt="go to beginning"></span>
<span id="previous" class="media-control-button" title="step backward" onclick="stepBackward()"><img src="../img/prevFrame.png" alt="previous frame"></span>
<span id="pause" class="media-control-button" title="pause" onclick="pause()"><img src="../img/pause.png" alt="pause"></span>
<span id="play" class="media-control-button" title="play" onclick="play()"><img src="../img/play.png" alt="play"></span>
<span id="next" class="media-control-button" title="step forward" onclick="stepForward()"><img src="../img/nextFrame.png" alt="next frame"></span>
<span id="go-to-end" class="media-control-button" title="go to end" onclick="goToEnd()"><img src="../img/goToEnd.png" alt="go to end"></span>
<div id="progress-bar" class="media-control-button"></div>
</div>
<div id="viz">
<p id="info" "></p>
</div>
<div id="current-action" class="panel"></div>
<div id="e-lecture" class="panel"></div> 
<div id="e-lecture-timeline"></div>
<div id="e-lecture-f1map">
<div class="e-lecture-f1map-sector" sectorNo="1"></div>
<div class="e-lecture-f1map-sector" sectorNo="2"></div>
<div class="e-lecture-f1map-sector" sectorNo="3"></div>
</div>
<div id="overlay" hidden onclick="end_eLecture()"> 
<div id="electure-dropdown">
<select class="lecture-dropdown" style="width:100%">
<option value="1">1. Binary (Max) Heap</option>
<option value="1-1">&nbsp;&nbsp;&nbsp;1-1. Definitions</option>
<option value="1-2">&nbsp;&nbsp;&nbsp;1-2. Priority Queue ADT</option>
<option value="1-3">&nbsp;&nbsp;&nbsp;1-3. Stability of Equal Highest Key</option>
<option value="1-4">&nbsp;&nbsp;&nbsp;1-4. Example</option>
<option value="1-5">&nbsp;&nbsp;&nbsp;1-5. For Live Lecture @ NUS Only</option>
<option value="1-6">&nbsp;&nbsp;&nbsp;1-6. The Example - Continued</option>
<option value="1-7">&nbsp;&nbsp;&nbsp;1-7. PQ Examples</option>
<option value="1-8">&nbsp;&nbsp;&nbsp;1-8. Potential Answers</option>
<option value="1-9">&nbsp;&nbsp;&nbsp;1-9. Linear DS for PQ?</option>
<option value="1-10">&nbsp;&nbsp;&nbsp;1-10. The Answer - Part 1</option>
<option value="1-11">&nbsp;&nbsp;&nbsp;1-11. The Answer - Part 2</option>
<option value="2">2. Visualisation + Max Heap Property</option>
<option value="2-1">&nbsp;&nbsp;&nbsp;2-1. Binary Heap has O(log N) Height</option>
<option value="2-2">&nbsp;&nbsp;&nbsp;2-2. 1-based Compact Array</option>
<option value="3">3. Binary (Max) Heap Operations</option>
<option value="3-1">&nbsp;&nbsp;&nbsp;3-1. What Are The Extra Operations?</option>
<option value="4">4. Insert(v)</option>
<option value="4-1">&nbsp;&nbsp;&nbsp;4-1. Why it is Correct?</option>
<option value="4-2">&nbsp;&nbsp;&nbsp;4-2. The Answer</option>
<option value="4-3">&nbsp;&nbsp;&nbsp;4-3. Time Complexity Analysis</option>
<option value="4-4">&nbsp;&nbsp;&nbsp;4-4. The Answer</option>
<option value="5">5. ExtractMax() - Once</option>
<option value="5-1">&nbsp;&nbsp;&nbsp;5-1. Why Compare with the Larger Child?</option>
<option value="5-2">&nbsp;&nbsp;&nbsp;5-2. The Answer</option>
<option value="5-3">&nbsp;&nbsp;&nbsp;5-3. Time Complexity Analysis</option>
<option value="5-4">&nbsp;&nbsp;&nbsp;5-4. The Answer</option>
<option value="6">6. Binary Heap for Efficient PQ</option>
<option value="7">7. Create(A) - Two Versions</option>
<option value="7-1">&nbsp;&nbsp;&nbsp;7-1. Create(A) - O(N log N)</option>
<option value="7-2">&nbsp;&nbsp;&nbsp;7-2. Create(A) - O(N)</option>
<option value="7-3">&nbsp;&nbsp;&nbsp;7-3. Many Leaf Vertices</option>
<option value="7-4">&nbsp;&nbsp;&nbsp;7-4. Why O(N)? - Part 1</option>
<option value="7-5">&nbsp;&nbsp;&nbsp;7-5. Why O(N)? - Part 2</option>
<option value="8">8. HeapSort()</option>
<option value="8-1">&nbsp;&nbsp;&nbsp;8-1. Discussion</option>
<option value="8-2">&nbsp;&nbsp;&nbsp;8-2. The Answer</option>
<option value="8-3">&nbsp;&nbsp;&nbsp;8-3. PartialSort()</option>
<option value="9">9. Extras</option>
<option value="9-1">&nbsp;&nbsp;&nbsp;9-1. Easy Max to Min Heap Conversion</option>
<option value="9-2">&nbsp;&nbsp;&nbsp;9-2. UpdateKey(i, newv)</option>
<option value="9-3">&nbsp;&nbsp;&nbsp;9-3. Delete(i)</option>
<option value="9-4">&nbsp;&nbsp;&nbsp;9-4. The Answer</option>
<option value="9-5">&nbsp;&nbsp;&nbsp;9-5. Source Code</option>
<option value="9-6">&nbsp;&nbsp;&nbsp;9-6. Online Quiz</option>
<option value="9-7">&nbsp;&nbsp;&nbsp;9-7. Online Judge Exercises</option>
<option value="9-8">&nbsp;&nbsp;&nbsp;9-8. Discussion</option>
<option value="9-9">&nbsp;&nbsp;&nbsp;9-9. Shocking Stuff</option>
<option value="9-10">&nbsp;&nbsp;&nbsp;9-10. The Answer</option>
</select>
</div>
<div class="electure-print" title="Print the e-Lecture note" style="z-index=8001;">&#9997;</div>
<div class="electure-end" title="Close the e-Lecture mode" style="z-index=8001;">&#10008;</div>
</div>
<div id="dropdown-temp-holder" hidden></div>

<div id="electure-1" class="electure-dialog" style="bottom:60px;left:50%;margin-left:-250px;width:500px;">
<p>A Binary (Max) Heap is a <a href="https://en.wikipedia.org/wiki/Binary_tree#Types_of_binary_trees" target="_blank"><u>complete binary tree</u></a> that maintains the <a href="https://en.wikipedia.org/wiki/Binary_heap" target="_blank"><u>Max Heap property</u></a>.</p> <br><p>Binary Heap is one possible data structure to model an efficient <a href="https://en.wikipedia.org/wiki/Priority_queue" target="_blank"><u>Priority Queue</u></a> (PQ) Abstract Data Type (ADT). In a PQ, each element has a "priority" and an element with higher priority is served before an element with lower priority (ties are either simply resolved arbitrarily or broken with standard First-In First-Out (FIFO) rule as with a normal Queue). Try clicking <span class="slide-actions" onclick="doButtonAction26()">ExtractMax()</span> for a sample animation on extracting the max value of random Binary Heap above.</p> <br><p>To focus the discussion scope, this visualization show a Binary <b>Max</b> Heap of integers where duplicates are allowed. See <a href="heapf3ec.html?slide=9-1"><u>this</u></a> for an easy conversion to Binary <b>Min</b> Heap. Generally, any other objects that can be compared can be stored in a Binary Max Heap, e.g., Binary Max Heap of floating points, etc.</p>
<div class="electure-addition">
<hr>
<p><b>Remarks</b>: By default, we show e-Lecture Mode for first time (or non logged-in) visitor.<br>
If you are an NUS student and a repeat visitor, please <a href="https://visualgo.net/login"><u>login</u></a>.</p>
</div>
<div class="electure-next" data-nextid="1-1" title="Go to the next slide 1-1">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-1-1" class="electure-dialog" style="bottom:60px;left:50%;margin-left:-250px;width:500px;">
<p><b>Complete Binary Tree</b>: Every level in the binary tree, except possibly the last/lowest level, is completely filled, and all vertices in the last level are as far left as possible.</p><br><p><b>Binary Max Heap property</b>: The parent of each vertex - except the root - contains value greater than (or equal to &mdash; we now allow duplicates) the value of that vertex. This is an easier-to-verify definition than the following alternative definition: The value of a vertex - except the leaf/leaves - must be greater than (or equal to) the value of its one (or two) child(ren).</p>
<div class="electure-addition">
<hr>
<p>Pro-tip 1: Since you are not <a href="https://visualgo.net/login"><u>logged-in</u></a>, you may be a first time visitor (or not an NUS student) who are not aware of the following keyboard shortcuts to navigate this e-Lecture mode: <b>[PageDown]</b>/<b>[PageUp]</b> to go to the next/previous slide, respectively, (and if the drop-down box is highlighted, you can also use <b>[&rarr; or &darr;/&larr; or &uarr;]</b> to do the same),and <b>[Esc]</b> to toggle between this e-Lecture mode and exploration mode.</p>
</div>
<div class="electure-prev" data-nextid="1" title="Go to the previous slide 1">&larr;</div>
<div class="electure-next" data-nextid="1-2" title="Go to the next slide 1-2">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-1-2" class="electure-dialog" style="top:70px;left:60px;width:500px;">
<p>Priority Queue (PQ) Abstract Data Type (ADT) is similar to normal Queue ADT, but with these two major operations:</p><ol><li>Enqueue(<b>x</b>): Put a new element (key) <b>x</b> into the PQ (in some order),</li><li><b>y</b> = Dequeue(): Return an existing element <b>y</b> that has the highest priority (key) in the PQ and if ties, return any.</li></ol><p>Discussion: Some PQ ADT reverts to First-In First-Out (FIFO) behavior of a normal <a href="listc97b.html?mode=Queue"><u>Queue</u></a> in the event there is a tie of highest priority (key) in the PQ. Does guaranteeing stability on equal highest priority (key) makes PQ ADT harder to implement?</p>
<div class="electure-addition">
<hr>
<p>Pro-tip 2: We designed this visualization and this e-Lecture mode to look good on 1366x768 resolution <b>or larger</b> (typical modern laptop resolution in 2021). We recommend using Google Chrome to access VisuAlgo. Go to full screen mode (<b>F11</b>) to enjoy this setup. However, you can use zoom-in (<b>Ctrl +</b>) or zoom-out (<b>Ctrl -</b>) to calibrate this.</p>
</div>
<div class="electure-prev" data-nextid="1-1" title="Go to the previous slide 1-1">&larr;</div>
<div class="electure-next" data-nextid="1-3" title="Go to the next slide 1-3">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-1-3" class="electure-dialog" style="top:70px;left:60px;width:500px;">
<div style="background-color: white; color: black;">
<div class="electure-addition">
<p>The content of this interesting slide (the answer of the usually intriguing discussion point from the earlier slide) is hidden and only available for legitimate CS lecturer worldwide. This mechanism is used in the various <a href="https://en.wikipedia.org/wiki/Flipped_classroom" target="_blank"><u>flipped classrooms</u></a> in NUS.</p><br>
<p><b>If you are really a CS lecturer (or an IT teacher)</b> (outside of NUS) and are interested to know the answers, please drop an email to stevenhalim at gmail dot com (<b>show your University staff profile/relevant proof to Steven</b>) for Steven to manually activate this CS lecturer-only feature for you.</p><br>
<p>FAQ: This feature will <b>NOT</b> be given to anyone else who is not a CS lecturer.</p>
</div>
</div>
<div class="electure-addition">
<hr>
<p>Pro-tip 3: Other than using the typical media UI at the bottom of the page, you can also control the animation playback using keyboard shortcuts (in Exploration Mode): <b>Spacebar</b> to play/pause/replay the animation, <b>&larr;</b>/<b>&rarr;</b> to step the animation backwards/forwards, respectively, and <b>-</b>/<b>+</b> to decrease/increase the animation speed, respectively.</p>
</div>
<div class="electure-prev" data-nextid="1-2" title="Go to the previous slide 1-2">&larr;</div>
<div class="electure-next" data-nextid="1-4" title="Go to the next slide 1-4">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-1-4" class="electure-dialog" style="top:70px;left:60px;width:500px;">
<p>Imagine: You are an <a href="https://en.wikipedia.org/wiki/Air_traffic_controller" target="_blank"><u>Air Traffic Controller (ATC)</u></a> working in the control tower <b>T</b> of an airport. You have scheduled aircraft <b>X</b>/<b>Y</b> to land in the next 3/6 minutes, respectively. Both have enough fuel for at least the next 15 minutes and both are just 2 minutes away from your airport. You observe that your airport runway is clear at the moment.</p><br><img src="../img/Airplane_1.png" width="500px"><br><p>In case you do not know, aircraft can be instructed to fly in <a href="https://en.wikipedia.org/wiki/Holding_(aeronautics)" target="_blank"><u>holding pattern</u></a> near the airport until the designated landing time.</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="1-3" title="Go to the previous slide 1-3">&larr;</div>
<div class="electure-next" data-nextid="1-5" title="Go to the next slide 1-5">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-1-5" class="electure-dialog" style="top:70px;left:60px;width:500px;">
<p>You have to attend the live lecture to figure out what happens next...</p><br><p>There will be two options presented to you and you will have to decide:</p><ul><li>Raise AND wave your hand if you choose option A,</li><li>Raise your hand but do NOT wave it if you choose option B,</li></ul><p>If none of the two options is reasonable for you, simply do nothing.</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="1-4" title="Go to the previous slide 1-4">&larr;</div>
<div class="electure-next" data-nextid="1-6" title="Go to the next slide 1-6">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-1-6" class="electure-dialog" style="top:70px;left:60px;width:500px;">
<div style="background-color: white; color: black;">
<div class="electure-addition">
<p>The content of this interesting slide (the answer of the usually intriguing discussion point from the earlier slide) is hidden and only available for legitimate CS lecturer worldwide. This mechanism is used in the various <a href="https://en.wikipedia.org/wiki/Flipped_classroom" target="_blank"><u>flipped classrooms</u></a> in NUS.</p><br>
<p><b>If you are really a CS lecturer (or an IT teacher)</b> (outside of NUS) and are interested to know the answers, please drop an email to stevenhalim at gmail dot com (<b>show your University staff profile/relevant proof to Steven</b>) for Steven to manually activate this CS lecturer-only feature for you.</p><br>
<p>FAQ: This feature will <b>NOT</b> be given to anyone else who is not a CS lecturer.</p>
</div>
</div>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="1-5" title="Go to the previous slide 1-5">&larr;</div>
<div class="electure-next" data-nextid="1-7" title="Go to the next slide 1-7">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-1-7" class="electure-dialog" style="top:70px;left:60px;width:500px;">
<p>There are several potential usages of PQ ADT in real-life on top of what you have seen just now regarding ATC (only in live lecture).</p><br><p>Discussion: Can you mention a few other real-life situations where a PQ is needed?</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="1-6" title="Go to the previous slide 1-6">&larr;</div>
<div class="electure-next" data-nextid="1-8" title="Go to the next slide 1-8">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-1-8" class="electure-dialog" style="top:70px;left:60px;width:500px;">
<div style="background-color: white; color: black;">
<div class="electure-addition">
<p>The content of this interesting slide (the answer of the usually intriguing discussion point from the earlier slide) is hidden and only available for legitimate CS lecturer worldwide. This mechanism is used in the various <a href="https://en.wikipedia.org/wiki/Flipped_classroom" target="_blank"><u>flipped classrooms</u></a> in NUS.</p><br>
<p><b>If you are really a CS lecturer (or an IT teacher)</b> (outside of NUS) and are interested to know the answers, please drop an email to stevenhalim at gmail dot com (<b>show your University staff profile/relevant proof to Steven</b>) for Steven to manually activate this CS lecturer-only feature for you.</p><br>
<p>FAQ: This feature will <b>NOT</b> be given to anyone else who is not a CS lecturer.</p>
</div>
</div>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="1-7" title="Go to the previous slide 1-7">&larr;</div>
<div class="electure-next" data-nextid="1-9" title="Go to the next slide 1-9">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-1-9" class="electure-dialog" style="top:70px;left:60px;width:500px;">
<p>We are able to implement this PQ ADT using (circular) array or <a href="list.html"><u>Linked List</u></a> but we will have slow (i.e., in O(<b>N</b>)) Enqueue or Dequeue operation.</p><br><p>Discussion: Why?</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="1-8" title="Go to the previous slide 1-8">&larr;</div>
<div class="electure-next" data-nextid="1-10" title="Go to the next slide 1-10">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-1-10" class="electure-dialog" style="top:70px;left:60px;width:500px;">
<div style="background-color: white; color: black;">
<div class="electure-addition">
<p>The content of this interesting slide (the answer of the usually intriguing discussion point from the earlier slide) is hidden and only available for legitimate CS lecturer worldwide. This mechanism is used in the various <a href="https://en.wikipedia.org/wiki/Flipped_classroom" target="_blank"><u>flipped classrooms</u></a> in NUS.</p><br>
<p><b>If you are really a CS lecturer (or an IT teacher)</b> (outside of NUS) and are interested to know the answers, please drop an email to stevenhalim at gmail dot com (<b>show your University staff profile/relevant proof to Steven</b>) for Steven to manually activate this CS lecturer-only feature for you.</p><br>
<p>FAQ: This feature will <b>NOT</b> be given to anyone else who is not a CS lecturer.</p>
</div>
</div>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="1-9" title="Go to the previous slide 1-9">&larr;</div>
<div class="electure-next" data-nextid="1-11" title="Go to the next slide 1-11">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-1-11" class="electure-dialog" style="top:70px;left:60px;width:500px;">
<div style="background-color: white; color: black;">
<div class="electure-addition">
<p>The content of this interesting slide (the answer of the usually intriguing discussion point from the earlier slide) is hidden and only available for legitimate CS lecturer worldwide. This mechanism is used in the various <a href="https://en.wikipedia.org/wiki/Flipped_classroom" target="_blank"><u>flipped classrooms</u></a> in NUS.</p><br>
<p><b>If you are really a CS lecturer (or an IT teacher)</b> (outside of NUS) and are interested to know the answers, please drop an email to stevenhalim at gmail dot com (<b>show your University staff profile/relevant proof to Steven</b>) for Steven to manually activate this CS lecturer-only feature for you.</p><br>
<p>FAQ: This feature will <b>NOT</b> be given to anyone else who is not a CS lecturer.</p>
</div>
</div>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="1-10" title="Go to the previous slide 1-10">&larr;</div>
<div class="electure-next" data-nextid="2" title="Go to the next slide 2">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-2" class="electure-dialog" style="top:290px;left:50%;margin-left:-250px;width:500px;">
<p>Now, let&#39;s view the visualisation of a (random) Binary (Max) Heap above. You should see a complete binary tree and all vertices except the root satisfy the Max Heap property (A[parent(i)] &ge; A[i]). Duplicate integer keys may appear.</p><br><p>You can <span class="slide-actions" onclick="doButtonAction130()">Toggle the Visualization Mode</span> between the visually more intuitive complete binary tree form or the underlying compact array based implementation of a Binary (Max) Heap.</p><br><input class="mcq-answer" id="mcq-answer-6" value="32" hidden><p>Quiz: <b>Based on this Binary (Max) Heap property, where will the largest integer be located?</b></p><form><input type="radio" name="mcq-6-choice" value="34"> Can be anywhere<br><input type="radio" name="mcq-6-choice" value="33"> At one of the leaf<br><input type="radio" name="mcq-6-choice" value="32"> At the root<br></form><button class="mcq-submit" id="submit-6">Submit</button> <span id="answer-status-6"></span>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="1-11" title="Go to the previous slide 1-11">&larr;</div>
<div class="electure-next" data-nextid="2-1" title="Go to the next slide 2-1">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-2-1" class="electure-dialog" style="top:290px;left:50%;margin-left:-250px;width:500px;">
<p>Important fact to memorize at this point: If we have a Binary Heap of <b>N</b> elements, its height will not be taller than O(log <b>N</b>) since we will store it as a complete binary tree.</p><br><p>Simple analysis: The size <b>N</b> of a full (more than just a complete) binary tree of height <b>h</b> is always <b>N = 2<sup>(h+1)</sup>-1</b>, therefore <b>h = log<sub>2</sub>(N+1)-1 ~= log<sub>2</sub> N</b>.</p><br><p>See example above with <b>N = 7 = 2<sup>(2+1)</sup>-1</b> or <b>h = log<sub>2</sub>(7+1)-1 = 2</b>.</p><br><p>This fact is important in the analysis of all Binary Heap-related operations.</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="2" title="Go to the previous slide 2">&larr;</div>
<div class="electure-next" data-nextid="2-2" title="Go to the next slide 2-2">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-2-2" class="electure-dialog" style="top:290px;left:50%;margin-left:-250px;width:500px;">
<p>A complete binary tree can be stored efficiently as a compact array A as there is no gap between vertices of a complete binary tree/elements of a compact array. To simplify the navigation operations below, we use 1-based array. VisuAlgo displays the index of each vertex as a <span style="color: red;">red label</span> below each vertex. Read those indices in sorted order from 1 to <b>N</b>, then you will see the vertices of the complete binary tree from top to down, left to right. To help you understand this, <span class="slide-actions" onclick="doButtonAction130()">Toggle the Visualization Mode</span> several times.</p><br><p>This way, we can implement basic binary tree traversal operations with simple index manipulations (with help of <a href="bitmask.html"><u>bit shift manipulation</u></a>):</p><ol><li>parent(i) = i&gt;&gt;1, index i divided by 2 (integer division),</li><li>left(i) = i&lt;&lt;1, index i multiplied by 2,</li><li>right(i) = (i&lt;&lt;1)+1, index i multiplied by 2 and added by 1.</li></ol><p>Pro tip: Try opening two copies of VisuAlgo on two browser windows. Try to visualize the same Binary Max Heap in two different modes and compare them.</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="2-1" title="Go to the previous slide 2-1">&larr;</div>
<div class="electure-next" data-nextid="3" title="Go to the next slide 3">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-3" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<p>In this visualization, you can perform several Binary (Max) Heap operations:</p><ol><li><b>Create(A)</b> - O(<b>N</b> log <b>N</b>) version (<b>N</b> calls of <b>Insert(v)</b> below)</li><li><b>Create(A)</b> - O(<b>N</b>) version</li><li><b>Insert(v)</b> in O(log <b>N</b>) &mdash; you are allowed to insert duplicates</li><li>3 versions of <b>ExtractMax()</b>:<ol><li>Once, in O(log <b>N</b>)</li><li><b>K</b> times, i.e., <b>PartialSort()</b>, in O(<b>K</b> log <b>N</b>), or </li><li><b>N</b> times, i.e., <b>HeapSort()</b>, in O(<b>N</b> log <b>N)</b></li></ol></li><li><b>UpdateKey(i, newv)</b> in O(log <b>N</b> if <b>i</b> is known)</li><li><b>Delete(i)</b> in O(log <b>N</b> if <b>i</b> is known)</li></ol><p>There are a few other possible Binary (Max) Heap operations, but currently we do not elaborate them for pedagogical reason in a certain NUS module.</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="2-2" title="Go to the previous slide 2-2">&larr;</div>
<div class="electure-next" data-nextid="3-1" title="Go to the next slide 3-1">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-3-1" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<div style="background-color: white; color: black;">
<div class="electure-addition">
<p>The content of this interesting slide (the answer of the usually intriguing discussion point from the earlier slide) is hidden and only available for legitimate CS lecturer worldwide. This mechanism is used in the various <a href="https://en.wikipedia.org/wiki/Flipped_classroom" target="_blank"><u>flipped classrooms</u></a> in NUS.</p><br>
<p><b>If you are really a CS lecturer (or an IT teacher)</b> (outside of NUS) and are interested to know the answers, please drop an email to stevenhalim at gmail dot com (<b>show your University staff profile/relevant proof to Steven</b>) for Steven to manually activate this CS lecturer-only feature for you.</p><br>
<p>FAQ: This feature will <b>NOT</b> be given to anyone else who is not a CS lecturer.</p>
</div>
</div>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="3" title="Go to the previous slide 3">&larr;</div>
<div class="electure-next" data-nextid="4" title="Go to the next slide 4">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-4" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<p><b>Insert(v)</b>: Insertion of a new item <b>v</b> into a Binary Max Heap can only be done at the <i>last index <b>N</b> plus 1</i> to maintain the compact array = complete binary tree property. However, the Max Heap property <i>may</i> still be violated. This operation then fixes Max Heap property from the insertion point <b>upwards</b> (if necessary) and stop when there is no more Max Heap property violation. Now try clicking <span class="slide-actions" onclick="doButtonAction27()">Insert(v)</span> several times to insert a few random <b>v</b> to the currently displayed Binary (Max Heap).</p><br><p>The fix Max Heap property upwards operation has no standard name. We call it <b>ShiftUp</b> but others may call it <b>BubbleUp</b> or <b>IncreaseKey</b> operation.</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="3-1" title="Go to the previous slide 3-1">&larr;</div>
<div class="electure-next" data-nextid="4-1" title="Go to the next slide 4-1">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-4-1" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<p>Do you understand why starting from the insertion point (index <b>N</b>+1) upwards (at most until the root) and swapping a vertex with its parent when there is a Max Heap property violation during insertion is always a correct strategy?</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="4" title="Go to the previous slide 4">&larr;</div>
<div class="electure-next" data-nextid="4-2" title="Go to the next slide 4-2">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-4-2" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<div style="background-color: white; color: black;">
<div class="electure-addition">
<p>The content of this interesting slide (the answer of the usually intriguing discussion point from the earlier slide) is hidden and only available for legitimate CS lecturer worldwide. This mechanism is used in the various <a href="https://en.wikipedia.org/wiki/Flipped_classroom" target="_blank"><u>flipped classrooms</u></a> in NUS.</p><br>
<p><b>If you are really a CS lecturer (or an IT teacher)</b> (outside of NUS) and are interested to know the answers, please drop an email to stevenhalim at gmail dot com (<b>show your University staff profile/relevant proof to Steven</b>) for Steven to manually activate this CS lecturer-only feature for you.</p><br>
<p>FAQ: This feature will <b>NOT</b> be given to anyone else who is not a CS lecturer.</p>
</div>
</div>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="4-1" title="Go to the previous slide 4-1">&larr;</div>
<div class="electure-next" data-nextid="4-3" title="Go to the next slide 4-3">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-4-3" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<p>The time complexity of this <b>Insert(v)</b> operation is O(log <b>N</b>).</p><br><p>Discussion: Do you understand the derivation?</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="4-2" title="Go to the previous slide 4-2">&larr;</div>
<div class="electure-next" data-nextid="4-4" title="Go to the next slide 4-4">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-4-4" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<div style="background-color: white; color: black;">
<div class="electure-addition">
<p>The content of this interesting slide (the answer of the usually intriguing discussion point from the earlier slide) is hidden and only available for legitimate CS lecturer worldwide. This mechanism is used in the various <a href="https://en.wikipedia.org/wiki/Flipped_classroom" target="_blank"><u>flipped classrooms</u></a> in NUS.</p><br>
<p><b>If you are really a CS lecturer (or an IT teacher)</b> (outside of NUS) and are interested to know the answers, please drop an email to stevenhalim at gmail dot com (<b>show your University staff profile/relevant proof to Steven</b>) for Steven to manually activate this CS lecturer-only feature for you.</p><br>
<p>FAQ: This feature will <b>NOT</b> be given to anyone else who is not a CS lecturer.</p>
</div>
</div>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="4-3" title="Go to the previous slide 4-3">&larr;</div>
<div class="electure-next" data-nextid="5" title="Go to the next slide 5">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-5" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<p><b>ExtractMax()</b>: The reporting and then the deletion of the maximum element (the root) of a Binary Max Heap requires an existing element to replace the root, otherwise the Binary Max Heap (a single complete binary tree, or 林/Lín in Chinese/tree) becomes two disjoint subtrees (two copies of 木/mù in Chinese/wood). That element must be the <i>last index</i> <b>N</b> for the same reason: To maintain the compact array = complete binary tree property.</p><br><p>Because we promote a leaf vertex to the root vertex of a Binary Max Heap, it will very likely violates the Max Heap property. ExtractMax() operation then fixes Binary Max Heap property from the root <b>downwards</b> by comparing the current value with the its child/the larger of its two children (if necessary). Now try <span class="slide-actions" onclick="doButtonAction26()">ExtractMax()</span> on the currently displayed Binary (Max) Heap.</p><br><p>The fix Max Heap property downwards operation has no standard name. We call it <b>ShiftDown</b> but others may call it <b>BubbleDown</b> or <b>Heapify</b> operation.</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="4-4" title="Go to the previous slide 4-4">&larr;</div>
<div class="electure-next" data-nextid="5-1" title="Go to the next slide 5-1">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-5-1" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<p>Why if a vertex has two children, we have to check (and possibly swap) that vertex with <i>the larger</i> of its two children during the downwards fix of Max Heap property?</p><br><p>Why can&#39;t we just compare with the left (or right, if exists) vertex only?</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="5" title="Go to the previous slide 5">&larr;</div>
<div class="electure-next" data-nextid="5-2" title="Go to the next slide 5-2">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-5-2" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<div style="background-color: white; color: black;">
<div class="electure-addition">
<p>The content of this interesting slide (the answer of the usually intriguing discussion point from the earlier slide) is hidden and only available for legitimate CS lecturer worldwide. This mechanism is used in the various <a href="https://en.wikipedia.org/wiki/Flipped_classroom" target="_blank"><u>flipped classrooms</u></a> in NUS.</p><br>
<p><b>If you are really a CS lecturer (or an IT teacher)</b> (outside of NUS) and are interested to know the answers, please drop an email to stevenhalim at gmail dot com (<b>show your University staff profile/relevant proof to Steven</b>) for Steven to manually activate this CS lecturer-only feature for you.</p><br>
<p>FAQ: This feature will <b>NOT</b> be given to anyone else who is not a CS lecturer.</p>
</div>
</div>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="5-1" title="Go to the previous slide 5-1">&larr;</div>
<div class="electure-next" data-nextid="5-3" title="Go to the next slide 5-3">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-5-3" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<p>The time complexity of this <b>ExtractMax()</b> operation is O(log <b>N</b>).</p><br><p>Discussion: Do you understand the derivation?</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="5-2" title="Go to the previous slide 5-2">&larr;</div>
<div class="electure-next" data-nextid="5-4" title="Go to the next slide 5-4">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-5-4" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<div style="background-color: white; color: black;">
<div class="electure-addition">
<p>The content of this interesting slide (the answer of the usually intriguing discussion point from the earlier slide) is hidden and only available for legitimate CS lecturer worldwide. This mechanism is used in the various <a href="https://en.wikipedia.org/wiki/Flipped_classroom" target="_blank"><u>flipped classrooms</u></a> in NUS.</p><br>
<p><b>If you are really a CS lecturer (or an IT teacher)</b> (outside of NUS) and are interested to know the answers, please drop an email to stevenhalim at gmail dot com (<b>show your University staff profile/relevant proof to Steven</b>) for Steven to manually activate this CS lecturer-only feature for you.</p><br>
<p>FAQ: This feature will <b>NOT</b> be given to anyone else who is not a CS lecturer.</p>
</div>
</div>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="5-3" title="Go to the previous slide 5-3">&larr;</div>
<div class="electure-next" data-nextid="6" title="Go to the next slide 6">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-6" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<p>Up to here, we have a data structure that can implement the two major operations of Priority Queue (PQ) ADT efficiently:</p><ol><li>For <b>Enqueue(x)</b>, we can use <b>Insert(x)</b> in O(log <b>N</b>) time, and</li><li>For <b>y</b> = Dequeue(), we can use <b>y = ExtractMax()</b> in O(log <b>N</b>) time.</li></ol><p>However, we can do a few more operations with Binary Heap.</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="5-4" title="Go to the previous slide 5-4">&larr;</div>
<div class="electure-next" data-nextid="7" title="Go to the next slide 7">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-7" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<p><b>Create(A)</b>: Creates a valid Binary (Max) Heap from an input array <b>A</b> of <b>N</b> integers (comma separated) into an initially empty Binary Max Heap.</p><br><p>There are two variants for this operations, one that is simpler but runs in O(<b>N</b> log <b>N</b>) and a more advanced technique that runs in O(<b>N</b>).</p><br><p>Pro tip: Try opening two copies of VisuAlgo on two browser windows. Execute different Create(A) versions on the worst case &#39;Sorted example&#39; to see the <i>somewhat dramatic</i> differences of the two.</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="6" title="Go to the previous slide 6">&larr;</div>
<div class="electure-next" data-nextid="7-1" title="Go to the next slide 7-1">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-7-1" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<p><b>Create(A) - O(N log N)</b>: Simply insert (that is, by calling <b>Insert(v) </b>operation) all <b>N</b> integers of the input array into an initially empty Binary Max Heap one by one.</p><br><p><b>Analysis</b>: This operation is clearly O(<b>N</b> log <b>N</b>) as we call O(log <b>N</b>) <b>Insert(v)</b> operation <b>N</b> times. Let&#39;s examine the &#39;Sorted example&#39; which is one of the hard case of this operation (Now try the <span class="slide-actions" onclick="doButtonAction23()">Hard Case - O(N log N)</span> where we show a case where <b>A = [1,2,3,4,5,6,7]</b> -- please be patient as this example will take some time to complete). If we insert values in increasing order into an initially empty Binary Max Heap, then every insertion triggers a path from the insertion point (a new leaf) upwards to the root.</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="7" title="Go to the previous slide 7">&larr;</div>
<div class="electure-next" data-nextid="7-2" title="Go to the next slide 7-2">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-7-2" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<p><b>Create(A) - O(N)</b>: This faster version of <b>Create(A)</b> operation was invented by Robert W. Floyd in 1964. It takes advantage of the fact that a compact array = complete binary tree and all leaves (i.e., half of the vertices — see the next slide) are Binary Max Heap by default. This operation then fixes Binary Max Heap property (if necessary) only from the last internal vertex back to the root.</p><br><p><b>Analysis</b>: A loose analysis gives another O(<b>N</b>/2 log <b>N</b>) = O(<b>N</b> log <b>N</b>) complexity but it is actually just O(2*<b>N</b>) = O(<b>N</b>) — details in the next few slides. Now try the <span class="slide-actions" onclick="doButtonAction24()">Hard Case - O(N)</span> on the same input array <b>A = [1,2,3,4,5,6,7]</b> and see that on the same hard case as with the previous slide (but not the one that generates maximum number of swaps &mdash; try &#39;Diagonal Entry&#39; test case by yourself), this operation is far superior than the O(<b>N</b> log <b>N</b>) version.</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="7-1" title="Go to the previous slide 7-1">&larr;</div>
<div class="electure-next" data-nextid="7-3" title="Go to the next slide 7-3">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-7-3" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<p>Simple explanation on why half of Binary (Max) Heap of <b>N</b> (without loss of generality, let&#39;s assume that <b>N</b> is even) elements are leaves are as follows:</p><br><p>Suppose that the last leaf is at index <b>N</b>, then the parent of that last leaf is at index <b>i = N/2 </b>(remember <a href="heapec4c.html?slide=2-2"><u>this slide</u></a>). The left child of vertex <b>i+1</b>, if exists (it actually does not exist), will be <b>2*(i+1) = 2*(N/2+1) = N+2</b>, which exceeds index <b>N</b> (the last leaf) so index <b>i+1</b> must also be a leaf vertex that has no child. As Binary Heap indexing is consecutive, basically indices [<b>i+1 = N/2+1</b>, <b>i+2 = N/2+2</b>, ..., <b>N</b>], or half of the vertices, are leaves.</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="7-2" title="Go to the previous slide 7-2">&larr;</div>
<div class="electure-next" data-nextid="7-4" title="Go to the next slide 7-4">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-7-4" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<p>First, we need to recall that the height of a full binary tree of size <b>N</b> is log<sub>2</sub> <b>N</b>.</p><br><p>Second, we need to realise that the cost to run <samp>shiftDown(i)</samp> operation is not the gross upper bound O(log <b>N</b>), but O(<b>h</b>) where <b>h</b> is the height of the subtree rooted at <b>i</b>.</p><br><p>Third, there are <samp>ceil(N/2<sup>h+1</sup>)</samp> vertices at height <b>h</b> in a full binary tree.</p><br><p>On the example full binary tree above with <b>N = 7</b> and <b>h = 2</b>, there are:<br><samp>ceil(7/2<sup>0+1</sup>) = 4</samp> vertices: {44,35,26,17} at height <b>h = 0</b>,<br><samp>ceil(7/2<sup>1+1</sup>) = 2</samp> vertices: {62,53} at height <b>h = 1</b>, and<br><samp>ceil(7/2<sup>2+1</sup>) = 1</samp> vertex: {71} at height <b>h = 2</b>.</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="7-3" title="Go to the previous slide 7-3">&larr;</div>
<div class="electure-next" data-nextid="7-5" title="Go to the next slide 7-5">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-7-5" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<p>Cost of Create(A), the O(<b>N</b>) version is thus:</p><br><img src="../img/createheapanalysis.png" width="500" alt="analysis"><br><p>PS: If the formula is too complicated, a modern student can also use <a href="http://www.wolframalpha.com/input/?i=0%2F1%2B1%2F2%2B2%2F4%2B3%2F8%2B4%2F16%2B..." target="_blank"><u>WolframAlpha</u></a> instead.</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="7-4" title="Go to the previous slide 7-4">&larr;</div>
<div class="electure-next" data-nextid="8" title="Go to the next slide 8">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-8" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<p><b>HeapSort()</b>: John William Joseph Williams invented <b>HeapSort()</b> algorithm in 1964, together with this Binary Heap data structure. <b>HeapSort()</b> operation (assuming the Binary Max Heap has been created in O(<b>N</b>)) is very easy. Simply call the O(log <b>N</b>) <b>ExtractMax()</b> operation <b>N</b> times. Now try <span class="slide-actions" onclick="doButtonAction25()">HeapSort()</span> on the currently displayed Binary (Max) Heap.</p><br><p><b>Simple Analysis</b>: <b>HeapSort()</b> clearly runs in O(<b>N</b> log <b>N</b>) — an optimal comparison-based sorting algorithm.</p><br><input class="msq-answer" id="msq-answer-7" value="36,37,38" hidden><p>Quiz: <b>In worst case scenario, HeapSort() is asymptotically faster than...</b></p><input type="checkbox" class="msq-choice" id="msq-7-choice-35"> Merge Sort<br><input type="checkbox" class="msq-choice" id="msq-7-choice-36"> Selection Sort<br><input type="checkbox" class="msq-choice" id="msq-7-choice-37"> Bubble Sort<br><input type="checkbox" class="msq-choice" id="msq-7-choice-38"> Insertion Sort<br><button class="msq-submit" id="submit-7">Submit</button> <span id="answer-status-7"></span>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="7-5" title="Go to the previous slide 7-5">&larr;</div>
<div class="electure-next" data-nextid="8-1" title="Go to the next slide 8-1">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-8-1" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<p>Although <b>HeapSort()</b> runs in θ(<b>N</b> log <b>N</b>) time for all (best/average/worst) cases, is it really the best <i>comparison-based</i> sorting algorithm?</p><br><p>Discussion: How about caching performance of <b>HeapSort()</b>?</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="8" title="Go to the previous slide 8">&larr;</div>
<div class="electure-next" data-nextid="8-2" title="Go to the next slide 8-2">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-8-2" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<div style="background-color: white; color: black;">
<div class="electure-addition">
<p>The content of this interesting slide (the answer of the usually intriguing discussion point from the earlier slide) is hidden and only available for legitimate CS lecturer worldwide. This mechanism is used in the various <a href="https://en.wikipedia.org/wiki/Flipped_classroom" target="_blank"><u>flipped classrooms</u></a> in NUS.</p><br>
<p><b>If you are really a CS lecturer (or an IT teacher)</b> (outside of NUS) and are interested to know the answers, please drop an email to stevenhalim at gmail dot com (<b>show your University staff profile/relevant proof to Steven</b>) for Steven to manually activate this CS lecturer-only feature for you.</p><br>
<p>FAQ: This feature will <b>NOT</b> be given to anyone else who is not a CS lecturer.</p>
</div>
</div>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="8-1" title="Go to the previous slide 8-1">&larr;</div>
<div class="electure-next" data-nextid="8-3" title="Go to the next slide 8-3">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-8-3" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<p>We can actually just call the O(log <b>N</b>) <b>ExtractMax()</b> operation <b>K</b> times if we are only interested in the top <b>K</b> largest elements in the Binary (Max) Heap. Now try <span class="slide-actions" onclick="doButtonAction148()">PartialSort()</span> on the currently displayed Binary (Max) Heap. This operation is called PartialSort().</p><br><p><b>Simple Analysis</b>: <b>PartialSort()</b> clearly runs in O(<b>K</b> log <b>N</b>) &mdash; an output-sensitive algorithm where the time complexity depends on the output size <b>K</b>.</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="8-2" title="Go to the previous slide 8-2">&larr;</div>
<div class="electure-next" data-nextid="9" title="Go to the next slide 9">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-9" class="electure-dialog" style="top:70px;left:60px;width:500px;">
<p>You have reached the end of the basic stuffs of this Binary (Max) Heap data structure and we encourage you to explore further in the <b>Exploration Mode</b>.</p><br><p>However, we still have a few more interesting Binary (Max) Heap challenges for you that are outlined in this section.</p><br><p>When you have cleared them all, we invite you to study more advanced algorithms that use Priority Queue as (one of) its underlying data structure, like <a href="mst.html" target="_blank"><u>Prim&#39;s MST algorithm</u></a>, <a href="sssp.html" target="_blank"><u>Dijkstra&#39;s SSSP algorithm</u></a>, A* search algorithm (not in VisuAlgo yet), a few other greedy-based algorithms, etc.</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="8-3" title="Go to the previous slide 8-3">&larr;</div>
<div class="electure-next" data-nextid="9-1" title="Go to the next slide 9-1">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-9-1" class="electure-dialog" style="top:290px;left:50%;margin-left:-250px;width:500px;">
<p>If we only deal with numbers (including this visualization that is restricted to integers only), it is easy to convert a Binary Max Heap into a Binary Min Heap without changing anything, or vice versa.</p><br><p>We can re-create a Binary Heap with the negation of every integer in the original Binary Heap. If we start with a Binary Max Heap, the resulting Binary Heap is a Binary Min Heap (if we ignore the negative symbols &mdash; see the picture above), and vice versa.</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="9" title="Go to the previous slide 9">&larr;</div>
<div class="electure-next" data-nextid="9-2" title="Go to the next slide 9-2">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-9-2" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<p>For some Priority Queue applications (e.g., <a href="sssp5a78.html?slide=7-3"><u>HeapDecreaseKey in Dijkstra&#39;s algorithm</u></a>), we may have to modify (increase or decrease) the priority of an existing value that is already inserted into a Binary (Max) Heap. If the index <b>i</b> of the value is known, we can do the following simple strategy: Simply update <b>A[i] = newv</b> and then call <b>both</b> <b>shiftUp(i)</b> and <b>shiftDown(i)</b>. Only at most one of this Max Heap property restoration operation will be successful, i.e., <b>shiftUp(i)</b>/<b>shiftDown(i)</b> will be triggered if <b>newv</b> &gt;/&lt; old value of <b>A[parent(i)]</b>/<b>A[larger of the two children of i]</b>, respectively.</p><br><p>Thus, <b>UpdateKey(i, newv)</b> can be done in O(log <b>N</b>), provided we know index <b>i</b>.</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="9-1" title="Go to the previous slide 9-1">&larr;</div>
<div class="electure-next" data-nextid="9-3" title="Go to the next slide 9-3">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-9-3" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<p>For some Priority Queue applications, we may have to delete an existing value that is already inserted into a Binary (Max) Heap (and this value happens to be not the root). Again, if the index <b>i</b> of the value is known, we can do the following simple strategy: Simply update <b>A[i] = A[1]+1</b> (a larger number greater than the current root), call <b>shiftUp(i)</b> (technically, <b>UpdateKey(i, A[1]+1)</b>). This will floats index <b>i</b> to be the new root, and from there, we can easily call <b>ExtractMax()</b> once to remove it.</p><br><p>Thus, <b>Delete(i)</b> can be done in O(log <b>N</b>), provided we know index <b>i</b>.</p><br><p>Discussion: Now for <b>UpdateKey(i, newv)</b> and <b>Delete(i)</b>, what if we are given <b>oldv</b> instead and thus we have to search for its location in the Binary (Max) Heap? Can we do this faster than O(<b>N</b>)?</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="9-2" title="Go to the previous slide 9-2">&larr;</div>
<div class="electure-next" data-nextid="9-4" title="Go to the next slide 9-4">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-9-4" class="electure-dialog" style="bottom:270px;left:60px;width:500px;">
<div style="background-color: white; color: black;">
<div class="electure-addition">
<p>The content of this interesting slide (the answer of the usually intriguing discussion point from the earlier slide) is hidden and only available for legitimate CS lecturer worldwide. This mechanism is used in the various <a href="https://en.wikipedia.org/wiki/Flipped_classroom" target="_blank"><u>flipped classrooms</u></a> in NUS.</p><br>
<p><b>If you are really a CS lecturer (or an IT teacher)</b> (outside of NUS) and are interested to know the answers, please drop an email to stevenhalim at gmail dot com (<b>show your University staff profile/relevant proof to Steven</b>) for Steven to manually activate this CS lecturer-only feature for you.</p><br>
<p>FAQ: This feature will <b>NOT</b> be given to anyone else who is not a CS lecturer.</p>
</div>
</div>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="9-3" title="Go to the previous slide 9-3">&larr;</div>
<div class="electure-next" data-nextid="9-5" title="Go to the next slide 9-5">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-9-5" class="electure-dialog" style="top:70px;left:60px;width:500px;">
<p>If you are looking for an implementation of Binary (Max) Heap to actually model a Priority Queue, then there is a good news.</p><br><p>C++ and Java already have built-in Priority Queue implementations that very likely use this data structure. They are <a href="http://en.cppreference.com/w/cpp/container/priority_queue" target="_blank"><u>C++ STL priority_queue</u></a> (the default is a Max Priority Queue) and <a href="https://docs.oracle.com/javase/8/docs/api/java/util/PriorityQueue.html" target="_blank"><u>Java PriorityQueue</u></a> (the default is a Min Priority Queue). However, the built-in implementation may not be suitable to do some PQ extended operations efficiently (details omitted for pedagogical reason in a certain NUS course).</p><br><p>Python <a href="https://docs.python.org/3/library/heapq.html" target="_blank">heapq</a> exists but its performance is rather slow. OCaml doesn&#39;t have built-in Priority Queue but we can use something else that is going to be mentioned in the other modules in VisuAlgo (the reason on why the details are omitted is the same as above).</p><br><p>PS: Heap Sort is likely used in C++ STL algorithm <a href="http://en.cppreference.com/w/cpp/algorithm/partial_sort" target="_blank"><u>partial_sort</u></a>.</p><hr><p>Nevertheless, here is our implementation of <a href="http://www.comp.nus.edu.sg/~stevenha/cs2040c/demos/BinaryHeapDemo.cpp" target="_blank"><u>BinaryHeapDemo.cpp</u></a> | <a href="http://www.comp.nus.edu.sg/~stevenha/cs2040c/demos/BinaryHeapDemo.py" target="_blank"><u>py</u></a> | <a href="http://www.comp.nus.edu.sg/~stevenha/cs2040c/demos/BinaryHeapDemo.java" target="_blank"><u>java</u></a>.</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="9-4" title="Go to the previous slide 9-4">&larr;</div>
<div class="electure-next" data-nextid="9-6" title="Go to the next slide 9-6">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-9-6" class="electure-dialog" style="top:70px;left:60px;width:500px;">
<p>For a few more interesting questions about this data structure, please practice on <a href="https://visualgo.net/training?diff=Medium&amp;n=7&amp;tl=0&amp;module=heap"><u>Binary Heap</u></a> training module (no login is required).</p><br><p>However, for NUS students, you should login using your official class account, officially clear this module, and such achievement will be recorded in your user account.</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="9-5" title="Go to the previous slide 9-5">&larr;</div>
<div class="electure-next" data-nextid="9-7" title="Go to the next slide 9-7">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-9-7" class="electure-dialog" style="top:70px;left:60px;width:500px;">
<p>We also have a few programming problems that somewhat requires the usage of this Binary Heap data structure: <a href="https://uva.onlinejudge.org/external/12/1203.pdf" title target="_blank"><u>UVa 01203 - Argus</u></a> and <a href="https://open.kattis.com/problems/numbertree" title target="_blank"><u>Kattis - numbertree</u></a>.</p><br><p>Try them to consolidate and improve your understanding about this data structure. You are allowed to use C++ STL priority_queue, Python heapq, or Java PriorityQueue if that simplifies your implementation.</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="9-6" title="Go to the previous slide 9-6">&larr;</div>
<div class="electure-next" data-nextid="9-8" title="Go to the next slide 9-8">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-9-8" class="electure-dialog" style="top:70px;left:60px;width:500px;">
<div style="background-color: white; color: black;">
<div class="electure-addition">
<p>The content of this interesting slide (the answer of the usually intriguing discussion point from the earlier slide) is hidden and only available for legitimate CS lecturer worldwide. This mechanism is used in the various <a href="https://en.wikipedia.org/wiki/Flipped_classroom" target="_blank"><u>flipped classrooms</u></a> in NUS.</p><br>
<p><b>If you are really a CS lecturer (or an IT teacher)</b> (outside of NUS) and are interested to know the answers, please drop an email to stevenhalim at gmail dot com (<b>show your University staff profile/relevant proof to Steven</b>) for Steven to manually activate this CS lecturer-only feature for you.</p><br>
<p>FAQ: This feature will <b>NOT</b> be given to anyone else who is not a CS lecturer.</p>
</div>
</div>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="9-7" title="Go to the previous slide 9-7">&larr;</div>
<div class="electure-next" data-nextid="9-9" title="Go to the next slide 9-9">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-9-9" class="electure-dialog" style="top:70px;left:60px;width:500px;">
<p>After spending one long lecture on Binary (Max) Heap, here is a jaw-dropping moment...</p><br><p>Binary (Max) Heap data structure is probably <b>not</b> the best data structure to implement (certain operations of) ADT Priority Queue...</p><br><p>Discussion: So what is the alternative data structure?</p>
<div class="electure-addition">
</div>
<div class="electure-prev" data-nextid="9-8" title="Go to the previous slide 9-8">&larr;</div>
<div class="electure-next" data-nextid="9-10" title="Go to the next slide 9-10">&rarr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="electure-9-10" class="electure-dialog" style="top:70px;left:60px;width:500px;">
<div style="background-color: white; color: black;">
<div class="electure-addition">
<p>The content of this interesting slide (the answer of the usually intriguing discussion point from the earlier slide) is hidden and only available for legitimate CS lecturer worldwide. This mechanism is used in the various <a href="https://en.wikipedia.org/wiki/Flipped_classroom" target="_blank"><u>flipped classrooms</u></a> in NUS.</p><br>
<p><b>If you are really a CS lecturer (or an IT teacher)</b> (outside of NUS) and are interested to know the answers, please drop an email to stevenhalim at gmail dot com (<b>show your University staff profile/relevant proof to Steven</b>) for Steven to manually activate this CS lecturer-only feature for you.</p><br>
<p>FAQ: This feature will <b>NOT</b> be given to anyone else who is not a CS lecturer.</p>
</div>
</div>
<div class="electure-addition">
<hr>
<p>You have reached the last slide. Return to 'Exploration Mode' to start exploring!</p>
<p>Note that if you notice any bug in this visualization or if you want to request for a new visualization feature, do not hesitate to drop an email to the project leader: Dr Steven Halim via his email address: stevenhalim at gmail dot com.</p>
</div>
<div class="electure-prev" data-nextid="9-9" title="Go to the previous slide 9-9">&larr;</div>
<div class="electure-read-status" title="Spend some more time reading this slide">&#128337;</div>
</div>
<div id="popup" hidden>
<div id="popup-content"></div>
<span id="hide-popup" hidden>X <u>Close</u></span>
</div>
<div id="rotateDeviceOverlay" style="display: none;">
<div id="rotateDeviceText" style="font-size: 45px; font-weight: bold; text-align: center">Please rotate your device to landscape mode for a better user experience</div>
<div id="widenDeviceText" style="font-size: 45px; font-weight: bold; text-align: center">Please make the window wider for a better user experience</div>
</div>

<style>
        .createNlogN {
            bottom: 200px
        }
    </style>
<style>
        .createN {
            bottom: 173px
        }
    </style>
<style>
        .insert {
            bottom: 146px
        }
    </style>
<style>
        .extractMax {
            bottom: 119px
        }
    </style>
<style>
        .updateKey {
            bottom: 92px
        }
    </style>
<style>
        .delete {
            bottom: 65px
        }
    </style>
<div id="actions" class="panel">
<p class="execAction" id="toggleMode" onClick="toggleMode()">-> Compact Array Mode</p>
<p id="createNlogN">Create(A) - O(<b>N</b> log <b>N</b>)</p>
<p id="createN">Create(A) - O(<b>N</b>)</p>
<p id="insert">Insert(v)</p>
<p id="extractMax">ExtractMax()</p>
<p id="updateKey">UpdateKey(i, newv)</p>
<p id="delete">Delete(i)</p>
</div>
<div id="actions-hide" class="panel-hide"><span style="color:white; font-size: x-large; display: inline-block;">&gt;</span></div>
<div id="actions-extras">
<div class="createNlogN action-menu-pullout">
<div id="createNlogN-input" class="new-menu-option">
A = <input id="arrv1" type="text" title="Enter an Integer or comma-separated array of Integers" autocomplete="off" value="2,7,26,25,19,17,1,90,3,36" style="width: 200px"> </div>
<div id="createNlogN-go" class="execAction new-menu-option coloured-menu-option" onClick="createNlogN()">
<p>Go</p>
</div>
<div id="createNlogN-sampleDes" class="execAction new-menu-option coloured-menu-option" onClick="createNlogNSampleDes()">
<p>Best Case: Sorted Descending</p>
</div>
<div id="createNlogN-input2" class="new-menu-option">
N = <input id="n1" type="number" title="Enter an Integer" autocomplete="off" min="1" max="77" value="16" maxlength="2"> </div>
<div id="createNlogN-random" class="execAction new-menu-option coloured-menu-option" onClick="createNlogNRandom()">
<p>Random</p>
</div>
<div id="createNlogN-sampleAsc" class="execAction new-menu-option coloured-menu-option" onClick="createNlogNSampleAsc()">
<p>Worst Case: Sorted Ascending</p>
</div>
<div id="createNlogN-err" class="err" style="float: left;"></div>
</div>
<div class="createN action-menu-pullout">
<div id="createN-input" class="new-menu-option">
A = <input id="arrv2" type="text" title="Enter an Integer or comma-separated array of Integers" autocomplete="off" value="2,7,26,25,19,17,1,90,3,36" style="width: 200px"> </div>
<div id="createN-go" class="execAction new-menu-option coloured-menu-option" onClick="createN()">
<p>Go</p>
</div>
<div id="createN-sampleDes" class="execAction new-menu-option coloured-menu-option" onClick="createNSampleDes()">
<p>Best Case: Sorted Descending</p>
</div>
<div id="createN-input2" class="new-menu-option">
N = <input id="n2" type="number" title="Enter an Integer" autocomplete="off" min="1" max="77" value="16" maxlength="2"> </div>
<div id="createN-random" class="execAction new-menu-option coloured-menu-option" onClick="createNRandom()">
<p>Random</p>
</div>
<div id="createN-sampleAsc" class="execAction new-menu-option coloured-menu-option" onClick="createNSampleDiagonal()">
<p>Worst Case: Diagonal Entry</p>
</div>
<div id="createN-err" class="err" style="float: left;"></div>
</div>
<div class="insert action-menu-pullout">
<div id="insert-input" class="new-menu-option">
v = <input id="v" type="number" title="Enter an Integer" autocomplete="off" min="-99" max="99" value="50" maxlength="2"> </div>
<div id="insert-go" class="execAction new-menu-option coloured-menu-option" onClick="insert()">
<p>Go</p>
</div>
<div id="insert-err" class="err" style="float: left;"></div>
</div>
<div class="extractMax action-menu-pullout">
<div id="extractMax-once" class="execAction new-menu-option coloured-menu-option" onClick="extractmax()">
<p>1x (Once)</p>
</div>
<div id="extractMax-ktimes-input" class="new-menu-option">
K = <input id="K" type="number" title="Enter an Integer" autocomplete="off" min="2" max="77" value="3" maxlength="2"> </div>
<div id="extractMax-ktimes" class="execAction new-menu-option coloured-menu-option" onClick="partialsort()">
<p>Kx (PartialSort)</p>
</div>
<div id="extractMax-heapsort" class="execAction new-menu-option coloured-menu-option" onClick="heapsort()">
<p>Nx (HeapSort)</p>
</div>
<div id="extractMax-err" class="err" style="float: left;"></div>
</div>
<div class="updateKey action-menu-pullout">
<div id="updateKey-input-i" class="new-menu-option">
i = <input id="upd_i" type="number" title="Enter an Integer" autocomplete="off" min="1" max="18" value="1" maxlength="2"> </div>
<div id="updateKey-input-newv" class="new-menu-option">
newv = <input id="newv" type="number" title="Enter an Integer" autocomplete="off" min="-99" max="99" value="50" maxlength="2"> </div>
<div id="updateKey-go" class="execAction new-menu-option coloured-menu-option" onClick="updatekey()">
<p>Go</p>
</div>
<div id="updateKey-err" class="err" style="float: left;"></div>
</div>
<div class="delete action-menu-pullout">
<div id="delete-input-i" class="new-menu-option">
i = <input id="del_i" type="number" title="Enter an Integer" autocomplete="off" min="1" max="77" value="1" maxlength="2"> </div>
<div id="delete-go" class="execAction new-menu-option coloured-menu-option" onClick="deletei()">
<p>Go</p>
</div>
<div id="delete-err" class="err" style="float: left;"></div>
</div>
</div>

</div>

<div id="bottom-bar">
<a id="scale" style="display: none;">1.0x</a>
<a id="trigger-about">About</a>
<a id="trigger-team">Team</a>
<a id="trigger-terms">Terms of use</a>
<a id="trigger-privacy">Privacy Policy</a>
</div>
<div id="about" class="overlays">
<h4>About</h4><span class="close-overlay">&#x2715;</span>
<div class="content">
<p>Initially conceived in 2011 by Associate Professor Steven Halim, VisuAlgo aimed to facilitate a deeper understanding of data structures and algorithms for his students by providing a self-paced, interactive learning platform.</p><p>Featuring numerous advanced algorithms discussed in Dr. Steven Halim&#39;s book, &#39;Competitive Programming&#39; — co-authored with Dr. Felix Halim and Dr. Suhendry Effendy — VisuAlgo remains the exclusive platform for visualizing and animating several of these complex algorithms even after a decade.</p><p>While primarily designed for National University of Singapore (NUS) students enrolled in various data structure and algorithm courses (e.g., CS1010/equivalent, CS2040/equivalent (including IT5003), CS3230, CS3233, and CS4234), VisuAlgo also serves as a valuable resource for inquisitive minds worldwide, promoting online learning.</p><p>Initially, VisuAlgo was not designed for small touch screens like smartphones, as intricate algorithm visualizations required substantial pixel space and click-and-drag interactions. For an optimal user experience, a minimum screen resolution of 1366x768 is recommended. However, since April 2022, a mobile (lite) version of VisuAlgo has been made available, making it possible to use a subset of VisuAlgo features on smartphone screens.</p><p>VisuAlgo remains a work in progress, with the ongoing development of more complex visualizations. At present, the platform features 24 visualization modules.</p><p>Equipped with a built-in question generator and answer verifier, VisuAlgo&#39;s "online quiz system" enables students to test their knowledge of basic data structures and algorithms. Questions are randomly generated based on specific rules, and students&#39; answers are automatically graded upon submission to our grading server. As more CS instructors adopt this online quiz system worldwide, it could effectively eliminate manual basic data structure and algorithm questions from standard Computer Science exams in many universities. By assigning a small (but non-zero) weight to passing the online quiz, CS instructors can significantly enhance their students&#39; mastery of these basic concepts, as they have access to an almost unlimited number of practice questions that can be instantly verified before taking the online quiz. Each VisuAlgo visualization module now includes its own online quiz component.</p><p>VisuAlgo has been translated into three primary languages: English, Chinese, and Indonesian. Additionally, we have authored public notes about VisuAlgo in various languages, including Indonesian, Korean, Vietnamese, and Thai:</p>
<a href="https://www.facebook.com/notes/steven-halim/httpidvisualgonet-visualisasi-struktur-data-dan-algoritma-dengan-animasi/10153236934439689" target="_blank"><u>id</u></a>,
<a href="http://blog.naver.com/visualgo_nus" target="_blank"><u>kr</u></a>,
<a href="https://www.facebook.com/groups/163215593699283/permalink/824003417620494/" target="_blank"><u>vn</u></a>,
<a href="http://pantip.com/topic/32736343" target="_blank"><u>th</u></a>.
</div>
</div>
<div id="team" class="overlays">
<h4>Team</h4><span class="close-overlay">&#x2715;</span>
<div class="content">
<p>
<strong><span style="line-height: 150%;">Project Leader &amp; Advisor (Jul 2011-present)</span></strong><br>
<a href="https://www.comp.nus.edu.sg/~stevenha/" target="_blank">Associate Professor Steven Halim</a>, School of Computing (SoC), National University of Singapore (NUS)<br>
<a href="https://www.linkedin.com/in/felixhalim/" target="_blank">Dr Felix Halim</a>, Senior Software Engineer, Google (Mountain View)
</p>
<p>
<strong><span style="line-height: 150%;">Undergraduate Student Researchers 1</span></strong><br>
<b>CDTL TEG 1: Jul 2011-Apr 2012</b>: Koh Zi Chun, Victor Loh Bo Huai
</p>
<p>
<strong><span style="line-height: 150%;">Final Year Project/UROP students 1</span></strong><br>
<b>Jul 2012-Dec 2013</b>: Phan Thi Quynh Trang, Peter Phandi, Albert Millardo Tjindradinata, Nguyen Hoang Duy<br>
<b>Jun 2013-Apr 2014</b> <a href="https://www.rosemarietan.com/" target="_blank">Rose Marie Tan Zhao Yun</a>, Ivan Reinaldo
</p>
<p>
<strong><span style="line-height: 150%;">Undergraduate Student Researchers 2</span></strong><br>
<b>CDTL TEG 2: May 2014-Jul 2014</b>: Jonathan Irvin Gunawan, Nathan Azaria, Ian Leow Tze Wei, Nguyen Viet Dung, Nguyen Khac Tung, Steven Kester Yuwono, Cao Shengze, Mohan Jishnu
</p>
<p>
<strong><span style="line-height: 150%;">Final Year Project/UROP students 2</span></strong><br>
<b>Jun 2014-Apr 2015</b>: Erin Teo Yi Ling, Wang Zi<br>
<b>Jun 2016-Dec 2017</b>: Truong Ngoc Khanh, John Kevin Tjahjadi, Gabriella Michelle, Muhammad Rais Fathin Mudzakir<br>
<b>Aug 2021-Apr 2023</b>: Liu Guangyuan, Manas Vegi, Sha Long, Vuong Hoang Long, Ting Xiao, Lim Dewen Aloysius<br>
</p>
<p>
<strong><span style="line-height: 150%;">Undergraduate Student Researchers 3</span></strong><br>
<b>Optiver: Aug 2023-Oct 2023</b>: Bui Hong Duc, Oleh Naver, Tay Ngan Lin<br>
</p>
<p>
<strong><span style="line-height: 150%;">Final Year Project/UROP students 3</span></strong><br>
<b>Aug 2023-Apr 2024</b>: Xiong Jingya, Radian Krisno, Ng Wee Han<br>
</p>
<p>
List of translators who have contributed &ge; 100 translations can be found at <a href="https://visualgo.net/statistics">statistics</a> page.
</p>
<p>
<strong><span style="line-height: 150%;">Acknowledgements</span></strong><br>
NUS <a href="https://nus.edu.sg/cdtl" target="_blank"><u>CDTL</u></a> gave Teaching Enhancement Grant to kickstart this project.<div>For Academic Year 2023/24, a generous donation from Optiver will be used to further develop VisuAlgo.</div>
</p>
</div>
</div>
<div id="termsofuse" class="overlays">
<h4>Terms of use</h4><span class="close-overlay">&#x2715;</span>
<div class="content">
<p>VisuAlgo is generously offered at no cost to the global Computer Science community. If you appreciate VisuAlgo, we kindly request that you <b>spread the word about its existence to fellow Computer Science students and instructors</b>. You can share VisuAlgo through social media platforms (e.g., Facebook, YouTube, Instagram, TikTok, Twitter, etc), course webpages, blog reviews, emails, and more.</p><p>Data Structures and Algorithms (DSA) students and instructors are welcome to use this website directly for their classes. If you capture screenshots or videos from this site, feel free to use them elsewhere, provided that you cite the URL of this website (<a href="https://visualgo.net/">https://visualgo.net</a>) and/or the list of publications below as references. However, please refrain from downloading VisuAlgo&#39;s client-side files and hosting them on your website, as this constitutes plagiarism. At this time, we do not permit others to fork this project or create VisuAlgo variants. Personal use of an offline copy of the client-side VisuAlgo is acceptable.</p><p>Please note that VisuAlgo&#39;s online quiz component has a substantial server-side element, and it is not easy to save server-side scripts and databases locally. Currently, the general public can access the online quiz system only through the &#39;training mode.&#39; The &#39;test mode&#39; offers a more controlled environment for using randomly generated questions and automatic verification in real examinations at NUS.</p><p><strong><span style="line-height: 200%;">List of Publications</span></strong></p> <p>This work has been presented at the CLI Workshop at the ICPC World Finals 2012 (Poland, Warsaw) and at the IOI Conference at IOI 2012 (Sirmione-Montichiari, Italy). You can click <a href="https://ioinformatics.org/journal/INFOL099.pdf" target="_blank">this link</a> to read our 2012 paper about this system (it was not yet called VisuAlgo back in 2012) and <a href="https://ioinformatics.org/journal/v9_2015_243_245.pdf" target="_blank">this link</a> for the short update in 2015 (to link VisuAlgo name with the previous project).</p><p><strong><span style="line-height: 200%;">Bug Reports or Request for New Features</span></strong></p> <p>VisuAlgo is not a finished project. Associate Professor Steven Halim is still actively improving VisuAlgo. If you are using VisuAlgo and spot a bug in any of our visualization page/online quiz tool or if you want to request for new features, please contact Associate Professor Steven Halim. His contact is the concatenation of his name and add gmail dot com.</p>
</div>
</div>
<div id="privacy-policy" class="overlays">
<h4>Privacy Policy</h4><span class="close-overlay">&#x2715;</span>
<div class="content">
<p><b>Version 1.2 (Updated Fri, 18 Aug 2023).</b></p><p>Since Fri, 18 Aug 2023, we no longer use Google Analytics. Thus, all cookies that we use now are solely for the operations of this website. The annoying cookie-consent popup is now turned off even for first-time visitors.</p><p>Since Fri, 07 Jun 2023, thanks to a generous donation by Optiver, anyone in the world can self-create a VisuAlgo account to store a few customization settings (e.g., layout mode, default language, playback speed, etc).</p><p>Additionally, for NUS students, by using a VisuAlgo account (a tuple of NUS official email address, student name as in the class roster, and a password that is encrypted on the server side — no other personal data is stored), you are giving a consent for your course lecturer to keep track of your e-lecture slides reading and online quiz training progresses that is needed to run the course smoothly. Your VisuAlgo account will also be needed for taking NUS official VisuAlgo Online Quizzes and thus passing your account credentials to another person to do the Online Quiz on your behalf constitutes an academic offense. Your user account will be purged after the conclusion of the course unless you choose to keep your account (OPT-IN). Access to the full VisuAlgo database (with encrypted passwords) is limited to Prof Halim himself.</p><p>For other CS lecturers worldwide who have written to Steven, a VisuAlgo account (your (non-NUS) email address, you can use any display name, and encrypted password) is needed to distinguish your online credential versus the rest of the world. Your account will have CS lecturer specific features, namely the ability to see the hidden slides that contain (interesting) answers to the questions presented in the preceding slides before the hidden slides. You can also access Hard setting of the VisuAlgo Online Quizzes. You can freely use the material to enhance your data structures and algorithm classes. Note that there can be other CS lecturer specific features in the future.<br></p><p>For anyone with VisuAlgo account, you can remove your own account by yourself should you wish to no longer be associated with VisuAlgo tool.</p>
</div>
</div>
</div>


<script src="../../code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
<script src="../../cdn.jsdelivr.net/npm/bootstrap%405.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<script src="../../unpkg.com/d3-force-boundary%400.0.1/dist/d3-force-boundary.min.js"></script>
<script>
  $(function () {
    // overlays stuffs
    $('#trigger-about').click(function() {
      if ($(window).width() > 600) {
        $('#dark-overlay').fadeIn(function() {
          $('#about').fadeIn();
        });
      }
      else
        alert('Sorry, this dialog is too big. Please load it on bigger screen');
    });

    $('#trigger-team').click(function() {
      if ($(window).width() > 600) {
        $('#dark-overlay').fadeIn(function() {
          $('#team').fadeIn();
        });
      }
      else
        alert('Sorry, this dialog is too big. Please load it on bigger screen');
    });

    $('#trigger-terms').click(function() {
      if ($(window).width() > 600) {
        $('#dark-overlay').fadeIn(function() {
          $('#termsofuse').fadeIn();
        });
      }
      else
        alert('Sorry, this dialog is too big. Please load it on bigger screen');
    });

    $('#trigger-privacy').click(function () {
      if ($(window).width() > 600) {
        $('#dark-overlay').fadeIn(function() {
          $('#privacy-policy').fadeIn();
        });
      }
      else
        alert('Sorry, this dialog is too big. Please load it on bigger screen');
    })

    $('.close-overlay').click(function() {
      $('.overlays').fadeOut(function() {
        $('#dark-overlay').fadeOut();
      });
    });

    $('#dark-overlay').click(function() {
      $('.overlays').fadeOut();
      $('#dark-overlay').fadeOut();
      if (typeof GeometryWidget !== 'undefined') {
        GeometryWidget.stopLoop();
      }
    });
  })
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-1566631-4"></script>
<script>
      $.ajaxSetup({
        headers: {
          'X-CSRF-TOKEN': "dOvHLDgQSeBxDYich7PEZml1cYPqAYZaOAN2Xn3H"
        }
      });

      // handles account dropdown menu
      $(function () {
        $('#language-dropdown-btn').click(function (e) {
          $('#language-dropdown-menu').css('display', 'block');
          $('#account-dropdown-menu').css('display', 'none')
          e.stopPropagation()
        })
        $(document).click(function () {
          $('#language-dropdown-menu').css('display', 'none')
        })
      })

      $(function () {
        $('#account-dropdown-btn').click(function (e) {
          $('#account-dropdown-menu').css('display', 'block')
          $('#language-dropdown-menu').css('display', 'none')
          e.stopPropagation()
        })
        $(document).click(function (e) {
          $('#account-dropdown-menu').css('display', 'none')
        })
      })

      // surprise colour!
      // Referenced to in  home.js and viz.js also
      var colourArray = ["#52bc69", "#d65775"/*"#ed5a7d"*/, "#2ebbd1", "#d9513c", "#fec515", "#4b65ba", "#ff8a27", "#a7d41e"]; // green, pink, blue, red, yellow, indigo, orange, lime

      function disableScroll() { $('html').css('overflow', 'hidden'); }

      function enableScroll() { $('html').css('overflow', 'visible'); }

      function replaceAll(find, replace, str) { return str.replace(new RegExp(find, 'g'), replace); }

      function getColours() {
        var generatedColours = new Array();
        while (generatedColours.length < 4) {
          var n = (Math.floor(Math.random() * colourArray.length));
          if ($.inArray(n, generatedColours) == -1)
            generatedColours.push(n);
        }
        return generatedColours;
      }

      function isOn(value, position) {
        return (value>>position) & 1 === 1;
      }

      function customAlert(msg) {
        $('#custom-alert p').html(msg);
        var m = -1 * ($('#custom-alert').outerHeight()/2);
        $('#custom-alert').css('margin-top', m+'px');
        $('#dark-overlay').fadeIn(function() {
          $('#custom-alert').fadeIn(function() {
            setTimeout(function() {
              $('#custom-alert').fadeOut(function() {
                $('#dark-overlay').fadeOut();
              });
            }, 1000);
          });
        });
      }

      function showLoadingScreen() {
        $('#loading-overlay').show();
        $('#loading-message').show();
      }

      function hideLoadingScreen() {
        $('#loading-overlay').hide();
      }

      function commonAction(retval, msg) {
        if (retval) {
          $('#current-action').show();
          $('#current-action').html(mode == "exploration" ? msg : ("e-Lecture Example (auto play until done)<br>" + msg));
          $('#progress-bar').slider("option", "max", gw.getTotalIteration()-1);
          triggerRightPanels();
          isPlaying = true;
        }
      }

      function getQueryVariable(variable) {
        var query = window.location.search.substring(1);
        var vars = query.split('&');
        for (var i = 0; i < vars.length; ++i) {
          var pair = vars[i].split('=');
          if (decodeURIComponent(pair[0]) == variable)
            return decodeURIComponent(pair[1]);
        }
        return "";
      }

      const MOBILE_WIDTH = 1000;
      const matchMediaMobile = window.matchMedia(`only screen and (max-width: ${MOBILE_WIDTH}px)`);
      const matchMediaNarrow = window.matchMedia(`only screen and (max-width: 500px)`);
      function isMobile() {
        return matchMediaMobile.matches;
      }
      //To fix the issue of a narrow desktop window being asked to rotate, I am now checking for it based on the navigator.userAgent to see if its mobile or not.
      //This may change in the future if browsers decide to change the naming of userAgent for mobile browsers so may need to keep an eye on this.
      function isMobileOS() {
        return /Mobi/i.test(navigator.userAgent) && !/ipad/i.test(navigator.userAgent);
      }
      let portraitMatcher = window.matchMedia("(orientation:portrait)");
      function isPortrait() {
        return portraitMatcher.matches;
      }

      var generatedColours = getColours();
      var surpriseColour = colourArray[generatedColours[0]];
      var colourTheSecond = colourArray[generatedColours[1]];
      var colourTheThird = colourArray[generatedColours[2]];
      var colourTheFourth = colourArray[generatedColours[3]];

      $(function() {
        $('.links').css('background', surpriseColour);
        $('.colour').css("color", surpriseColour);
        $('h4').css("background-color", surpriseColour); // about, contact us etc. button background

        // title
        $('#title a').click(function() {
          $('#title a').removeClass('selected-viz');
          $(this).addClass('selected-viz');
        });
      });

/*
      // GA dropped 26 Jun 2023 and then made official on 18 Aug 2023
/*
      // the sunset-ed GA, commented on 26 Jun 2023, and Prof Halim doesn't bother to use anymore
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
*/

      // function setCookie(cname, cvalue, exdays) {
      //   const d = new Date();
      //   d.setTime(d.getTime() + (exdays*24*60*60*1000));
      //   let expires = "expires="+ d.toUTCString();
      //   document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
      // }

//       //         $(function() {
//           $('#gdpr-accept').click(function () {
// /*
//             // added on 26 Jun 2023
//             window.dataLayer = window.dataLayer || [];
//             function gtag(){dataLayer.push(arguments);}
//             gtag('js', new Date());

//             gtag('config', 'UA-1566631-4');
// */
// //            ga('create', 'UA-1566631-4', 'auto');
// //            ga('send', 'pageview');
//             setCookie('use_google_analytics', 'true', 365)
//             $('#gdpr-popup').hide()
//           });
//           $('#gdpr-reject').click(function () {
//             setCookie('use_google_analytics', 'false', 365)
//             $('#gdpr-popup').hide()
//           });
//         });
//       
      $('#gdpr-privacy-policy').click(function () {
        if ($(window).width() > 600) {
          $('#dark-overlay').fadeIn(function() {
            $('#privacy-policy').fadeIn();
          });
        }
        else
          alert('Sorry, this dialog is too big. Please load it on bigger screen');
      })
    </script>

<script src="../js/jquery-ui.min.js"></script>

<script src="../js/d3.min.js"></script>
<script src="../js/viz-1.0.10.js"></script>

<script src="../js/graph_library/constant.js"></script>
<script src="../js/graph_library/drawgraph.js"></script>
<script src="../js/graph_library/GraphEdgeWidget.js"></script>
<script src="../js/graph_library/GraphPolygonWidget.js"></script>
<script src="../js/graph_library/GraphVertexWidget.js"></script>
<script src="../js/graph_library/GraphWidget.js"></script>
<script src="../js/graph_library/helperObjects89db.js?refresh22aug9pm"></script> 
<script src="../js/graph_library/misc.js"></script>
<script src="../js/graph_library/properties.js"></script>
<script src="../js/graph_library/Widget.js"></script>
<script src="../js/graph_library/force_directed_library.js"></script>

<script>
      $(function () {
        let defaultPlaybackSpeed = 1;
                createPlaybackSpeedSlider(defaultPlaybackSpeed);

        $('#scale').show();

        $('#account-dropdown-btn').click(function (e) {
          $('#account-dropdown-menu').css('display', 'block')
          $('#language-dropdown-menu').css('display', 'none')
          e.stopPropagation()
        })
        $(document).click(function (e) {
          $('#account-dropdown-menu').css('display', 'none')
        });
        //Mobile Design Related DOM Manipulations
        if (isMobile()) {
          $("#status").css({
            "bottom": "10%",
            "height": "12%",
            "max-height": "54px"
          });
          $("#current-action").css("bottom", "22%");
          $('#status-hide').remove();
          $('#left-bar').remove();
          $('#right-bar').remove();
          $("#mode-menu").remove();
          $("#codetrace").css("z-index", 1);
          $("#bottom-bar a").hide();
          $("#bottom-bar").css("height", $("#topbar").css("height"));
          $(".speed-dropup-btn").show();
        $('#scale').show();
          $("#go-to-beginning").remove();
          $("#go-to-end").remove();
          $("#pause").remove();
          $("#play").remove();
          $("#previous").remove();
          $("#next").remove();

          //make progress bar longer
          $("#progress-bar").css({
            left: "30%",
            width: "60%",
            'margin-left': 0
          })
        }
      })

      let mobilePlaybackOverlayTimeout;
      $(function() {
        $("#viz").on("click", () => {
          if (isMobile()) {
            if ($("#mobile-playback-overlay").is(":hidden") && isPlaying) {
              $("#mobile-playback-overlay").fadeIn();
              hideMobilePlaybackOverlay(6000);
            } else {
              $("#mobile-playback-overlay").fadeOut();
            }
          }
        });
        $("#mobile-playback-overlay").on("click", (event) => {
          if (event.target === event.currentTarget) //to ensure clicks on the controls dont fade the overlay
            $("#mobile-playback-overlay").fadeOut();
          else
            hideMobilePlaybackOverlay(5000);
        })
      });
      function hideMobilePlaybackOverlay(timeOut) {
        if (mobilePlaybackOverlayTimeout)
          clearTimeout(mobilePlaybackOverlayTimeout);
        mobilePlaybackOverlayTimeout = setTimeout(() => {
            $("#mobile-playback-overlay").fadeOut();
        }, timeOut);
      }
      function mobilePlaybackPauseOrPlay() {
        if ($("#mobile-playback-overlay").hasClass("playing")) {
          pause();
          hideMobilePlaybackOverlay(5000);
        } else {
          play();
          hideMobilePlaybackOverlay(3000);
        }
      }
      let rewindLabelTimeout, forwardLabelTimeout;
      function mobilePlaybackRewind() {
        $("#mobile-playback-rewind-label").css("opacity", 1);
        if (rewindLabelTimeout)
          clearTimeout(rewindLabelTimeout);
        rewindLabelTimeout = setTimeout(() => {
          $("#mobile-playback-rewind-label").css("opacity", 0);
        }, 800);
        stepBackward(7);
      }
      function mobilePlaybackForward() {
        $("#mobile-playback-forward-label").css("opacity", 1);
        if (forwardLabelTimeout)
          clearTimeout(forwardLabelTimeout);
        forwardLabelTimeout = setTimeout(() => {
          $("#mobile-playback-forward-label").css("opacity", 0);
        }, 800);
        stepForward(7);
      }

      //let eLectureSessionHistory = {};
      const sectorColors = ['#05a4d0', '#f1c706', '#fa0202'];
      function setSlideTimelineColor(slideNo) {
        const sectionNo = slideNo.split('-')[0];
        $(`[slideNo="${slideNo}"]`).css('background', sectorColors[(parseInt(sectionNo) % 3)]);
      }

      let currSlideTimer = null; //global so that we can clear the timeout when required

      const lectureIds = [{"id":94,"category":"heap","order":1,"top":"","right":"","bottom":"60px","left":"50%","marginLeft":"-250px","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-02-19 11:38:05","updated_at":"2023-04-17 09:10:07","section":-1,"code":"","section_order":-1,"value":"1","text":"<p>A Binary (Max) Heap is a <a href=\"https:\/\/en.wikipedia.org\/wiki\/Binary_tree#Types_of_binary_trees\" target=\"_blank\"><u>complete binary tree<\/u><\/a> that maintains the <a href=\"https:\/\/en.wikipedia.org\/wiki\/Binary_heap\" target=\"_blank\"><u>Max Heap property<\/u><\/a>.<\/p> <br><p>Binary Heap is one possible data structure to model an efficient <a href=\"https:\/\/en.wikipedia.org\/wiki\/Priority_queue\" target=\"_blank\"><u>Priority Queue<\/u><\/a> (PQ) Abstract Data Type (ADT). In a PQ, each element has a \"priority\" and an element with higher priority is served before an element with lower priority (ties are either simply resolved arbitrarily or broken with standard First-In First-Out (FIFO) rule as with a normal Queue). Try clicking <span class=\"slide-actions\" onclick=\"doButtonAction26()\">ExtractMax()<\/span> for a sample animation on extracting the max value of random Binary Heap above.<\/p> <br><p>To focus the discussion scope, this visualization show a Binary <b>Max<\/b> Heap of integers where duplicates are allowed. See <a href=\"?slide=9-1\"><u>this<\/u><\/a> for an easy conversion to Binary <b>Min<\/b> Heap. Generally, any other objects that can be compared can be stored in a Binary Max Heap, e.g., Binary Max Heap of floating points, etc.<\/p>","title":"Binary (Max) Heap"},{"id":230,"category":"heap","order":1,"top":"","right":"","bottom":"60px","left":"50%","marginLeft":"-250px","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-04-25 10:13:13","updated_at":"2023-06-05 13:58:50","section":94,"code":"","section_order":1,"value":"1-1","text":"<p><b>Complete Binary Tree<\/b>: Every level in the binary tree, except possibly the last\/lowest level, is completely filled, and all vertices in the last level are as far left as possible.<\/p><br><p><b>Binary Max Heap property<\/b>: The parent of each vertex - except the root - contains value greater than (or equal to &mdash; we now allow duplicates) the value of that vertex. This is an easier-to-verify definition than the following alternative definition: The value of a vertex - except the leaf\/leaves - must be greater than (or equal to) the value of its one (or two) child(ren).<\/p>","title":"Definitions"},{"id":233,"category":"heap","order":2,"top":"70px","right":"","bottom":"","left":"60px","marginLeft":"","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-04-25 12:33:07","updated_at":"2023-06-05 13:52:35","section":94,"code":"","section_order":1,"value":"1-2","text":"<p>Priority Queue (PQ) Abstract Data Type (ADT) is similar to normal Queue ADT, but with these two major operations:<\/p><ol><li>Enqueue(<b>x<\/b>): Put a new element (key) <b>x<\/b> into the PQ (in some order),<\/li><li><b>y<\/b> = Dequeue(): Return an existing element <b>y<\/b> that has the highest priority (key) in the PQ and if ties, return any.<\/li><\/ol><p>Discussion: Some PQ ADT reverts to First-In First-Out (FIFO) behavior of a normal <a href=\".\/list?mode=Queue\"><u>Queue<\/u><\/a> in the event there is a tie of highest priority (key) in the PQ. Does guaranteeing stability on equal highest priority (key) makes PQ ADT harder to implement?<\/p>","title":"Priority Queue ADT"},{"id":800,"category":"heap","order":3,"top":"70px","right":"","bottom":"","left":"60px","marginLeft":"","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":1,"created_at":"2022-09-07 04:14:26","updated_at":"2023-06-05 13:52:38","section":94,"code":"","section_order":1,"value":"1-3","text":"<p>To maintain stability if there are equal keys, we probably need to attach extra information (arrival time\/arrival index) of each key, so that the comparison function can take the one with earlier arrival time first. Without this extra information, there is no guarantee of stability in the standard Binary Heap implementation.<\/p>","title":"Stability of Equal Highest Key"},{"id":394,"category":"heap","order":4,"top":"70px","right":"","bottom":"","left":"60px","marginLeft":"","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-05-17 13:09:04","updated_at":"2023-09-12 08:21:06","section":94,"code":"","section_order":1,"value":"1-4","text":"<p>Imagine: You are an <a href=\"https:\/\/en.wikipedia.org\/wiki\/Air_traffic_controller\" target=\"_blank\"><u>Air Traffic Controller (ATC)<\/u><\/a> working in the control tower <b>T<\/b> of an airport. You have scheduled aircraft <b>X<\/b>\/<b>Y<\/b> to land in the next 3\/6 minutes, respectively. Both have enough fuel for at least the next 15 minutes and both are just 2 minutes away from your airport. You observe that your airport runway is clear at the moment.<\/p><br><img src=\"\/img\/Airplane_1.png\" width=\"500px\"><br><p>In case you do not know, aircraft can be instructed to fly in <a href=\"https:\/\/en.wikipedia.org\/wiki\/Holding_(aeronautics)\" target=\"_blank\"><u>holding pattern<\/u><\/a> near the airport until the designated landing time.<\/p>","title":"Example"},{"id":395,"category":"heap","order":5,"top":"70px","right":"","bottom":"","left":"60px","marginLeft":"","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-05-17 13:12:31","updated_at":"2023-09-12 08:21:39","section":94,"code":"","section_order":1,"value":"1-5","text":"<p>You have to attend the live lecture to figure out what happens next...<\/p><br><p>There will be two options presented to you and you will have to decide:<\/p><ul><li>Raise AND wave your hand if you choose option A,<\/li><li>Raise your hand but do NOT wave it if you choose option B,<\/li><\/ul><p>If none of the two options is reasonable for you, simply do nothing.<\/p>","title":"For Live Lecture @ NUS Only"},{"id":396,"category":"heap","order":6,"top":"70px","right":"","bottom":"","left":"60px","marginLeft":"","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":1,"created_at":"2017-05-17 13:17:10","updated_at":"2023-09-12 08:22:11","section":94,"code":"","section_order":1,"value":"1-6","text":"<p>Suddenly, you receive an urgent SOS message that another aircraft <b>Z<\/b> is running out of fuel and request to land soon. The pilot of aircraft <b>Z<\/b> estimates that he only have 3 minutes of flying time and also approximately 3 minutes away from your airport...<\/p><br><img src=\"\/img\/Airplane_2.png\" width=\"500px\"><br><input class=\"mcq-answer\" id=\"mcq-answer-21\" value=\"91\" hidden><p>Quiz: <b>You...<\/b><\/p><form><input type=\"radio\" name=\"mcq-21-choice\" value=\"92\"> Option B: Stick with the original plan\u2026<br><input type=\"radio\" name=\"mcq-21-choice\" value=\"91\"> Option A: Let aircraft <b>Z<\/b> lands first and hold <b>X<\/b> and <b>Y<\/b>...<br><\/form><button class=\"mcq-submit\" id=\"submit-21\">Submit<\/button> <span id=\"answer-status-21\"><\/span><br><br><p>History: <a href=\"https:\/\/en.wikipedia.org\/wiki\/Avianca_Flight_52\" target=\"_blank\"><u>Avianca Flight 52<\/u><\/a>.<\/p>","title":"The Example - Continued"},{"id":246,"category":"heap","order":7,"top":"70px","right":"","bottom":"","left":"60px","marginLeft":"","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-05-01 06:12:10","updated_at":"2023-06-05 13:55:41","section":94,"code":"","section_order":1,"value":"1-7","text":"<p>There are several potential usages of PQ ADT in real-life on top of what you have seen just now regarding ATC (only in live lecture).<\/p><br><p>Discussion: Can you mention a few other real-life situations where a PQ is needed?<\/p>","title":"PQ Examples"},{"id":398,"category":"heap","order":8,"top":"70px","right":"","bottom":"","left":"60px","marginLeft":"","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":1,"created_at":"2017-05-17 13:29:33","updated_at":"2023-06-05 14:01:45","section":94,"code":"","section_order":1,"value":"1-8","text":"<ol><li>Emergency situation in a Hospital prioritizing urgent cases (triage),<\/li><li>Priority lanes for pregnant women and senior citizens in public places,<\/li><li>Call center (priority) queue management, e.g., emergency-related calls (995 in Singapore, 911 in the Americas, etc) are prioritised,<\/li><li>Priority (more expensive, usually limited per day) tickets in amusement parks,<\/li><li>Stock market trading where higher priority\/value transactions are prioritized,<\/li><li>Etc<\/li><\/ol>","title":"Potential Answers"},{"id":247,"category":"heap","order":9,"top":"70px","right":"","bottom":"","left":"60px","marginLeft":"","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-05-01 06:14:29","updated_at":"2023-06-05 13:52:57","section":94,"code":"","section_order":1,"value":"1-9","text":"<p>We are able to implement this PQ ADT using (circular) array or <a href=\".\/list\"><u>Linked List<\/u><\/a> but we will have slow (i.e., in O(<b>N<\/b>)) Enqueue or Dequeue operation.<\/p><br><p>Discussion: Why?<\/p>","title":"Linear DS for PQ?"},{"id":399,"category":"heap","order":10,"top":"70px","right":"","bottom":"","left":"60px","marginLeft":"","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":1,"created_at":"2017-05-17 13:30:39","updated_at":"2023-06-05 13:53:00","section":94,"code":"","section_order":1,"value":"1-10","text":"<p>There are two strategies using (circular) Array or Linked List implementation.<\/p><br><p>Strategy 1 maintains this property: The content of array\/linked list is always in correct order, i.e. from higher priority elements to lower priority elements.<\/p><ol><li>Enqueue(x) requires lots of work as we have to scan the PQ from front to back in O(<b>N<\/b>) to find the correct insertion point and make a space (if using array) \u2013 recall <a href=\".\/sorting?mode=Insertion\"><u>Insertion Sort<\/u><\/a>.<\/li><li>But y = Dequeue() is just O(<b>1<\/b>) as we can just return the front-most element  (front of circular array or head of a Linked List) which has the highest priority.<\/li><\/ol>","title":"The Answer - Part 1"},{"id":400,"category":"heap","order":11,"top":"70px","right":"","bottom":"","left":"60px","marginLeft":"","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":1,"created_at":"2017-05-17 13:33:37","updated_at":"2023-06-05 13:53:04","section":94,"code":"","section_order":1,"value":"1-11","text":"<p>Strategy 2 maintains another property: Dequeue() operation returns the correct element.<\/p><ol><li>Enqueue(x) can be made simple. We simply put the new element at the back of the PQ (back of circular array or back of a Linked List), O(<b>1<\/b>).<\/li><li>y = Dequeue() requires lots of work as we need to scan the whole PQ from front to back in O(<b>N<\/b>) to correctly return the first element with highest priority and close the gap (if using array).<\/li><\/ol><p>We see that both strategies have inefficient O(<b>N<\/b>) operation in it. We will soon see one possible data structure that allows us to implement both Enqueue and Dequeue operations in much more efficient O(log <b>N<\/b>) time: Binary Heap.<\/p>","title":"The Answer - Part 2"},{"id":99,"category":"heap","order":2,"top":"290px","right":"","bottom":"","left":"50%","marginLeft":"-250px","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-02-19 12:06:08","updated_at":"2023-06-05 14:02:53","section":-1,"code":"","section_order":-1,"value":"2","text":"<p>Now, let&#39;s view the visualisation of a (random) Binary (Max) Heap above. You should see a complete binary tree and all vertices except the root satisfy the Max Heap property (A[parent(i)] &ge; A[i]). Duplicate integer keys may appear.<\/p><br><p>You can <span class=\"slide-actions\" onclick=\"doButtonAction130()\">Toggle the Visualization Mode<\/span> between the visually more intuitive complete binary tree form or the underlying compact array based implementation of a Binary (Max) Heap.<\/p><br><input class=\"mcq-answer\" id=\"mcq-answer-6\" value=\"32\" hidden><p>Quiz: <b>Based on this Binary (Max) Heap property, where will the largest integer be located?<\/b><\/p><form><input type=\"radio\" name=\"mcq-6-choice\" value=\"34\"> Can be anywhere<br><input type=\"radio\" name=\"mcq-6-choice\" value=\"33\"> At one of the leaf<br><input type=\"radio\" name=\"mcq-6-choice\" value=\"32\"> At the root<br><\/form><button class=\"mcq-submit\" id=\"submit-6\">Submit<\/button> <span id=\"answer-status-6\"><\/span>","title":"Visualisation + Max Heap Property"},{"id":238,"category":"heap","order":1,"top":"290px","right":"","bottom":"","left":"50%","marginLeft":"-250px","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-04-25 13:21:01","updated_at":"2017-05-18 03:37:32","section":99,"code":"hw.restoreArray([999999,71,62,53,44,35,26,17]);","section_order":2,"value":"2-1","text":"<p>Important fact to memorize at this point: If we have a Binary Heap of <b>N<\/b> elements, its height will not be taller than O(log <b>N<\/b>) since we will store it as a complete binary tree.<\/p><br><p>Simple analysis: The size <b>N<\/b> of a full (more than just a complete) binary tree of height <b>h<\/b> is always <b>N = 2<sup>(h+1)<\/sup>-1<\/b>, therefore <b>h = log<sub>2<\/sub>(N+1)-1 ~= log<sub>2<\/sub> N<\/b>.<\/p><br><p>See example above with <b>N = 7 = 2<sup>(2+1)<\/sup>-1<\/b> or <b>h = log<sub>2<\/sub>(7+1)-1 = 2<\/b>.<\/p><br><p>This fact is important in the analysis of all Binary Heap-related operations.<\/p>","title":"Binary Heap has O(log N) Height"},{"id":234,"category":"heap","order":2,"top":"290px","right":"","bottom":"","left":"50%","marginLeft":"-250px","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-04-25 12:48:03","updated_at":"2023-06-05 14:06:58","section":99,"code":"hw.createRandomMaxHeap();","section_order":2,"value":"2-2","text":"<p>A complete binary tree can be stored efficiently as a compact array A as there is no gap between vertices of a complete binary tree\/elements of a compact array. To simplify the navigation operations below, we use 1-based array. VisuAlgo displays the index of each vertex as a <span style=\"color: red;\">red label<\/span> below each vertex. Read those indices in sorted order from 1 to <b>N<\/b>, then you will see the vertices of the complete binary tree from top to down, left to right. To help you understand this, <span class=\"slide-actions\" onclick=\"doButtonAction130()\">Toggle the Visualization Mode<\/span> several times.<\/p><br><p>This way, we can implement basic binary tree traversal operations with simple index manipulations (with help of <a href=\".\/bitmask\"><u>bit shift manipulation<\/u><\/a>):<\/p><ol><li>parent(i) = i&gt;&gt;1, index i divided by 2 (integer division),<\/li><li>left(i) = i&lt;&lt;1, index i multiplied by 2,<\/li><li>right(i) = (i&lt;&lt;1)+1, index i multiplied by 2 and added by 1.<\/li><\/ol><p>Pro tip: Try opening two copies of VisuAlgo on two browser windows. Try to visualize the same Binary Max Heap in two different modes and compare them.<\/p>","title":"1-based Compact Array"},{"id":96,"category":"heap","order":3,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-02-19 11:45:01","updated_at":"2023-03-28 14:18:15","section":-1,"code":"","section_order":-1,"value":"3","text":"<p>In this visualization, you can perform several Binary (Max) Heap operations:<\/p><ol><li><b>Create(A)<\/b> - O(<b>N<\/b> log <b>N<\/b>) version (<b>N<\/b> calls of <b>Insert(v)<\/b> below)<\/li><li><b>Create(A)<\/b> - O(<b>N<\/b>) version<\/li><li><b>Insert(v)<\/b> in O(log <b>N<\/b>) &mdash; you are allowed to insert duplicates<\/li><li>3 versions of <b>ExtractMax()<\/b>:<ol><li>Once, in O(log <b>N<\/b>)<\/li><li><b>K<\/b> times, i.e., <b>PartialSort()<\/b>, in O(<b>K<\/b> log <b>N<\/b>), or <\/li><li><b>N<\/b> times, i.e., <b>HeapSort()<\/b>, in O(<b>N<\/b> log <b>N)<\/b><\/li><\/ol><\/li><li><b>UpdateKey(i, newv)<\/b> in O(log <b>N<\/b> if <b>i<\/b> is known)<\/li><li><b>Delete(i)<\/b> in O(log <b>N<\/b> if <b>i<\/b> is known)<\/li><\/ol><p>There are a few other possible Binary (Max) Heap operations, but currently we do not elaborate them for pedagogical reason in a certain NUS module.<\/p>","title":"Binary (Max) Heap Operations"},{"id":401,"category":"heap","order":1,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":1,"created_at":"2017-05-18 03:40:10","updated_at":"2023-03-28 14:18:25","section":96,"code":"","section_order":3,"value":"3-1","text":"<p>For NUS students only:<\/p><ol><li>Increase\/Decrease\/UpdateKey(old_v, new_v),<\/li><li>DeleteKey(v) \u2014 v is not necessarily the max element,<\/li><li>ExtractMin() and ExtractMax() on the same priority queue.<\/li><\/ol>","title":"What Are The Extra Operations?"},{"id":217,"category":"heap","order":4,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-04-15 14:15:01","updated_at":"2023-06-06 05:56:53","section":-1,"code":"$(\"#insert\").click().addClass(\"menu-highlighted\");","section_order":-1,"value":"4","text":"<p><b>Insert(v)<\/b>: Insertion of a new item <b>v<\/b> into a Binary Max Heap can only be done at the <i>last index <b>N<\/b> plus 1<\/i> to maintain the compact array = complete binary tree property. However, the Max Heap property <i>may<\/i> still be violated. This operation then fixes Max Heap property from the insertion point <b>upwards<\/b> (if necessary) and stop when there is no more Max Heap property violation. Now try clicking <span class=\"slide-actions\" onclick=\"doButtonAction27()\">Insert(v)<\/span> several times to insert a few random <b>v<\/b> to the currently displayed Binary (Max Heap).<\/p><br><p>The fix Max Heap property upwards operation has no standard name. We call it <b>ShiftUp<\/b> but others may call it <b>BubbleUp<\/b> or <b>IncreaseKey<\/b> operation.<\/p>","title":"Insert(v)"},{"id":249,"category":"heap","order":1,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-05-01 06:28:47","updated_at":"2021-12-16 09:27:01","section":217,"code":"$(\"#insert\").click().addClass(\"menu-highlighted\");","section_order":4,"value":"4-1","text":"<p>Do you understand why starting from the insertion point (index <b>N<\/b>+1) upwards (at most until the root) and swapping a vertex with its parent when there is a Max Heap property violation during insertion is always a correct strategy?<\/p>","title":"Why it is Correct?"},{"id":235,"category":"heap","order":2,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":1,"created_at":"2017-04-25 12:52:23","updated_at":"2021-12-16 09:27:04","section":217,"code":"$(\"#insert\").click().addClass(\"menu-highlighted\");","section_order":4,"value":"4-2","text":"<p>Think about Max Heap property before and after such swap (vertex <b>x<\/b> and its parent <b>y<\/b> has value <b>A[y] &lt; A[x]<\/b>), you should see that such swap fixes the Max Heap property between swapped vertices (<b>A[y] &gt; A[x]<\/b> afterwards).<\/p>","title":"The Answer"},{"id":679,"category":"heap","order":3,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2018-02-20 04:23:52","updated_at":"2021-12-16 09:27:07","section":217,"code":"$(\"#insert\").click().addClass(\"menu-highlighted\");","section_order":4,"value":"4-3","text":"<p>The time complexity of this <b>Insert(v)<\/b> operation is O(log <b>N<\/b>).<\/p><br><p>Discussion: Do you understand the derivation?<\/p>","title":"Time Complexity Analysis"},{"id":680,"category":"heap","order":4,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":1,"created_at":"2018-02-20 04:26:14","updated_at":"2021-12-16 09:27:09","section":217,"code":"$(\"#insert\").click().addClass(\"menu-highlighted\");","section_order":4,"value":"4-4","text":"<p>Analysis: The worst case of <b>Insert(v)<\/b> is when we insert a new element <b>v<\/b> that is greater than the value of the current root. Such insertion causes <b>Insert(v)<\/b> to fix Max Heap property from a leaf up to the root and therefore runs in O(log <b>N<\/b>) as a complete binary tree can never be taller than O(log <b>N<\/b>). Now try <span class=\"slide-actions\" onclick=\"doButtonAction34()\">Insert(v) - Extreme<\/span> where we will insert a new element that is always 1 more than the current root.<\/p>","title":"The Answer"},{"id":97,"category":"heap","order":5,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-02-19 11:45:29","updated_at":"2021-12-16 09:29:47","section":-1,"code":"$(\"#extractMax\").click().addClass(\"menu-highlighted\");\n$(\"#extractMax-once\").addClass(\"menu-highlighted\");","section_order":-1,"value":"5","text":"<p><b>ExtractMax()<\/b>: The reporting and then the deletion of the maximum element (the root) of a Binary Max Heap requires an existing element to replace the root, otherwise the Binary Max Heap (a single complete binary tree, or \u6797\/L\u00edn in Chinese\/tree) becomes two disjoint subtrees (two copies of \u6728\/m\u00f9 in Chinese\/wood). That element must be the <i>last index<\/i> <b>N<\/b> for the same reason: To maintain the compact array = complete binary tree property.<\/p><br><p>Because we promote a leaf vertex to the root vertex of a Binary Max Heap, it will very likely violates the Max Heap property. ExtractMax() operation then fixes Binary Max Heap property from the root <b>downwards<\/b> by comparing the current value with the its child\/the larger of its two children (if necessary). Now try <span class=\"slide-actions\" onclick=\"doButtonAction26()\">ExtractMax()<\/span> on the currently displayed Binary (Max) Heap.<\/p><br><p>The fix Max Heap property downwards operation has no standard name. We call it <b>ShiftDown<\/b> but others may call it <b>BubbleDown<\/b> or <b>Heapify<\/b> operation.<\/p>","title":"ExtractMax() - Once"},{"id":248,"category":"heap","order":1,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-05-01 06:27:53","updated_at":"2021-12-16 09:29:44","section":97,"code":"$(\"#extractMax\").click().addClass(\"menu-highlighted\");\n$(\"#extractMax-once\").addClass(\"menu-highlighted\");","section_order":5,"value":"5-1","text":"<p>Why if a vertex has two children, we have to check (and possibly swap) that vertex with <i>the larger<\/i> of its two children during the downwards fix of Max Heap property?<\/p><br><p>Why can&#39;t we just compare with the left (or right, if exists) vertex only?<\/p>","title":"Why Compare with the Larger Child?"},{"id":236,"category":"heap","order":2,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":1,"created_at":"2017-04-25 13:01:13","updated_at":"2023-06-06 05:47:42","section":97,"code":"$(\"#extractMax\").click().addClass(\"menu-highlighted\");\n$(\"#extractMax-once\").addClass(\"menu-highlighted\");","section_order":5,"value":"5-2","text":"<p>You can construct a simple counterexample that comparing with left vertex only (or right vertex only) can produce wrong answer, try extracting 4 out of Binary (Max) Heap [4,2,3,1], see the ASCII art below.<\/p><pre>    4<br>   \/ &bsol;<br>  2   3<br> \/<br>1<\/pre><p>When 4 is extracted and vertex with value 1 becomes the new root, what happens if 1 does NOT swap with max(2, 3) = 3 but swap with 2 instead?<\/p>","title":"The Answer"},{"id":681,"category":"heap","order":3,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2018-02-20 04:37:27","updated_at":"2021-12-16 09:29:39","section":97,"code":"$(\"#extractMax\").click().addClass(\"menu-highlighted\");\n$(\"#extractMax-once\").addClass(\"menu-highlighted\");","section_order":5,"value":"5-3","text":"<p>The time complexity of this <b>ExtractMax()<\/b> operation is O(log <b>N<\/b>).<\/p><br><p>Discussion: Do you understand the derivation?<\/p>","title":"Time Complexity Analysis"},{"id":682,"category":"heap","order":4,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":1,"created_at":"2018-02-20 04:38:02","updated_at":"2023-06-06 05:52:59","section":97,"code":"$(\"#extractMax\").click().addClass(\"menu-highlighted\");\n$(\"#extractMax-once\").addClass(\"menu-highlighted\");","section_order":5,"value":"5-4","text":"<p>Analysis: This operation also runs in O(log <b>N<\/b>) as in the worst case, the last vertex (a leaf) happens to have the smallest value, try [9,8,7,6,5,4,3,2,1], see the ASCII art below.<\/p><pre>        9<br>     \/     &bsol;<br>    8       7<br>   \/ &bsol;     \/ &bsol;<br>  6   5   4   3<br> \/ &bsol;<br>2   1<\/pre><p>When the last existing leaf with value 1 is promoted to the root (replacing 9), it will eventually trickle back to one of the leaf via a path that has up to O(log <b>N<\/b>) edges.<\/p>","title":"The Answer"},{"id":402,"category":"heap","order":6,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-05-18 03:54:20","updated_at":"2023-06-06 05:57:56","section":-1,"code":"$(\"#insert\").addClass(\"menu-highlighted\");\n$(\"#extractMax\").click().addClass(\"menu-highlighted\");\n$(\"#extractMax-once\").addClass(\"menu-highlighted\");","section_order":-1,"value":"6","text":"<p>Up to here, we have a data structure that can implement the two major operations of Priority Queue (PQ) ADT efficiently:<\/p><ol><li>For <b>Enqueue(x)<\/b>, we can use <b>Insert(x)<\/b> in O(log <b>N<\/b>) time, and<\/li><li>For <b>y<\/b> = Dequeue(), we can use <b>y = ExtractMax()<\/b> in O(log <b>N<\/b>) time.<\/li><\/ol><p>However, we can do a few more operations with Binary Heap.<\/p>","title":"Binary Heap for Efficient PQ"},{"id":100,"category":"heap","order":7,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-02-19 12:07:01","updated_at":"2021-12-16 09:31:01","section":-1,"code":"$(\"#createNlogN\").addClass(\"menu-highlighted\");\n$(\"#createN\").addClass(\"menu-highlighted\");","section_order":-1,"value":"7","text":"<p><b>Create(A)<\/b>: Creates a valid Binary (Max) Heap from an input array <b>A<\/b> of <b>N<\/b> integers (comma separated) into an initially empty Binary Max Heap.<\/p><br><p>There are two variants for this operations, one that is simpler but runs in O(<b>N<\/b> log <b>N<\/b>) and a more advanced technique that runs in O(<b>N<\/b>).<\/p><br><p>Pro tip: Try opening two copies of VisuAlgo on two browser windows. Execute different Create(A) versions on the worst case &#39;Sorted example&#39; to see the <i>somewhat dramatic<\/i> differences of the two.<\/p>","title":"Create(A) - Two Versions"},{"id":215,"category":"heap","order":1,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-04-15 13:38:34","updated_at":"2023-06-06 05:55:00","section":100,"code":"$(\"#createNlogN\").click().addClass(\"menu-highlighted\");","section_order":7,"value":"7-1","text":"<p><b>Create(A) - O(N log N)<\/b>: Simply insert (that is, by calling <b>Insert(v) <\/b>operation) all <b>N<\/b> integers of the input array into an initially empty Binary Max Heap one by one.<\/p><br><p><b>Analysis<\/b>: This operation is clearly O(<b>N<\/b> log <b>N<\/b>) as we call O(log <b>N<\/b>) <b>Insert(v)<\/b> operation <b>N<\/b> times. Let&#39;s examine the &#39;Sorted example&#39; which is one of the hard case of this operation (Now try the <span class=\"slide-actions\" onclick=\"doButtonAction23()\">Hard Case - O(N log N)<\/span> where we show a case where <b>A = [1,2,3,4,5,6,7]<\/b> -- please be patient as this example will take some time to complete). If we insert values in increasing order into an initially empty Binary Max Heap, then every insertion triggers a path from the insertion point (a new leaf) upwards to the root.<\/p>","title":"Create(A) - O(N log N)"},{"id":216,"category":"heap","order":2,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-04-15 13:41:45","updated_at":"2023-06-06 05:55:32","section":100,"code":"$(\"#createN\").click().addClass(\"menu-highlighted\");","section_order":7,"value":"7-2","text":"<p><b>Create(A) - O(N)<\/b>: This faster version of <b>Create(A)<\/b> operation was invented by Robert W. Floyd in 1964. It takes advantage of the fact that a compact array = complete binary tree and all leaves (i.e., half of the vertices \u2014 see the next slide) are Binary Max Heap by default. This operation then fixes Binary Max Heap property (if necessary) only from the last internal vertex back to the root.<\/p><br><p><b>Analysis<\/b>: A loose analysis gives another O(<b>N<\/b>\/2 log <b>N<\/b>) = O(<b>N<\/b> log <b>N<\/b>) complexity but it is actually just O(2*<b>N<\/b>) = O(<b>N<\/b>) \u2014 details in the next few slides. Now try the <span class=\"slide-actions\" onclick=\"doButtonAction24()\">Hard Case - O(N)<\/span> on the same input array <b>A = [1,2,3,4,5,6,7]<\/b> and see that on the same hard case as with the previous slide (but not the one that generates maximum number of swaps &mdash; try &#39;Diagonal Entry&#39; test case by yourself), this operation is far superior than the O(<b>N<\/b> log <b>N<\/b>) version.<\/p>","title":"Create(A) - O(N)"},{"id":232,"category":"heap","order":3,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-04-25 12:23:13","updated_at":"2021-12-17 04:32:45","section":100,"code":"$(\"#createN\").click().addClass(\"menu-highlighted\");","section_order":7,"value":"7-3","text":"<p>Simple explanation on why half of Binary (Max) Heap of <b>N<\/b> (without loss of generality, let&#39;s assume that <b>N<\/b> is even) elements are leaves are as follows:<\/p><br><p>Suppose that the last leaf is at index <b>N<\/b>, then the parent of that last leaf is at index <b>i = N\/2 <\/b>(remember <a href=\"?slide=2-2\"><u>this slide<\/u><\/a>). The left child of vertex <b>i+1<\/b>, if exists (it actually does not exist), will be <b>2*(i+1) = 2*(N\/2+1) = N+2<\/b>, which exceeds index <b>N<\/b> (the last leaf) so index <b>i+1<\/b> must also be a leaf vertex that has no child. As Binary Heap indexing is consecutive, basically indices [<b>i+1 = N\/2+1<\/b>, <b>i+2 = N\/2+2<\/b>, ..., <b>N<\/b>], or half of the vertices, are leaves.<\/p>","title":"Many Leaf Vertices"},{"id":237,"category":"heap","order":4,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-04-25 13:05:12","updated_at":"2021-12-16 09:31:11","section":100,"code":"$(\"#createN\").click().addClass(\"menu-highlighted\");\nhw.restoreArray([999999,71,62,53,44,35,26,17]);","section_order":7,"value":"7-4","text":"<p>First, we need to recall that the height of a full binary tree of size <b>N<\/b> is log<sub>2<\/sub> <b>N<\/b>.<\/p><br><p>Second, we need to realise that the cost to run <samp>shiftDown(i)<\/samp> operation is not the gross upper bound O(log <b>N<\/b>), but O(<b>h<\/b>) where <b>h<\/b> is the height of the subtree rooted at <b>i<\/b>.<\/p><br><p>Third, there are <samp>ceil(N\/2<sup>h+1<\/sup>)<\/samp> vertices at height <b>h<\/b> in a full binary tree.<\/p><br><p>On the example full binary tree above with <b>N = 7<\/b> and <b>h = 2<\/b>, there are:<br><samp>ceil(7\/2<sup>0+1<\/sup>) = 4<\/samp> vertices: {44,35,26,17} at height <b>h = 0<\/b>,<br><samp>ceil(7\/2<sup>1+1<\/sup>) = 2<\/samp> vertices: {62,53} at height <b>h = 1<\/b>, and<br><samp>ceil(7\/2<sup>2+1<\/sup>) = 1<\/samp> vertex: {71} at height <b>h = 2<\/b>.<\/p>","title":"Why O(N)? - Part 1"},{"id":403,"category":"heap","order":5,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-05-18 04:12:44","updated_at":"2021-12-16 09:31:16","section":100,"code":"$(\"#createN\").click().addClass(\"menu-highlighted\");\nhw.restoreArray([999999,71,62,53,44,35,26,17]);","section_order":7,"value":"7-5","text":"<p>Cost of Create(A), the O(<b>N<\/b>) version is thus:<\/p><br><img src=\"https:\/\/visualgo.net\/img\/createheapanalysis.png\" width=\"500\" alt=\"analysis\"><br><p>PS: If the formula is too complicated, a modern student can also use <a href=\"http:\/\/www.wolframalpha.com\/input\/?i=0%2F1%2B1%2F2%2B2%2F4%2B3%2F8%2B4%2F16%2B...\" target=\"_blank\"><u>WolframAlpha<\/u><\/a> instead.<\/p>","title":"Why O(N)? - Part 2"},{"id":101,"category":"heap","order":8,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-02-19 12:07:50","updated_at":"2021-12-16 09:31:40","section":-1,"code":"$(\"#extractMax\").click().addClass(\"menu-highlighted\");\n$(\"#extractMax-heapsort\").addClass(\"menu-highlighted\");","section_order":-1,"value":"8","text":"<p><b>HeapSort()<\/b>: John William Joseph Williams invented <b>HeapSort()<\/b> algorithm in 1964, together with this Binary Heap data structure. <b>HeapSort()<\/b> operation (assuming the Binary Max Heap has been created in O(<b>N<\/b>)) is very easy. Simply call the O(log <b>N<\/b>) <b>ExtractMax()<\/b> operation <b>N<\/b> times. Now try <span class=\"slide-actions\" onclick=\"doButtonAction25()\">HeapSort()<\/span> on the currently displayed Binary (Max) Heap.<\/p><br><p><b>Simple Analysis<\/b>: <b>HeapSort()<\/b> clearly runs in O(<b>N<\/b> log <b>N<\/b>) \u2014 an optimal comparison-based sorting algorithm.<\/p><br><input class=\"msq-answer\" id=\"msq-answer-7\" value=\"36,37,38\" hidden><p>Quiz: <b>In worst case scenario, HeapSort() is asymptotically faster than...<\/b><\/p><input type=\"checkbox\" class=\"msq-choice\" id=\"msq-7-choice-35\"> Merge Sort<br><input type=\"checkbox\" class=\"msq-choice\" id=\"msq-7-choice-36\"> Selection Sort<br><input type=\"checkbox\" class=\"msq-choice\" id=\"msq-7-choice-37\"> Bubble Sort<br><input type=\"checkbox\" class=\"msq-choice\" id=\"msq-7-choice-38\"> Insertion Sort<br><button class=\"msq-submit\" id=\"submit-7\">Submit<\/button> <span id=\"answer-status-7\"><\/span>","title":"HeapSort()"},{"id":231,"category":"heap","order":1,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-04-25 12:20:18","updated_at":"2021-12-20 17:20:37","section":101,"code":"$(\"#extractMax\").click().addClass(\"menu-highlighted\");\n$(\"#extractMax-heapsort\").addClass(\"menu-highlighted\");","section_order":8,"value":"8-1","text":"<p>Although <b>HeapSort()<\/b> runs in \u03b8(<b>N<\/b> log <b>N<\/b>) time for all (best\/average\/worst) cases, is it really the best <i>comparison-based<\/i> sorting algorithm?<\/p><br><p>Discussion: How about caching performance of <b>HeapSort()<\/b>?<\/p>","title":"Discussion"},{"id":404,"category":"heap","order":2,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":1,"created_at":"2017-05-18 04:19:49","updated_at":"2021-12-16 09:32:10","section":101,"code":"$(\"#extractMax\").click().addClass(\"menu-highlighted\");\n$(\"#extractMax-heapsort\").addClass(\"menu-highlighted\");","section_order":8,"value":"8-2","text":"<p>HeapSort() actually has a rather bad caching performance as it does not utilize array locality well.<\/p><br><p>Notice that the index i and its parent(i) differ by factor of 2 and similarly between index i and either its left(i)\/right(i) child.<\/p>","title":"The Answer"},{"id":758,"category":"heap","order":3,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2021-12-15 04:51:28","updated_at":"2023-06-06 06:01:50","section":101,"code":"$(\"#extractMax\").click().addClass(\"menu-highlighted\");\n$(\"#extractMax-ktimes\").addClass(\"menu-highlighted\");","section_order":8,"value":"8-3","text":"<p>We can actually just call the O(log <b>N<\/b>) <b>ExtractMax()<\/b> operation <b>K<\/b> times if we are only interested in the top <b>K<\/b> largest elements in the Binary (Max) Heap. Now try <span class=\"slide-actions\" onclick=\"doButtonAction148()\">PartialSort()<\/span> on the currently displayed Binary (Max) Heap. This operation is called PartialSort().<\/p><br><p><b>Simple Analysis<\/b>: <b>PartialSort()<\/b> clearly runs in O(<b>K<\/b> log <b>N<\/b>) &mdash; an output-sensitive algorithm where the time complexity depends on the output size <b>K<\/b>.<\/p>","title":"PartialSort()"},{"id":226,"category":"heap","order":9,"top":"70px","right":"","bottom":"","left":"60px","marginLeft":"","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-04-25 01:02:59","updated_at":"2023-06-05 14:08:43","section":-1,"code":"","section_order":-1,"value":"9","text":"<p>You have reached the end of the basic stuffs of this Binary (Max) Heap data structure and we encourage you to explore further in the <b>Exploration Mode<\/b>.<\/p><br><p>However, we still have a few more interesting Binary (Max) Heap challenges for you that are outlined in this section.<\/p><br><p>When you have cleared them all, we invite you to study more advanced algorithms that use Priority Queue as (one of) its underlying data structure, like <a href=\".\/mst\" target=\"_blank\"><u>Prim&#39;s MST algorithm<\/u><\/a>, <a href=\".\/sssp\" target=\"_blank\"><u>Dijkstra&#39;s SSSP algorithm<\/u><\/a>, A* search algorithm (not in VisuAlgo yet), a few other greedy-based algorithms, etc.<\/p>","title":"Extras"},{"id":397,"category":"heap","order":1,"top":"290px","right":"","bottom":"","left":"50%","marginLeft":"-250px","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-05-17 13:20:32","updated_at":"2021-12-15 04:45:37","section":226,"code":"hw.restoreArray([999999,-1,-3,-2,-7,-19,-17,-26,-90,-25,-36]);","section_order":9,"value":"9-1","text":"<p>If we only deal with numbers (including this visualization that is restricted to integers only), it is easy to convert a Binary Max Heap into a Binary Min Heap without changing anything, or vice versa.<\/p><br><p>We can re-create a Binary Heap with the negation of every integer in the original Binary Heap. If we start with a Binary Max Heap, the resulting Binary Heap is a Binary Min Heap (if we ignore the negative symbols &mdash; see the picture above), and vice versa.<\/p>","title":"Easy Max to Min Heap Conversion"},{"id":759,"category":"heap","order":2,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2021-12-16 09:26:10","updated_at":"2022-01-30 05:48:23","section":226,"code":"$(\"#updateKey\").click().addClass(\"menu-highlighted\");","section_order":9,"value":"9-2","text":"<p>For some Priority Queue applications (e.g., <a href=\".\/sssp?slide=7-3\"><u>HeapDecreaseKey in Dijkstra&#39;s algorithm<\/u><\/a>), we may have to modify (increase or decrease) the priority of an existing value that is already inserted into a Binary (Max) Heap. If the index <b>i<\/b> of the value is known, we can do the following simple strategy: Simply update <b>A[i] = newv<\/b> and then call <b>both<\/b> <b>shiftUp(i)<\/b> and <b>shiftDown(i)<\/b>. Only at most one of this Max Heap property restoration operation will be successful, i.e., <b>shiftUp(i)<\/b>\/<b>shiftDown(i)<\/b> will be triggered if <b>newv<\/b> &gt;\/&lt; old value of <b>A[parent(i)]<\/b>\/<b>A[larger of the two children of i]<\/b>, respectively.<\/p><br><p>Thus, <b>UpdateKey(i, newv)<\/b> can be done in O(log <b>N<\/b>), provided we know index <b>i<\/b>.<\/p>","title":"UpdateKey(i, newv)"},{"id":760,"category":"heap","order":3,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2021-12-16 09:33:55","updated_at":"2021-12-16 09:44:14","section":226,"code":"$(\"#delete\").click().addClass(\"menu-highlighted\");","section_order":9,"value":"9-3","text":"<p>For some Priority Queue applications, we may have to delete an existing value that is already inserted into a Binary (Max) Heap (and this value happens to be not the root). Again, if the index <b>i<\/b> of the value is known, we can do the following simple strategy: Simply update <b>A[i] = A[1]+1<\/b> (a larger number greater than the current root), call <b>shiftUp(i)<\/b> (technically, <b>UpdateKey(i, A[1]+1)<\/b>). This will floats index <b>i<\/b> to be the new root, and from there, we can easily call <b>ExtractMax()<\/b> once to remove it.<\/p><br><p>Thus, <b>Delete(i)<\/b> can be done in O(log <b>N<\/b>), provided we know index <b>i<\/b>.<\/p><br><p>Discussion: Now for <b>UpdateKey(i, newv)<\/b> and <b>Delete(i)<\/b>, what if we are given <b>oldv<\/b> instead and thus we have to search for its location in the Binary (Max) Heap? Can we do this faster than O(<b>N<\/b>)?<\/p>","title":"Delete(i)"},{"id":761,"category":"heap","order":4,"top":"","right":"","bottom":"270px","left":"60px","marginLeft":"","width":"500px","showActionsPanel":1,"showStatusPanel":0,"showCodetracePanel":1,"created_at":"2021-12-16 09:44:16","updated_at":"2021-12-16 09:45:32","section":226,"code":"$(\"#delete\").click().addClass(\"menu-highlighted\");","section_order":9,"value":"9-4","text":"<p>We still can, at the expense of more complex solution. We can use an additional separate Hash Table to map any value to its index in the Binary (Max) Heap. This way, the \"search\" can be done via O(<b>1<\/b>) hashing instead.<\/p>","title":"The Answer"},{"id":227,"category":"heap","order":5,"top":"70px","right":"","bottom":"","left":"60px","marginLeft":"","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-04-25 01:04:28","updated_at":"2023-06-05 14:10:24","section":226,"code":"","section_order":9,"value":"9-5","text":"<p>If you are looking for an implementation of Binary (Max) Heap to actually model a Priority Queue, then there is a good news.<\/p><br><p>C++ and Java already have built-in Priority Queue implementations that very likely use this data structure. They are <a href=\"http:\/\/en.cppreference.com\/w\/cpp\/container\/priority_queue\" target=\"_blank\"><u>C++ STL priority_queue<\/u><\/a> (the default is a Max Priority Queue) and <a href=\"https:\/\/docs.oracle.com\/javase\/8\/docs\/api\/java\/util\/PriorityQueue.html\" target=\"_blank\"><u>Java PriorityQueue<\/u><\/a> (the default is a Min Priority Queue). However, the built-in implementation may not be suitable to do some PQ extended operations efficiently (details omitted for pedagogical reason in a certain NUS course).<\/p><br><p>Python <a href=\"https:\/\/docs.python.org\/3\/library\/heapq.html\" target=\"_blank\">heapq<\/a> exists but its performance is rather slow. OCaml doesn&#39;t have built-in Priority Queue but we can use something else that is going to be mentioned in the other modules in VisuAlgo (the reason on why the details are omitted is the same as above).<\/p><br><p>PS: Heap Sort is likely used in C++ STL algorithm <a href=\"http:\/\/en.cppreference.com\/w\/cpp\/algorithm\/partial_sort\" target=\"_blank\"><u>partial_sort<\/u><\/a>.<\/p><hr><p>Nevertheless, here is our implementation of <a href=\"http:\/\/www.comp.nus.edu.sg\/~stevenha\/cs2040c\/demos\/BinaryHeapDemo.cpp\" target=\"_blank\"><u>BinaryHeapDemo.cpp<\/u><\/a> | <a href=\"http:\/\/www.comp.nus.edu.sg\/~stevenha\/cs2040c\/demos\/BinaryHeapDemo.py\" target=\"_blank\"><u>py<\/u><\/a> | <a href=\"http:\/\/www.comp.nus.edu.sg\/~stevenha\/cs2040c\/demos\/BinaryHeapDemo.java\" target=\"_blank\"><u>java<\/u><\/a>.<\/p>","title":"Source Code"},{"id":228,"category":"heap","order":6,"top":"70px","right":"","bottom":"","left":"60px","marginLeft":"","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-04-25 01:09:46","updated_at":"2023-06-05 14:08:56","section":226,"code":"","section_order":9,"value":"9-6","text":"<p>For a few more interesting questions about this data structure, please practice on <a href=\"https:\/\/visualgo.net\/training?diff=Medium&amp;n=7&amp;tl=0&amp;module=heap\"><u>Binary Heap<\/u><\/a> training module (no login is required).<\/p><br><p>However, for NUS students, you should login using your official class account, officially clear this module, and such achievement will be recorded in your user account.<\/p>","title":"Online Quiz"},{"id":229,"category":"heap","order":7,"top":"70px","right":"","bottom":"","left":"60px","marginLeft":"","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-04-25 01:12:26","updated_at":"2023-06-05 14:08:58","section":226,"code":"","section_order":9,"value":"9-7","text":"<p>We also have a few programming problems that somewhat requires the usage of this Binary Heap data structure: <a href=\"https:\/\/uva.onlinejudge.org\/external\/12\/1203.pdf\" title=\"\" target=\"_blank\"><u>UVa 01203 - Argus<\/u><\/a> and <a href=\"https:\/\/open.kattis.com\/problems\/numbertree\" title=\"\" target=\"_blank\"><u>Kattis - numbertree<\/u><\/a>.<\/p><br><p>Try them to consolidate and improve your understanding about this data structure. You are allowed to use C++ STL priority_queue, Python heapq, or Java PriorityQueue if that simplifies your implementation.<\/p>","title":"Online Judge Exercises"},{"id":239,"category":"heap","order":8,"top":"70px","right":"","bottom":"","left":"60px","marginLeft":"","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":1,"created_at":"2017-04-25 13:32:56","updated_at":"2023-06-05 14:09:04","section":226,"code":"","section_order":9,"value":"9-8","text":"<p>For <a href=\"https:\/\/uva.onlinejudge.org\/external\/12\/1203.pdf\" title=\"\" target=\"_blank\"><u>UVa 01203 - Argus<\/u><\/a>, consider using PQ ADT to simulate the process in O(<b>K<\/b> log <b>#Register<\/b>) time.<p><br><p>For <a href=\"https:\/\/open.kattis.com\/problems\/numbertree\" title=\"\" target=\"_blank\"><u>Kattis - numbertree<\/u><\/a>, stare at <a href=\".\/heap?slide=2-1\"><u>this slide<\/u><\/a> very carefully.<\/p>","title":"Discussion"},{"id":405,"category":"heap","order":9,"top":"70px","right":"","bottom":"","left":"60px","marginLeft":"","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":0,"created_at":"2017-05-18 04:23:16","updated_at":"2023-06-05 14:09:06","section":226,"code":"","section_order":9,"value":"9-9","text":"<p>After spending one long lecture on Binary (Max) Heap, here is a jaw-dropping moment...<\/p><br><p>Binary (Max) Heap data structure is probably <b>not<\/b> the best data structure to implement (certain operations of) ADT Priority Queue...<\/p><br><p>Discussion: So what is the alternative data structure?<\/p>","title":"Shocking Stuff"},{"id":406,"category":"heap","order":10,"top":"70px","right":"","bottom":"","left":"60px","marginLeft":"","width":"500px","showActionsPanel":0,"showStatusPanel":0,"showCodetracePanel":1,"created_at":"2017-05-18 04:26:21","updated_at":"2023-06-05 14:09:09","section":226,"code":"","section_order":9,"value":"9-10","text":"<p>The main motivation of this lecture is that we need a data structure to implement Priority Queue ADT efficiently.<\/p><br><p>Now we tell you that there is an <a href=\".\/avl\"><u>alternative (click this link)<\/u><\/a> data structure that can also be used to implement Priority Queue ADT and that data structure is actually more versatile...<\/p><br><p>Think about it, what if we need fast, i.e., in O(log <b>N<\/b>) for all these: the standard <b>Insert(v)<\/b> operation, both the <b>ExtractMax()<\/b> + <b>ExtractMin()<\/b> operations, the <b>UpdateKey(oldv, newv)<\/b> operation, and\/or the <b>Delete(oldv)<\/b> operation &mdash; with just one single data structure?<\/p><br><p>Study that alternative data structure and think how that alternative data structure can support all those operations all in O(log <b>N<\/b>) easily.<\/p>","title":"The Answer"}];
      const numSlides = lectureIds.length;
      var sectorJunction12Section = 0, sectorJunction12Slide = 0;
      var sectorJunction23Section = 0, sectorJunction23Slide = 0;
      var sector1Count = 0, sector2Count = 0, sector3Count = 0;
      const sectorLength = Math.floor(numSlides / 3);
      function createELectureTimelineDisplay() {
        for (let j = 0; j < numSlides; ++j) {
          const currLecture = lectureIds[j].value;
          if (currLecture.includes('-')) {
            $('#e-lecture-timeline').append(
              $(`<div class="e-lecture-timeline-slide" slideNo=${lectureIds[j].value}></div>`)
            );
          } else {
            $('#e-lecture-timeline').append(
              $(`<div class="e-lecture-timeline-checkpoint" slideNo=${lectureIds[j].value}></div>`)
            );
          }
        }
      }

      function setSectorJunctionInfo() {
          //setting the sector junction slide numbers
          const j12 = sectorLength !== 0 ? (sectorLength - 1): 0;
          const j23 = sectorLength !== 0 ? (2 * sectorLength - 1) : 0;

          const sectorJunction12 = lectureIds[j12].value.split('-');
          sectorJunction12Section = parseInt(sectorJunction12[0]);
          sectorJunction12Slide = sectorJunction12.length > 1 ? parseInt(sectorJunction12[1]) : sectorJunction12Slide;

          const sectorJunction23 = lectureIds[j23].value.split('-');
          sectorJunction23Section = parseInt(sectorJunction23[0]);
          sectorJunction23Slide = sectorJunction23.length > 1 ? parseInt(sectorJunction23[1]) : sectorJunction23Slide;
      }

      function runSlide(slide) { // Steven's patch on 28 Jan 2022: Properly remove slide 99, 99-1, 99-2, 99-3, integrate with the earlier slides
        if (slide == '1') {
          $("#e-lecture").html("slide " + slide + " (" + 2 + "%)");
          
        }
        if (slide == '1-1') {
          $("#e-lecture").html("slide " + slide + " (" + 4 + "%)");
          
        }
        if (slide == '1-2') {
          $("#e-lecture").html("slide " + slide + " (" + 6 + "%)");
          
        }
        if (slide == '1-3') {
          $("#e-lecture").html("slide " + slide + " (" + 8 + "%)");
          
        }
        if (slide == '1-4') {
          $("#e-lecture").html("slide " + slide + " (" + 10 + "%)");
          
        }
        if (slide == '1-5') {
          $("#e-lecture").html("slide " + slide + " (" + 12 + "%)");
          
        }
        if (slide == '1-6') {
          $("#e-lecture").html("slide " + slide + " (" + 14 + "%)");
          
        }
        if (slide == '1-7') {
          $("#e-lecture").html("slide " + slide + " (" + 16 + "%)");
          
        }
        if (slide == '1-8') {
          $("#e-lecture").html("slide " + slide + " (" + 18 + "%)");
          
        }
        if (slide == '1-9') {
          $("#e-lecture").html("slide " + slide + " (" + 20 + "%)");
          
        }
        if (slide == '1-10') {
          $("#e-lecture").html("slide " + slide + " (" + 22 + "%)");
          
        }
        if (slide == '1-11') {
          $("#e-lecture").html("slide " + slide + " (" + 24 + "%)");
          
        }
        if (slide == '2') {
          $("#e-lecture").html("slide " + slide + " (" + 26 + "%)");
          
        }
        if (slide == '2-1') {
          $("#e-lecture").html("slide " + slide + " (" + 28 + "%)");
          hw.restoreArray([999999,71,62,53,44,35,26,17]);
        }
        if (slide == '2-2') {
          $("#e-lecture").html("slide " + slide + " (" + 30 + "%)");
          hw.createRandomMaxHeap();
        }
        if (slide == '3') {
          $("#e-lecture").html("slide " + slide + " (" + 32 + "%)");
          
        }
        if (slide == '3-1') {
          $("#e-lecture").html("slide " + slide + " (" + 34 + "%)");
          
        }
        if (slide == '4') {
          $("#e-lecture").html("slide " + slide + " (" + 36 + "%)");
          $("#insert").click().addClass("menu-highlighted");
        }
        if (slide == '4-1') {
          $("#e-lecture").html("slide " + slide + " (" + 38 + "%)");
          $("#insert").click().addClass("menu-highlighted");
        }
        if (slide == '4-2') {
          $("#e-lecture").html("slide " + slide + " (" + 40 + "%)");
          $("#insert").click().addClass("menu-highlighted");
        }
        if (slide == '4-3') {
          $("#e-lecture").html("slide " + slide + " (" + 42 + "%)");
          $("#insert").click().addClass("menu-highlighted");
        }
        if (slide == '4-4') {
          $("#e-lecture").html("slide " + slide + " (" + 44 + "%)");
          $("#insert").click().addClass("menu-highlighted");
        }
        if (slide == '5') {
          $("#e-lecture").html("slide " + slide + " (" + 46 + "%)");
          $("#extractMax").click().addClass("menu-highlighted");
$("#extractMax-once").addClass("menu-highlighted");
        }
        if (slide == '5-1') {
          $("#e-lecture").html("slide " + slide + " (" + 48 + "%)");
          $("#extractMax").click().addClass("menu-highlighted");
$("#extractMax-once").addClass("menu-highlighted");
        }
        if (slide == '5-2') {
          $("#e-lecture").html("slide " + slide + " (" + 51 + "%)");
          $("#extractMax").click().addClass("menu-highlighted");
$("#extractMax-once").addClass("menu-highlighted");
        }
        if (slide == '5-3') {
          $("#e-lecture").html("slide " + slide + " (" + 53 + "%)");
          $("#extractMax").click().addClass("menu-highlighted");
$("#extractMax-once").addClass("menu-highlighted");
        }
        if (slide == '5-4') {
          $("#e-lecture").html("slide " + slide + " (" + 55 + "%)");
          $("#extractMax").click().addClass("menu-highlighted");
$("#extractMax-once").addClass("menu-highlighted");
        }
        if (slide == '6') {
          $("#e-lecture").html("slide " + slide + " (" + 57 + "%)");
          $("#insert").addClass("menu-highlighted");
$("#extractMax").click().addClass("menu-highlighted");
$("#extractMax-once").addClass("menu-highlighted");
        }
        if (slide == '7') {
          $("#e-lecture").html("slide " + slide + " (" + 59 + "%)");
          $("#createNlogN").addClass("menu-highlighted");
$("#createN").addClass("menu-highlighted");
        }
        if (slide == '7-1') {
          $("#e-lecture").html("slide " + slide + " (" + 61 + "%)");
          $("#createNlogN").click().addClass("menu-highlighted");
        }
        if (slide == '7-2') {
          $("#e-lecture").html("slide " + slide + " (" + 63 + "%)");
          $("#createN").click().addClass("menu-highlighted");
        }
        if (slide == '7-3') {
          $("#e-lecture").html("slide " + slide + " (" + 65 + "%)");
          $("#createN").click().addClass("menu-highlighted");
        }
        if (slide == '7-4') {
          $("#e-lecture").html("slide " + slide + " (" + 67 + "%)");
          $("#createN").click().addClass("menu-highlighted");
hw.restoreArray([999999,71,62,53,44,35,26,17]);
        }
        if (slide == '7-5') {
          $("#e-lecture").html("slide " + slide + " (" + 69 + "%)");
          $("#createN").click().addClass("menu-highlighted");
hw.restoreArray([999999,71,62,53,44,35,26,17]);
        }
        if (slide == '8') {
          $("#e-lecture").html("slide " + slide + " (" + 71 + "%)");
          $("#extractMax").click().addClass("menu-highlighted");
$("#extractMax-heapsort").addClass("menu-highlighted");
        }
        if (slide == '8-1') {
          $("#e-lecture").html("slide " + slide + " (" + 73 + "%)");
          $("#extractMax").click().addClass("menu-highlighted");
$("#extractMax-heapsort").addClass("menu-highlighted");
        }
        if (slide == '8-2') {
          $("#e-lecture").html("slide " + slide + " (" + 75 + "%)");
          $("#extractMax").click().addClass("menu-highlighted");
$("#extractMax-heapsort").addClass("menu-highlighted");
        }
        if (slide == '8-3') {
          $("#e-lecture").html("slide " + slide + " (" + 77 + "%)");
          $("#extractMax").click().addClass("menu-highlighted");
$("#extractMax-ktimes").addClass("menu-highlighted");
        }
        if (slide == '9') {
          $("#e-lecture").html("slide " + slide + " (" + 79 + "%)");
          
        }
        if (slide == '9-1') {
          $("#e-lecture").html("slide " + slide + " (" + 81 + "%)");
          hw.restoreArray([999999,-1,-3,-2,-7,-19,-17,-26,-90,-25,-36]);
        }
        if (slide == '9-2') {
          $("#e-lecture").html("slide " + slide + " (" + 83 + "%)");
          $("#updateKey").click().addClass("menu-highlighted");
        }
        if (slide == '9-3') {
          $("#e-lecture").html("slide " + slide + " (" + 85 + "%)");
          $("#delete").click().addClass("menu-highlighted");
        }
        if (slide == '9-4') {
          $("#e-lecture").html("slide " + slide + " (" + 87 + "%)");
          $("#delete").click().addClass("menu-highlighted");
        }
        if (slide == '9-5') {
          $("#e-lecture").html("slide " + slide + " (" + 89 + "%)");
          
        }
        if (slide == '9-6') {
          $("#e-lecture").html("slide " + slide + " (" + 91 + "%)");
          
        }
        if (slide == '9-7') {
          $("#e-lecture").html("slide " + slide + " (" + 93 + "%)");
          
        }
        if (slide == '9-8') {
          $("#e-lecture").html("slide " + slide + " (" + 95 + "%)");
          
        }
        if (slide == '9-9') {
          $("#e-lecture").html("slide " + slide + " (" + 97 + "%)");
          
        }
        if (slide == '9-10') {
          $("#e-lecture").html("slide " + slide + " (" + 100 + "%)");
          
        }
        clearTimeout(currSlideTimer);
      }

      window.onpopstate = function(event) {
        var slide = event.state['slide'];
        openSlide(slide, function() {
          runSlide(slide);
        });
      };

      function getUrlParameter(sParam) {
        var sPageURL = decodeURIComponent(window.location.search.substring(1)),
        sURLVariables = sPageURL.split('&'), sParameterName, i;

        for (i = 0; i < sURLVariables.length; i++) {
          sParameterName = sURLVariables[i].split('=');
          if (sParameterName[0] === sParam) return sParameterName[1] === undefined ? true : sParameterName[1];
        }
      };
      var slideTimeline = {};

      //reads all visited slides in the slideTimeline and gives them their sector color
      function setVisitedSlideTimelineColors() {
        for(const [sectionNo, visitedSlides] of Object.entries(slideTimeline)) {
          const visitedSlides = slideTimeline[sectionNo];
          for(const visitedSlideNo of visitedSlides) {
            setSlideTimelineColor(visitedSlideNo);
          }
        }
      }

      //only called on load if there is nothing in session
      function setTimelineForCompletedSector(sectorNum) {
        let len = sectorLength;
        switch (sectorNum) {
          case 1 : len = sectorLength; break;
          case 2 : len = 2 * sectorLength; break;
          default: len = numSlides;
        }
        let i = 0;
        switch (sectorNum) {
          case 1 : i = 0; break;
          case 2 : i = sectorLength; break;
          default: i = 2 * sectorLength;
        }
        for (; i < len; i++) {
          saveELectureTimeline(lectureIds[i].value, true);
        }
      }

      function getUserSectorHistory(callback) {
        $.ajax({
          type: 'GET',
          url: "https://visualgo.net/section-info",
          data: {
            _token: "dOvHLDgQSeBxDYich7PEZml1cYPqAYZaOAN2Xn3H",
            topic: "/heap".substring(1)
          }
        }
        ).done(function (data) {
            if (data.data[0] === 1) {
              setF1SectorColor(1);
              setTimelineForCompletedSector(1);
            }
            if (data.data[1] === 1) {
              setF1SectorColor(2);
              setTimelineForCompletedSector(2);
            }
            if (data.data[2] === 1) {
              setF1SectorColor(3);
              setTimelineForCompletedSector(3);
            }
            callback();
        }).fail(function (data) {
            console.log('get user sector history failed!');
        });
      }

      function getELectureTimelineFromSession() {
        const page = "/heap".substring(1);
        const timelineKey = page + '-slide-timeline';
        const storedTimeline = window.sessionStorage.getItem(timelineKey);
        if (storedTimeline) {
          slideTimeline = JSON.parse(storedTimeline);
        } else {
          return false;
        }
        let slideInfo = [];
        for (const [sectionNum, slides] of Object.entries(slideTimeline)) {
          for (const slide of slides) {
            indicateSlideCompletedUI(slide);
            slideInfo = slide.split('-');
            incrementSectorVisits(parseInt(sectionNum), slideInfo.length > 1 ? parseInt(slideInfo[1]) : 0);
          }
        }
        return true;
      }

      async function initializeELectureTimeline() {
        setSectorJunctionInfo();
        if (!getELectureTimelineFromSession())
          getUserSectorHistory(sectorBasedModeSelection);
        else
          sectorBasedModeSelection();

        createELectureTimelineDisplay();
        setVisitedSlideTimelineColors();
      }

      function setF1SectorColor(sectorNum) {
        $(`[sectorNo="${sectorNum}"]`).css('background', sectorColors[(parseInt(sectorNum) % 3)]);
      }

      function updateSectorInDB(sectorNum) {
        $.ajax({
          type: 'POST',
          url: "https://visualgo.net/section-info",
          data: {
            _token: "dOvHLDgQSeBxDYich7PEZml1cYPqAYZaOAN2Xn3H",
            section: (sectorNum - 1),
            topic: "/heap".substring(1)
          }
        }
        ).done(function (data) {
            //console.log("Saved the sector " + sectorNum + " as done " + JSON.stringify(data));
        }).fail(function (data) {
            console.log("Setting sector done failed new attempt! "+ JSON.stringify(data));
        });
      }

      //If 87.5% or more of the slides in sector are done
      function setF1SectorCompleted(sectorNum, isInitializationCall) {
        setF1SectorColor(sectorNum);
        //avoid api call on initialization
        if (!isInitializationCall) {
          updateSectorInDB(sectorNum);
          $(`[sectorNo="${sectorNum}"]`).css("animation", "green-pulse 2s 4");
          setTimeout(() => {
            $(`[sectorNo="${sectorNum}"]`).css("animation", "");
          }, 8000);
        }
      }

      function incrementSectorVisits(sectionNum, slideNumWithinSection, isInitializationCall) {
        //updating sector count
        if (sectionNum < sectorJunction12Section
          || (sectionNum === sectorJunction12Section && slideNumWithinSection <= sectorJunction12Slide)) {
          ++sector1Count;
          if (sector1Count >= Math.ceil(0.875 * sectorLength))
            setF1SectorCompleted(1, isInitializationCall);
        } else if (sectionNum < sectorJunction23Section
          || (sectionNum === sectorJunction23Section && slideNumWithinSection <= sectorJunction23Slide)) {
          ++sector2Count;
          if (sector2Count >= Math.ceil(0.875 * sectorLength))
            setF1SectorCompleted(2, isInitializationCall);
        } else {
          ++sector3Count;
          if (sector3Count >= Math.ceil(0.875 * (numSlides - 2 * sectorLength)))
            setF1SectorCompleted(3, isInitializationCall);
        }
      }

      function saveELectureTimeline(slideNo, isInitialization) {
        const slideInfo = slideNo.split('-');
        const sectionNo = slideInfo[0];
        const slideNumWithinSection = slideInfo.length > 1 ? parseInt(slideInfo[1]) : 0;
        if (slideTimeline[sectionNo]) {
          if (!slideTimeline[sectionNo].includes(slideNo)) {
            slideTimeline[sectionNo].push(slideNo);
            const sectionNum = parseInt(sectionNo);
            incrementSectorVisits(sectionNum, slideNumWithinSection, isInitialization);
          }
        } else {
          slideTimeline[sectionNo] = [];
          slideTimeline[sectionNo].push(slideNo);
          const sectionNum = parseInt(sectionNo);
          incrementSectorVisits(sectionNum, slideNumWithinSection, isInitialization);
        }
        setSlideTimelineColor(slideNo);
        indicateSlideCompletedUI(slideNo);
      }

      function saveELectureTimelineToSession() {
        const page = "/heap".substring(1);
        const timelineKey = page + '-slide-timeline';
        window.sessionStorage.setItem(timelineKey, JSON.stringify(slideTimeline));
      }

      function handleTimelineOnRunSlide(slideValue) {
        const slideInfo = slideValue.split('-');
        const sectionNo = slideInfo[0];
        const slideNumWithinSection = slideInfo.length > 1 ? parseInt(slideInfo[1]) : 0;
        //start timer only if the slide isnt already done
        if (!slideTimeline[sectionNo] || !slideTimeline[sectionNo].includes(slideValue)) {
          const slideTextLength = $('#electure-'+slideValue + " p").text().length + $('#electure-'+slideValue + " li").text().length;
          const CHARS_READ_PER_MS = 0.05; //when fast, 50 characters a second
          //setting max reading time as 10 seconds for around 500 character slide
          const minSlideReadingTime = Math.min(Math.max(2000, (slideTextLength / CHARS_READ_PER_MS) +  + (2000 * $('#electure-'+slideValue + " img").length)), 10000);
          currSlideTimer = setTimeout(() => {
            saveELectureTimeline(slideValue);
          }, minSlideReadingTime);
        }
      }

      function indicateSlideCompletedUI(slide) {
        $('#electure-'+slide).css("box-shadow", "3px 3px 8px green"); //set green shadow for completed slides
        $('#electure-'+slide + ' .electure-read-status').html("&#10004;");
        $('#electure-'+slide + ' .electure-read-status').attr("title", "Slide Completed!");
        $('#electure-'+slide + ' .electure-read-status').css("font-size", "17px");
      }

      function pushState(slideValue) {
        var url = '/en/heap';
        if (typeof slideValue != 'undefined' && slideValue != null) {
          url += '?slide=' + slideValue;
                  }
        window.history.pushState({slide: slideValue}, "slide " + slideValue, url);
      }

      function showPopup(callback) {
        $('#popup').fadeIn(100, callback);
      }

      function hidePopup(callback) {
        $('#popup').fadeOut(100, callback);
      }

      function showOverlay() {
        $('#overlay').css('opacity', 0.5);
        $('#overlay').show();

        $("#e-lecture-timeline").show();
        $("#e-lecture-f1map").show();
      }

      function hideOverlay() {
        $('#overlay').hide();
        $("#e-lecture").html("");
        $("#e-lecture-timeline").hide();
        $("#e-lecture-f1map").hide();
        clearTimeout(currSlideTimer);
      }

      function makeOverlayTransparent() {
        $('#overlay').css('opacity', 0);
      }

      function hideSlide(callback) {
        isPlaying = true;
        closeSlide(cur_slide, function() {
          makeOverlayTransparent();
          setTimeout(callback, 700); // don't immediately run the animation, wait for 500ms+ first
        });
      }

      function showSlide() {
        isPlaying = false;
        openSlide(cur_slide);
        showOverlay();
      }

      function sectorBasedModeSelection() {
        const urlSearchParams = new URLSearchParams(window.location.search);
        const params = Object.fromEntries(urlSearchParams.entries());
        //check params are empty and then that all sectors are completed or not
        if (!Object.keys(params).length
          && sector1Count === sectorLength && sector2Count === sectorLength && sector3Count === (numSlides - 2 * sectorLength)) {
            hideOverlay();
        }
        else
          $('#mode-menu a').click();
      }

      $(function() {
        if (isMobileOS() && portraitMatcher.matches) {
          $('#rotateDeviceOverlay').show();
          $('#rotateDeviceText').show();
          $('#widenDeviceText').hide();
          $('#topbar').css("z-index", 10001);
        } else if (matchMediaNarrow.matches) {
          $('#rotateDeviceOverlay').show();
          $('#rotateDeviceText').hide();
          $('#widenDeviceText').show();
          $('#topbar').css("z-index", 10001);
        } else {
          $('#rotateDeviceOverlay').hide();
          $('#topbar').css("z-index", "");
        }

        matchMediaNarrow.addEventListener('change', e => {
          //screws up for square device! NEED RESIZE EVENT
          if (e.matches) {
            if ($('#rotateDeviceOverlay').is(":hidden")) {
              $('#rotateDeviceOverlay').show();
              $('#rotateDeviceText').hide();
              $('#widenDeviceText').show();
              $('#topbar').css("z-index", 10001);
            }
          } else {
            $('#rotateDeviceOverlay').hide();
            $('#topbar').css("z-index", "");
          }
        });
        portraitMatcher.addEventListener('change', e => {
          if (e.matches && isMobileOS()) {
            if ($('#rotateDeviceOverlay').is(":hidden")) {
              $('#rotateDeviceOverlay').show();
              $('#rotateDeviceText').show();
              $('#widenDeviceText').hide();
              $('#topbar').css("z-index", 10001);
            }
          } else {
            $('#rotateDeviceOverlay').hide();
            $('#topbar').css("z-index", "");
          }
        });
        const urlSearchParams = new URLSearchParams(window.location.search);
        const params = Object.fromEntries(urlSearchParams.entries());
        let slide = getUrlParameter('slide');
        if (typeof slide !== undefined && slide != null) {
          cur_slide = slide;
        }
        //do all timeline and slide stuff only if specific params not provided
        if (!Object.keys(params).length || params["slide"]) {
          if (!isMobile()) {
                            $('#mode-menu a').click();
                      }
        }
        $('.mcq-submit').click(function() {
          var questionId = parseInt($(this).attr('id').split('-')[1]);
          var answer = $('#mcq-answer-' + questionId).val();
          var userAnswer = $('input[type=radio][name=mcq-'+questionId+'-choice]:checked').val();

          if (answer === userAnswer) {
            $('#answer-status-' + questionId).html('<font color="green"><b>Correct!</b></font>');
          }
          else {
            $('#answer-status-' + questionId).html('<font color="red"><b>Wrong Answer! Try again...</b></font>');
          }
          $('#answer-status-' + questionId).show();
          setTimeout(function() {
            $('#answer-status-' + questionId).fadeOut(1000);
          }, 1000);
        });

        $('.msq-submit').click(function() {
          var questionId = parseInt($(this).attr('id').split('-')[1]);
          var answer = $('#msq-answer-' + questionId).val();

          var answers = [];
          $('input[type=checkbox][class=msq-choice]:checked').each(function() {
            answers.push($(this).attr('id').split('-')[3]);
          });
          answers.sort();
          var userAnswer = answers.join(',');

          if (answer === userAnswer) {
            $('#answer-status-' + questionId).html('<font color="green">Correct!</font>');
          }
          else {
            $('#answer-status-' + questionId).html('<font color="red">Wrong Answer! Try again...</font>');
          }
          $('#answer-status-' + questionId).show();
          setTimeout(function() {
            $('#answer-status-' + questionId).fadeOut(1000);
          }, 1000);
        });

        $('select.lecture-dropdown').change(function() {
          var nextSlide = $(this).val();
          openSlide(nextSlide, function() {
            runSlide(nextSlide);
            pushState(nextSlide);
          });
        });

        $('#hide-popup').click(function() {
          hidePopup();
        });

        $('#popup').hover(function() {
          $('#hide-popup').show();
        }, function() {
          $('#hide-popup').hide();
        });

        $('#electure-1 .electure-next').click(function() {
          hidePopup();
          runSlide('1-1');
          pushState('1-1');
        });
        $('#electure-1-1 .electure-next').click(function() {
          hidePopup();
          runSlide('1-2');
          pushState('1-2');
        });
        $('#electure-1-1 .electure-prev').click(function() {
          hidePopup();
          runSlide('1');
          pushState('1');
        });
        $('#electure-1-2 .electure-next').click(function() {
          hidePopup();
          runSlide('1-3');
          pushState('1-3');
        });
        $('#electure-1-2 .electure-prev').click(function() {
          hidePopup();
          runSlide('1-1');
          pushState('1-1');
        });
        $('#electure-1-3 .electure-next').click(function() {
          hidePopup();
          runSlide('1-4');
          pushState('1-4');
        });
        $('#electure-1-3 .electure-prev').click(function() {
          hidePopup();
          runSlide('1-2');
          pushState('1-2');
        });
        $('#electure-1-4 .electure-next').click(function() {
          hidePopup();
          runSlide('1-5');
          pushState('1-5');
        });
        $('#electure-1-4 .electure-prev').click(function() {
          hidePopup();
          runSlide('1-3');
          pushState('1-3');
        });
        $('#electure-1-5 .electure-next').click(function() {
          hidePopup();
          runSlide('1-6');
          pushState('1-6');
        });
        $('#electure-1-5 .electure-prev').click(function() {
          hidePopup();
          runSlide('1-4');
          pushState('1-4');
        });
        $('#electure-1-6 .electure-next').click(function() {
          hidePopup();
          runSlide('1-7');
          pushState('1-7');
        });
        $('#electure-1-6 .electure-prev').click(function() {
          hidePopup();
          runSlide('1-5');
          pushState('1-5');
        });
        $('#electure-1-7 .electure-next').click(function() {
          hidePopup();
          runSlide('1-8');
          pushState('1-8');
        });
        $('#electure-1-7 .electure-prev').click(function() {
          hidePopup();
          runSlide('1-6');
          pushState('1-6');
        });
        $('#electure-1-8 .electure-next').click(function() {
          hidePopup();
          runSlide('1-9');
          pushState('1-9');
        });
        $('#electure-1-8 .electure-prev').click(function() {
          hidePopup();
          runSlide('1-7');
          pushState('1-7');
        });
        $('#electure-1-9 .electure-next').click(function() {
          hidePopup();
          runSlide('1-10');
          pushState('1-10');
        });
        $('#electure-1-9 .electure-prev').click(function() {
          hidePopup();
          runSlide('1-8');
          pushState('1-8');
        });
        $('#electure-1-10 .electure-next').click(function() {
          hidePopup();
          runSlide('1-11');
          pushState('1-11');
        });
        $('#electure-1-10 .electure-prev').click(function() {
          hidePopup();
          runSlide('1-9');
          pushState('1-9');
        });
        $('#electure-1-11 .electure-next').click(function() {
          hidePopup();
          runSlide('2');
          pushState('2');
        });
        $('#electure-1-11 .electure-prev').click(function() {
          hidePopup();
          runSlide('1-10');
          pushState('1-10');
        });
        $('#electure-2 .electure-next').click(function() {
          hidePopup();
          runSlide('2-1');
          pushState('2-1');
        });
        $('#electure-2 .electure-prev').click(function() {
          hidePopup();
          runSlide('1-11');
          pushState('1-11');
        });
        $('#electure-2-1 .electure-next').click(function() {
          hidePopup();
          runSlide('2-2');
          pushState('2-2');
        });
        $('#electure-2-1 .electure-prev').click(function() {
          hidePopup();
          runSlide('2');
          pushState('2');
        });
        $('#electure-2-2 .electure-next').click(function() {
          hidePopup();
          runSlide('3');
          pushState('3');
        });
        $('#electure-2-2 .electure-prev').click(function() {
          hidePopup();
          runSlide('2-1');
          pushState('2-1');
        });
        $('#electure-3 .electure-next').click(function() {
          hidePopup();
          runSlide('3-1');
          pushState('3-1');
        });
        $('#electure-3 .electure-prev').click(function() {
          hidePopup();
          runSlide('2-2');
          pushState('2-2');
        });
        $('#electure-3-1 .electure-next').click(function() {
          hidePopup();
          runSlide('4');
          pushState('4');
        });
        $('#electure-3-1 .electure-prev').click(function() {
          hidePopup();
          runSlide('3');
          pushState('3');
        });
        $('#electure-4 .electure-next').click(function() {
          hidePopup();
          runSlide('4-1');
          pushState('4-1');
        });
        $('#electure-4 .electure-prev').click(function() {
          hidePopup();
          runSlide('3-1');
          pushState('3-1');
        });
        $('#electure-4-1 .electure-next').click(function() {
          hidePopup();
          runSlide('4-2');
          pushState('4-2');
        });
        $('#electure-4-1 .electure-prev').click(function() {
          hidePopup();
          runSlide('4');
          pushState('4');
        });
        $('#electure-4-2 .electure-next').click(function() {
          hidePopup();
          runSlide('4-3');
          pushState('4-3');
        });
        $('#electure-4-2 .electure-prev').click(function() {
          hidePopup();
          runSlide('4-1');
          pushState('4-1');
        });
        $('#electure-4-3 .electure-next').click(function() {
          hidePopup();
          runSlide('4-4');
          pushState('4-4');
        });
        $('#electure-4-3 .electure-prev').click(function() {
          hidePopup();
          runSlide('4-2');
          pushState('4-2');
        });
        $('#electure-4-4 .electure-next').click(function() {
          hidePopup();
          runSlide('5');
          pushState('5');
        });
        $('#electure-4-4 .electure-prev').click(function() {
          hidePopup();
          runSlide('4-3');
          pushState('4-3');
        });
        $('#electure-5 .electure-next').click(function() {
          hidePopup();
          runSlide('5-1');
          pushState('5-1');
        });
        $('#electure-5 .electure-prev').click(function() {
          hidePopup();
          runSlide('4-4');
          pushState('4-4');
        });
        $('#electure-5-1 .electure-next').click(function() {
          hidePopup();
          runSlide('5-2');
          pushState('5-2');
        });
        $('#electure-5-1 .electure-prev').click(function() {
          hidePopup();
          runSlide('5');
          pushState('5');
        });
        $('#electure-5-2 .electure-next').click(function() {
          hidePopup();
          runSlide('5-3');
          pushState('5-3');
        });
        $('#electure-5-2 .electure-prev').click(function() {
          hidePopup();
          runSlide('5-1');
          pushState('5-1');
        });
        $('#electure-5-3 .electure-next').click(function() {
          hidePopup();
          runSlide('5-4');
          pushState('5-4');
        });
        $('#electure-5-3 .electure-prev').click(function() {
          hidePopup();
          runSlide('5-2');
          pushState('5-2');
        });
        $('#electure-5-4 .electure-next').click(function() {
          hidePopup();
          runSlide('6');
          pushState('6');
        });
        $('#electure-5-4 .electure-prev').click(function() {
          hidePopup();
          runSlide('5-3');
          pushState('5-3');
        });
        $('#electure-6 .electure-next').click(function() {
          hidePopup();
          runSlide('7');
          pushState('7');
        });
        $('#electure-6 .electure-prev').click(function() {
          hidePopup();
          runSlide('5-4');
          pushState('5-4');
        });
        $('#electure-7 .electure-next').click(function() {
          hidePopup();
          runSlide('7-1');
          pushState('7-1');
        });
        $('#electure-7 .electure-prev').click(function() {
          hidePopup();
          runSlide('6');
          pushState('6');
        });
        $('#electure-7-1 .electure-next').click(function() {
          hidePopup();
          runSlide('7-2');
          pushState('7-2');
        });
        $('#electure-7-1 .electure-prev').click(function() {
          hidePopup();
          runSlide('7');
          pushState('7');
        });
        $('#electure-7-2 .electure-next').click(function() {
          hidePopup();
          runSlide('7-3');
          pushState('7-3');
        });
        $('#electure-7-2 .electure-prev').click(function() {
          hidePopup();
          runSlide('7-1');
          pushState('7-1');
        });
        $('#electure-7-3 .electure-next').click(function() {
          hidePopup();
          runSlide('7-4');
          pushState('7-4');
        });
        $('#electure-7-3 .electure-prev').click(function() {
          hidePopup();
          runSlide('7-2');
          pushState('7-2');
        });
        $('#electure-7-4 .electure-next').click(function() {
          hidePopup();
          runSlide('7-5');
          pushState('7-5');
        });
        $('#electure-7-4 .electure-prev').click(function() {
          hidePopup();
          runSlide('7-3');
          pushState('7-3');
        });
        $('#electure-7-5 .electure-next').click(function() {
          hidePopup();
          runSlide('8');
          pushState('8');
        });
        $('#electure-7-5 .electure-prev').click(function() {
          hidePopup();
          runSlide('7-4');
          pushState('7-4');
        });
        $('#electure-8 .electure-next').click(function() {
          hidePopup();
          runSlide('8-1');
          pushState('8-1');
        });
        $('#electure-8 .electure-prev').click(function() {
          hidePopup();
          runSlide('7-5');
          pushState('7-5');
        });
        $('#electure-8-1 .electure-next').click(function() {
          hidePopup();
          runSlide('8-2');
          pushState('8-2');
        });
        $('#electure-8-1 .electure-prev').click(function() {
          hidePopup();
          runSlide('8');
          pushState('8');
        });
        $('#electure-8-2 .electure-next').click(function() {
          hidePopup();
          runSlide('8-3');
          pushState('8-3');
        });
        $('#electure-8-2 .electure-prev').click(function() {
          hidePopup();
          runSlide('8-1');
          pushState('8-1');
        });
        $('#electure-8-3 .electure-next').click(function() {
          hidePopup();
          runSlide('9');
          pushState('9');
        });
        $('#electure-8-3 .electure-prev').click(function() {
          hidePopup();
          runSlide('8-2');
          pushState('8-2');
        });
        $('#electure-9 .electure-next').click(function() {
          hidePopup();
          runSlide('9-1');
          pushState('9-1');
        });
        $('#electure-9 .electure-prev').click(function() {
          hidePopup();
          runSlide('8-3');
          pushState('8-3');
        });
        $('#electure-9-1 .electure-next').click(function() {
          hidePopup();
          runSlide('9-2');
          pushState('9-2');
        });
        $('#electure-9-1 .electure-prev').click(function() {
          hidePopup();
          runSlide('9');
          pushState('9');
        });
        $('#electure-9-2 .electure-next').click(function() {
          hidePopup();
          runSlide('9-3');
          pushState('9-3');
        });
        $('#electure-9-2 .electure-prev').click(function() {
          hidePopup();
          runSlide('9-1');
          pushState('9-1');
        });
        $('#electure-9-3 .electure-next').click(function() {
          hidePopup();
          runSlide('9-4');
          pushState('9-4');
        });
        $('#electure-9-3 .electure-prev').click(function() {
          hidePopup();
          runSlide('9-2');
          pushState('9-2');
        });
        $('#electure-9-4 .electure-next').click(function() {
          hidePopup();
          runSlide('9-5');
          pushState('9-5');
        });
        $('#electure-9-4 .electure-prev').click(function() {
          hidePopup();
          runSlide('9-3');
          pushState('9-3');
        });
        $('#electure-9-5 .electure-next').click(function() {
          hidePopup();
          runSlide('9-6');
          pushState('9-6');
        });
        $('#electure-9-5 .electure-prev').click(function() {
          hidePopup();
          runSlide('9-4');
          pushState('9-4');
        });
        $('#electure-9-6 .electure-next').click(function() {
          hidePopup();
          runSlide('9-7');
          pushState('9-7');
        });
        $('#electure-9-6 .electure-prev').click(function() {
          hidePopup();
          runSlide('9-5');
          pushState('9-5');
        });
        $('#electure-9-7 .electure-next').click(function() {
          hidePopup();
          runSlide('9-8');
          pushState('9-8');
        });
        $('#electure-9-7 .electure-prev').click(function() {
          hidePopup();
          runSlide('9-6');
          pushState('9-6');
        });
        $('#electure-9-8 .electure-next').click(function() {
          hidePopup();
          runSlide('9-9');
          pushState('9-9');
        });
        $('#electure-9-8 .electure-prev').click(function() {
          hidePopup();
          runSlide('9-7');
          pushState('9-7');
        });
        $('#electure-9-9 .electure-next').click(function() {
          hidePopup();
          runSlide('9-10');
          pushState('9-10');
        });
        $('#electure-9-9 .electure-prev').click(function() {
          hidePopup();
          runSlide('9-8');
          pushState('9-8');
        });
        $('#electure-9-10 .electure-prev').click(function() {
          hidePopup();
          runSlide('9-9');
          pushState('9-9');
        });
      });

      function doButtonAction23() {
        CUSTOM_ACTION('createNlogN', "1,2,3,4,5,6,7");
      }
      function doButtonAction24() {
        CUSTOM_ACTION('createN', "1,2,3,4,5,6,7");
      }
      function doButtonAction25() {
        CUSTOM_ACTION('heapsort');
      }
      function doButtonAction26() {
        CUSTOM_ACTION('extractmax');
      }
      function doButtonAction27() {
        CUSTOM_ACTION('random_insert');
      }
      function doButtonAction34() {
        CUSTOM_ACTION('insert_top');
      }
      function doButtonAction130() {
        toggleMode()
      }
      function doButtonAction148() {
        CUSTOM_ACTION('partialsort');
      }

      $('.electure-print').click(() => {
        window.open(`/en/heap/print`);
      });
      function adjustPopupToImageSize() {
        var width = $('#popup-image').prop('width');
        var height = $('#popup-image').prop('height');
        $('#popup').width(width + 20);
        $('#popup').height(height + 20);
        if (width == 0 && height == 0) {
          setTimeout(adjustPopupToImageSize, 200);
        } else {
          showPopup();
        }
      }

      function POPUP_IMAGE(url) {
        $('#popup-content').html('<img id="popup-image" src="' + url + '">');
        adjustPopupToImageSize();
      }

      function URL(url.html) {
        window.open(url, '_blank');
      }

      // Implement these functions in each visualisation
      // This function will be called before entering e-Lecture Mode
      function ENTER_LECTURE_MODE() {}

      // This function will be called before returning to Explore Mode
      function ENTER_EXPLORE_MODE() {}

      // Lecture action functions
      function CUSTOM_ACTION(action, data, mode) {}

      // This function will be called everytime 1.0x is changed to 0.5x or vice versa
      function redraw() {}

      $(document).ready(function () {
        setTimeout(function () {
          $('#change-lang-popup').fadeOut('slow')
        }, 5000)
      })
    </script>
<script type="text/javascript">
    var extraCSS = {"delete":"65px","updateKey":"92px","extractMax":"119px","insert":"146px","createN":"173px","createNlogN":"200px","toggleMode":"227px"};
    var actionsIds = {"toggleMode":{"p":"-> Compact Array Mode","onClick":"toggleMode()"},"createNlogN":{"p":"Create(A) - O(<b>N<\/b> log <b>N<\/b>)"},"createN":{"p":"Create(A) - O(<b>N<\/b>)"},"insert":{"p":"Insert(v)"},"extractMax":{"p":"ExtractMax()"},"updateKey":{"p":"UpdateKey(i, newv)"},"delete":{"p":"Delete(i)"}};
    var isOpens = {};
    var len = 7;
    var keys = ["toggleMode","createNlogN","createN","insert","extractMax","updateKey","delete"]; 
    for (i = 0; i < len; i++) {
        var actionDetails = keys[i];
        isOpens[actionDetails] = false;
    }
    function openAction(id) {
        hideThirdTiers(id);
        $("." + id).css("bottom", extraCSS[id]);
        if (!isOpens[id]) {
            $('.' + id).fadeIn('fast');
            isOpens[id] = true;
        }
    }
    function closeAction(id) {
        hideThirdTiers(id);
        if (isOpens[id]) {
            $('.' + id).fadeOut('fast');
            $('#' + id + '-err').html("");
            isOpens[id] = false;
        }
    }

    function hideEntireActionsPanel() {
        //hideAllThirdTiers();
                    closeAction('toggleMode');
                    closeAction('createNlogN');
                    closeAction('createN');
                    closeAction('insert');
                    closeAction('extractMax');
                    closeAction('updateKey');
                    closeAction('delete');
                hideActionsPanel();
    }

    function hideThirdTiers(tier1Action) {
        if ("parents" in actionsIds[tier1Action]) {
            for (const secondTierAction of actionsIds[tier1Action]["parents"]) {
                $('#' + secondTierAction + '-third-tier').fadeOut('fast');
            }
        }
    }

    function hideAllThirdTiers() {
        for (const tier1Action in actionsIds) {
            hideThirdTiers(tier1Action);
        }
    }

    function toggleChildExtras(tier1, selectedParentTier2) {
        hideThirdTiers(tier1);
        //this actionId must have childExtras
        var style = extraCSS[tier1];
        $("." + tier1).css("bottom", (parseInt(style.substring(0, style.length - 2)) - 27));
        //fade ins and outs are done on the ID whereas css class is set on the class
        //fade in the third tier of the selected 2nd tier parent
        $('#' + selectedParentTier2 + '-third-tier').fadeIn('fast');

        // //fade out all other third tiers of that 'action'
        // for (const parent of actions[tier1]["parents"]) {
        //     console.log("parent is " + parent + " for " + selectedParentTier2);
        //     if (parent != selectedParentTier2) {
        //         $('#' + parent + '-third-tier').fadeOut('fast');
        //     }
        // }
    }

    function setActionHeightOriginal(tier1Action) {
        $("." + tier1Action).css("bottom", extraCSS[tier1Action]);
    }

            $('#' + 'toggleMode').click(function() {
            openAction('toggleMode');
                                                                            closeAction('createNlogN');
                                                                closeAction('createN');
                                                                closeAction('insert');
                                                                closeAction('extractMax');
                                                                closeAction('updateKey');
                                                                closeAction('delete');
                                    });
            $('#' + 'createNlogN').click(function() {
            openAction('createNlogN');
                                                closeAction('toggleMode');
                                                                                            closeAction('createN');
                                                                closeAction('insert');
                                                                closeAction('extractMax');
                                                                closeAction('updateKey');
                                                                closeAction('delete');
                                    });
            $('#' + 'createN').click(function() {
            openAction('createN');
                                                closeAction('toggleMode');
                                                                closeAction('createNlogN');
                                                                                            closeAction('insert');
                                                                closeAction('extractMax');
                                                                closeAction('updateKey');
                                                                closeAction('delete');
                                    });
            $('#' + 'insert').click(function() {
            openAction('insert');
                                                closeAction('toggleMode');
                                                                closeAction('createNlogN');
                                                                closeAction('createN');
                                                                                            closeAction('extractMax');
                                                                closeAction('updateKey');
                                                                closeAction('delete');
                                    });
            $('#' + 'extractMax').click(function() {
            openAction('extractMax');
                                                closeAction('toggleMode');
                                                                closeAction('createNlogN');
                                                                closeAction('createN');
                                                                closeAction('insert');
                                                                                            closeAction('updateKey');
                                                                closeAction('delete');
                                    });
            $('#' + 'updateKey').click(function() {
            openAction('updateKey');
                                                closeAction('toggleMode');
                                                                closeAction('createNlogN');
                                                                closeAction('createN');
                                                                closeAction('insert');
                                                                closeAction('extractMax');
                                                                                            closeAction('delete');
                                    });
            $('#' + 'delete').click(function() {
            openAction('delete');
                                                closeAction('toggleMode');
                                                                closeAction('createNlogN');
                                                                closeAction('createN');
                                                                closeAction('insert');
                                                                closeAction('extractMax');
                                                                closeAction('updateKey');
                                                                });
    
    //important to have all the input fields in actions menu take an id containing '-input'
    $("[id*='-input']").on("keypress keydown keyup", (event) => {
        event.stopPropagation();
    });
</script>
<script type="text/javascript">
// Heap Widget
// original author: Steven Halim

var limit = 77;
var scale = false;
var Heap = function() {
  var gw = new GraphWidget(false, true);

  /*
   * A: Internal representation of Heap in this object
   * It is a compact 1-based 1-dimensional array (ignoring index 0)
   * The parent/left child/right child can be computed via index manipulation
   *
   * Elements of A are ObjectPair objects, where first element is the value and the second element is the ID of the vertex SVG corresponding to the value
   *
   * Edge IDs are the index of the child element, so for example edge A[1]-A[2] will have ID "e2" (edge 2)
   * The edges will be set to not change when vertexes are interchanged
   * This eliminates the need to maintain an Adjacency Matrix / List
   */

  var coord = new Array();
  var A = new Array();
  var amountVertex = 0;
  var complete_BT = true;
  var arr;

  // initArrayRandom();
  // init();

  var stateList = [];

  this.getGraphWidget = function() { return gw; };

  function parent(i) { return i>>1; } // Math.floor(i/2);

  function left(i) { return i<<1; } // i*2;

  function right(i) { return (i<<1)+1; } // i*2+1;

  this.IsMaxHeap = function(array) {
    for (var i = 1; i < array.length; ++i)
      if (array[parent(i)] < array[i])
        return false;
   return true;
  }

  this.generate = function(array) {
    clearScreen();
    array.unshift(999999);
    A = [];
    for (var i = 0; i < array.length; ++i) {
      A[i] = new ObjectPair(array[i], amountVertex); // testing layout, to leave the edges there for now
      ++amountVertex;
    }
    init();
  };

  this.saveArray = function() {
    arr = new Array();
    for (var i = 0; i < A.length; ++i)
      arr[i] = A[i].getFirst();
    return arr;
  }

  this.restoreArray = function(arr) {
    clearScreen();
    amountVertex = arr.length;
    A = [];
    for (var i = 0; i < amountVertex; ++i)
      A[i] = new ObjectPair(arr[i], i);
    init();
  }

  this.getSize = function() {
    return A.length-1;
  }

  this.shorten = function(l) {
    var magic_len = 40;
    return l.length < magic_len ? l : (l.substring(0, magic_len-3) + '...');
  }

  // function initArrayRandom() {
  this.createRandomMaxHeap = function() {
    A = [];
    amountVertex = 6 + Math.floor(Math.random()*(31-5)); // [6..31]
    A[0] = new ObjectPair(999999, 0);
    arr = new Array();
    for (var i = 1; i < amountVertex; ++i) {
      var newVal = 1 + Math.floor(Math.random()*99); // [1..99]
      // 05 Jun 2023, allow duplicates
      // while ($.inArray(newVal, arr) != -1)
      //   newVal = 1 + Math.floor(Math.random()*99);
      arr.push(newVal);
      A[i] = new ObjectPair(newVal, i);
    }
    this.createN(arr, true, null); // second parameter = true means skip all animations and show the last frame directly
  }

/*
  this.createRandom = function() {
    clearScreen();
    initArrayRandom();
    // init();
    createN(arr, false);
  }
*/

  function init() {
    var i, j;

    // compute vertex coordinates
    var vtx_count = 1; // 1-based indexing
    for (i = 0; i <= 6; ++i) { // we limit our visualization to 4 levels only
      var entriesInThisLevel = 1<<i; // 2^i
      for (j = 0; j < entriesInThisLevel; ++j) {
        coord[vtx_count] = new Array();
        coord[vtx_count][0] = (2*j+1) * MAIN_SVG_WIDTH / (2*entriesInThisLevel); // x Coordinate, 25 May 2023, change 940 back to MAIN_SVG_WIDTH (1000) and remove +35 offset // on 26 Feb change 1000 to 940 to make it more centered and offset by +35 (for mobile)
        coord[vtx_count][1] = 25 + 34*i; // y Coordinate, 25 Feb drop 50 to 25 for mobile and also 40->34
        ++vtx_count;
      }
    }

    for (i = 1; i < A.length; ++i) // add vertices first
      gw.addVertex(coord[i][0], coord[i][1], A[i].getFirst(), A[i].getSecond(), true, i);

    for (i = 2; i < A.length; ++i) { // then add edges, i is edge id
      parentVertex = A[parent(i)].getSecond();
      childVertex = A[i].getSecond();
      gw.addEdge(parentVertex, childVertex, i, EDGE_TYPE_UDE, 1, true);
    }
  }

  function clearScreen() {
    var i;
    for (i = 2; i < A.length; ++i) // remove edges first
      gw.removeEdge(i);
    for (i = 1; i < A.length; ++i) // then afterwards, remove vertices
      gw.removeVertex(A[i].getSecond());
    amountVertex = 0;
    A = []; // destroy old A, create new one
  }

  this.toggleMode = function(mode, callback) {
    populatePseudocode(5); // empty
    stateList = [];

    cs = createState(A);
    cs["status"] = "Before: " + (!mode ? "Complete Binary Tree" : "Compact Array");
    stateList.push(cs);

    complete_BT = mode;

    cs = createState(A);
    cs["status"] = "After: " + (mode ? "Complete Binary Tree" : "Compact Array");
    stateList.push(cs);

    gw.startAnimation(stateList, callback);
    return true;
  }

  this.shiftUp = function(i, startAnimationDirectly, calledFrom = 'insert') {
    while (i > 1 && A[parent(i)].getFirst() < A[i].getFirst()) {
      cs = createState(A);
      cs["vl"][A[i].getSecond()]["state"] = VERTEX_HIGHLIGHTED;
      cs["vl"][A[parent(i)].getSecond()]["state"] = VERTEX_TRAVERSED;
      cs["status"] = A[parent(i)].getFirst() + ' < ' + A[i].getFirst() + ', so swap them.';
      if (calledFrom == 'deletei')
        cs["lineNo"] = 1;
      else if (calledFrom == 'updatekey')
        cs["lineNo"] = 2;
      else
        cs["lineNo"] = 3;
      stateList.push(cs); // before swap

      var temp = A[i];
      A[i] = A[parent(i)];
      A[parent(i)] = temp;
      cs = createState(A);
      cs["vl"][A[i].getSecond()]["state"] = VERTEX_TRAVERSED;
      cs["vl"][A[parent(i)].getSecond()]["state"] = VERTEX_HIGHLIGHTED;
      cs["status"] = A[parent(i)].getFirst() + ' <-> ' + A[i].getFirst() + ' have been swapped.';
      if (calledFrom == 'deletei')
        cs["lineNo"] = 1;
      else if (calledFrom == 'updatekey')
        cs["lineNo"] = 2;
      else if (calledFrom == 'createN')
        cs["lineNo"] = !startAnimationDirectly ? 3 : 4;
      stateList.push(cs); // record the successive vertex swap animation
      i = parent(i);
    }
  }

  this.insert = function(vertexText, startAnimationDirectly, callback) {
    if (A.length > limit) {
      $('#insert-err').html('Sorry, max limit of {limit} has been reached'.replace("{limit}", limit));
      if (typeof callback == 'function') callback();
      return false;
    }

/*
    // actually, it is better to allow duplicates :O
    for (i = 0; i < A.length; ++i)
      if (A[i].getFirst() == parseInt(vertexText)) {
        $('#insert-err').html('Sorry, that integer value is already inside the heap, this visualization can only handle unique integers');
        if (typeof callback == 'function') callback();
        return false;
      }
*/

    if (isNaN(vertexText) || (Math.abs(parseInt(vertexText)) > 99)) {
      $('#insert-err').html('v must be &in; [-99..99]');
      if (typeof callback == 'function') callback();
      return false;
    }

    if (startAnimationDirectly == true) {
      stateList = [];
      populatePseudocode(0);
    }

    var i, key, cs;
    if (A.length > 1) {
      cs = createState(A);
      cs["status"] = "The current Binary Max Heap";
      cs["lineNo"] = !startAnimationDirectly ? 2 : 0;
      stateList.push(cs); // zero-th frame, the starting point
    }

    A[A.length] = new ObjectPair(parseInt(vertexText), amountVertex);
    ++amountVertex;
    i = A.length-1;

    cs = createState(A);
    cs["vl"][A[i].getSecond()]["state"] = VERTEX_HIGHLIGHTED;
    cs["status"] = vertexText + " is inserted at the back of compact array A.";
    cs["lineNo"] = !startAnimationDirectly ? 3 : [1, 2]; // differentiate O(N log N) build vs single insert
    stateList.push(cs); // first frame, highlight the newly inserted vertex

    this.shiftUp(i, startAnimationDirectly);

    cs = createState(A); // record the final state of the heap after insertion to stop the highlights
    //cs["vl"][A[i].getSecond()]["state"] = VERTEX_HIGHLIGHTED; // highlighted the successful insertion, this one wrong
    cs["status"] = vertexText + ' has been inserted successfully.';
    cs["lineNo"] = !startAnimationDirectly ? 3 : 0;
    stateList.push(cs);

    if (startAnimationDirectly) gw.startAnimation(stateList, callback);
    return true;
  }

  this.shiftDown = function(i, calledFrom) {
    while (i < A.length) {
      var maxV = A[i].getFirst(), max_id = i;
      if (left(i) < A.length && maxV < A[left(i)].getFirst()) {
        maxV = A[left(i)].getFirst();
        max_id = left(i);
      }
      if (right(i) < A.length && maxV < A[right(i)].getFirst()) {
        maxV = A[right(i)].getFirst();
        max_id = right(i);
      }

      if (max_id != i) {
        var cs = createState(A);
        cs["vl"][A[i].getSecond()]["state"] = VERTEX_HIGHLIGHTED;
        cs["vl"][A[max_id].getSecond()]["state"] = VERTEX_TRAVERSED;
        cs["status"] = A[i].getFirst() + ' < ' + A[max_id].getFirst() + ', so swap them.';
        if (calledFrom == 'extractmax')
          cs["lineNo"] = [4, 5];
        else if (calledFrom == 'createN')
          cs["lineNo"] = [2, 3];
        else if (calledFrom == 'heapsort' || calledFrom == 'updatekey')
          cs["lineNo"] = 2;
        if (calledFrom != 'createNdonotanimate')
          stateList.push(cs); // deal with affected edges first

        var temp = A[i];
        A[i] = A[max_id];
        A[max_id] = temp;
        cs = createState(A);
        cs["status"] = A[i].getFirst() + ' <-> ' + A[max_id].getFirst() + ' have been swapped.';
        if (calledFrom == 'extractmax')
          cs["lineNo"] = 6;
        else if (calledFrom == 'createN')
          cs["lineNo"] = [2, 3];
        else if (calledFrom == 'heapsort' || calledFrom == 'updatekey')
          cs["lineNo"] = 2;
        if (calledFrom != 'createNdonotanimate')
          stateList.push(cs);

        i = max_id;
      }
      else
        break;
    }
  }

  this.getMax = function() { return A[1].getFirst(); }

  this.extractMax = function(startAnimationDirectly, callback) {
    if (A.length <= 2) {
      $('#extractmax-err').html('Sorry, the Binary Max Heap contains only one item. This is the max item. We cannot delete any more item.');
      if (typeof callback == 'function') callback();
      return false;
    }

    if (startAnimationDirectly == true) {
      stateList = [];
      populatePseudocode(1);
    }

    var cs = createState(A);
    cs["vl"][A[1].getSecond()]["state"] = VERTEX_HIGHLIGHTED;
    cs["status"] = 'Root stores the max item.';
    cs["lineNo"] = !startAnimationDirectly ? 2 : 0; // heapsort vs standard extract
    stateList.push(cs); // highlight the root (max element)

    cs = createState(A);
    delete cs["vl"][A[1].getSecond()];
    var maxitem = A[1].getFirst();
    cs["status"] = 'Take out the root ' + maxitem + '.';
    cs["lineNo"] = !startAnimationDirectly ? 2 : 1;
    stateList.push(cs); // move the root (max element) a bit upwards (to simulate 'extract max')

    if (A.length > 2) {
      cs = createState(A);
      delete cs["vl"][A[1].getSecond()];
      cs["status"] = 'Replace root with the last leaf ' + A[A.length-1].getFirst() + '.';
      cs["vl"][A[A.length-1].getSecond()]["state"] = VERTEX_HIGHLIGHTED; // highlighted the last leaf
      cs["lineNo"] = !startAnimationDirectly ? 2 : [2, 3];
      stateList.push(cs); // delete bottom-most right-most leaf (later, also remove its associated edge)
    }

    if (A.length > 2) {
      A[1] = A[A.length-1];
      A.splice(A.length-1, 1);
      cs = createState(A);
      cs["vl"][A[1].getSecond()]["state"] = VERTEX_HIGHLIGHTED;
      cs["status"] = 'The new root.';
      cs["lineNo"] = !startAnimationDirectly ? 2 : [2, 3];
      stateList.push(cs); // highlight the new root
    }

    this.shiftDown(1, !startAnimationDirectly ? 'heapsort' : 'extractmax');

    cs = createState(A);
    cs["status"] = 'ExtractMax() has been completed<br>We return the max item: ' + maxitem + '.';
    cs["lineNo"] = !startAnimationDirectly ? 1 : 0;
    stateList.push(cs);

    if (startAnimationDirectly) gw.startAnimation(stateList, callback);
    return true;
  }

  this.partialSort = function(k, callback) {
    if (A.length == 2) {
      $('#extractMax-err').html('Sorry, the Binary Max Heap contains only one item. This is the max item. We cannot delete any more item.');
      if (typeof callback == 'function') callback();
      return false;
    }

    if (k >= A.length-1) {
      $('#extractMax-err').html("K must be &lt; N"); // 'Sorry, the Binary Max Heap contains only one item. This is the max item. We cannot delete any more item.');
      if (typeof callback == 'function') callback();
      return false;
    }

    populatePseudocode(6);
    stateList = [];
    var partial = [];
    for (var i = 0; i < k; ++i)
      partial[i] = -1;

    for (var i = 0; i < k; ++i) {
      partial[k-1-i] = A[1].getFirst();
      this.extractMax(false);
      cs = createState(A);
      cs["status"] = 'The partial sorted order is ' + this.shorten(partial.toString()) + '.';
      cs["lineNo"] = 1;
      stateList.push(cs);
    }

    gw.startAnimation(stateList, callback);
    return true;
  }

  this.heapSort = function(callback) {
    if (A.length == 2) {
      $('#extractMax-err').html('Sorry, the Binary Max Heap contains only one item. This is the max item. We cannot delete any more item.');
      if (typeof callback == 'function') callback();
      return false;
    }

    populatePseudocode(2);
    res = []; // copy first
    for (var i = 1; i < A.length; ++i)
      res[i-1] = A[i].getFirst();
    res.sort(function(a, b) { return a-b });

    stateList = [];
    var len = A.length-1;
    var partial = [];
    for (var i = 0; i < len; ++i)
      partial[i] = -1;

    for (var i = 0; i < len-1; ++i) { // except the last item (minor bug if not stopped here)
      partial[len-1-i] = A[1].getFirst();
      this.extractMax(false);
      cs = createState(A);
      cs["status"] = 'The partial sorted order is ' + this.shorten(partial.toString()) + '.';
      cs["lineNo"] = 1;
      stateList.push(cs);
    }

    cs = createState(A);
    cs["status"] = 'The final sorted order is ' + this.shorten(res.toString()) + '.';
    cs["lineNo"] = 0;
    stateList.push(cs);

    gw.startAnimation(stateList, callback);
    return true;
  }

  this.createNlogN = function(arr, callback) {
    if (arr.length > limit) {
      $('#createNlogN-err').html('Sorry, you cannot build a Binary Max Heap with more than {limit} integers in this visualization'.replace("{limit}", limit));
      if (typeof callback == 'function') callback();
      return false;
    }

    populatePseudocode(3);
    clearScreen();
    var i, initValue = [999999, parseInt(arr[0])];
    stateList = [];

    var cs = createState(A);
    cs["status"] = 'Start from an empty Binary Max Heap.';
    cs["lineNo"] = 1;
    stateList.push(cs);

    for (i = 0; i < initValue.length; ++i) {
      A[i] = new ObjectPair(initValue[i], amountVertex);
      ++amountVertex;
    }
    init();

    cs = createState(A);
    cs["status"] = arr[0] + ' is inserted.<br>It becomes the new root.';
    cs["lineNo"] = [2, 3];
    stateList.push(cs);

    for (i = 1; i < arr.length; ++i) // insert one by one
      this.insert(parseInt(arr[i]), false);

    cs = createState(A);
    cs["status"] = 'The Binary Max Heap has been created from array A: ' + this.shorten(arr.toString()) + '.';
    cs["lineNo"] = 0;
    stateList.push(cs);

    gw.startAnimation(stateList, callback);
    return true;
  }

  this.createN = function(arr, skip_animation, callback) {
    if (arr.length > limit) {
      $('#createN-err').html('Sorry, you cannot build a Binary Max Heap with more than {limit} integers in this visualization'.replace("{limit}", limit));
      if (typeof callback == 'function') callback();
      return false;
    }

    populatePseudocode(4);
    clearScreen();
    var i, initValue = [999999];

    for (i = 0; i < arr.length; ++i)
      initValue[i+1] = parseInt(arr[i]);

    for (i = 0; i < initValue.length; ++i) {
      A[i] = new ObjectPair(initValue[i], amountVertex);
      ++amountVertex;
    }
    init();

    stateList = [];
    if (!skip_animation) {
      var cs = createState(A);
      cs["status"] = 'Leave the content of the input array A as it is (a Complete Binary Tree structure).';
      cs["lineNo"] = 1;
      stateList.push(cs);
    }

    for (i = Math.floor(arr.length/2); i >= 1; --i) { // check heap property one by one
      if (!skip_animation) {
        cs = createState(A);
        cs["vl"][A[i].getSecond()]["state"] = VERTEX_HIGHLIGHTED;
        cs["status"] = 'shiftDown(' + i + ') to fix the Binary Max Heap property (if necessary) of sub-tree rooted at index ' + i + ' (value = ' + A[i].getFirst() + ').';
        cs["lineNo"] = [2, 3];
        stateList.push(cs);

        this.shiftDown(i, 'createN');
      }
      else
        this.shiftDown(i, 'createNdonotanimate');
    }

    cs = createState(A);
    cs["status"] = 'The Binary Max Heap has been created from array A: ' + this.shorten(arr.toString()) + '.';
    cs["lineNo"] = 0;
    stateList.push(cs);

    gw.startAnimation(stateList, callback);
    return true;
  }

  this.updateKey = function(idxi, newv, callback) {
    if (idxi < 1 || idxi > A.length) {
      $('#updateKey-err').html("i must be &in; [1.." + A.length + "]");
      if (typeof callback == 'function') callback();
      return false;
    }

    if (newv < -99 || newv > 99) {
      $('#updateKey-err').html("newv must be &in; [-99..99]");
      if (typeof callback == 'function') callback();
      return false;
    }

    stateList = [];
    populatePseudocode(7);

    cs = createState(A);
    cs["status"] = "The current Binary Max Heap";
    stateList.push(cs); // zero-th frame, the starting point

    A[idxi].setFirst(newv); // no change to the second field (index)
    i = idxi;

    cs = createState(A);
    cs["vl"][A[i].getSecond()]["state"] = VERTEX_HIGHLIGHTED;
    cs["status"] = "index " + i + " is updated"; // is inserted at the back of compact array A.";
    cs["lineNo"] = 1; // update this
    stateList.push(cs); // first frame, highlight the newly updated vertex

    // call shiftup(i), will only run if newv > previous old value
    this.shiftUp(i, false, 'updatekey');

    // call shiftdown(i), will only run if newv < previous old value, so only one way will work out
    this.shiftDown(i, 'updatekey');

    gw.startAnimation(stateList, callback);
    return true;
  }

  this.deletei = function(idxi, callback) {
    if (idxi < 1 || idxi > A.length) {
      $('#delete-err').html("i must be &in; [1.." + (A.length-1) + "]");
      if (typeof callback == 'function') callback();
      return false;
    }

    if (A.length <= 1) {
      $('#delete-err').html("there must be more than 1 element in the Binary Heap");
      if (typeof callback == 'function') callback();
      return false;
    }

    stateList = [];
    populatePseudocode(8);

    cs = createState(A);
    cs["status"] = "The current Binary Max Heap";
    stateList.push(cs); // zero-th frame, the starting point

    var oldv = A[idxi].getFirst();

    A[idxi].setFirst(A[1].getFirst()+1); // this will always be 1 greater than the current root, so it will always be the new root
    i = idxi;

    cs = createState(A);
    cs["vl"][A[i].getSecond()]["state"] = VERTEX_HIGHLIGHTED;
    cs["status"] = "index " + i + "'s value is updated to be the new max<br>(the value of the previous root+1)"; // is inserted at the back of compact array A.";
    cs["lineNo"] = 1; // update this
    stateList.push(cs); // first frame, highlight the newly updated vertex

    // call shiftup(i), will only run if newv > previous old value
    this.shiftUp(i, false, 'deletei');

    // extract max once
    this.extractMax(false);

    cs = createState(A);
    cs["status"] = "We have deleted index " + i + " with value " + oldv + "<br>successfully and efficiently";
    stateList.push(cs); // the final frame

    gw.startAnimation(stateList, callback);
    return true;
  }

  function createState(iH) {
    var s = {
      "vl": {},
      "el": {},
    };

    if (complete_BT) {
      for (var i = 1; i < iH.length; ++i) {
        var key = iH[i].getSecond();
        s["vl"][key] = {};
        s["vl"][key]["cx"] = coord[i][0];
        s["vl"][key]["cy"] = coord[i][1];
        s["vl"][key]["text"] = iH[i].getFirst();
        s["vl"][key]["extratext"] = i; // the vertex number
        s["vl"][key]["state"] = VERTEX_DEFAULT;
      }

      for (var i = 2; i < iH.length; ++i) {
        s["el"][i] = {};
        s["el"][i]["vertexA"] = iH[parent(i)].getSecond();
        s["el"][i]["vertexB"] = iH[i].getSecond();
        s["el"][i]["type"] = EDGE_TYPE_UDE;
        s["el"][i]["weight"] = 1;
        s["el"][i]["state"] = EDGE_DEFAULT;
        s["el"][i]["animateHighlighted"] = false;
      }
    }
    else { // compact array
      for (var i = 1; i < iH.length; ++i) {
        var key = iH[i].getSecond();
        s["vl"][key] = {};
        s["vl"][key]["cx"] = (i%16 + 1)*50;
        s["vl"][key]["cy"] = Math.ceil((i+1)/16)*55; // need 55 (from 40) so that the indices not blocked for two rows mode (05 June 2023)
        s["vl"][key]["text"] = iH[i].getFirst();
        s["vl"][key]["extratext"] = i; // the vertex number
        s["vl"][key]["state"] = VERTEX_DEFAULT;
      }

      // no edges in compact array form
    }

    return s;
  }

  function populatePseudocode(act) {
    $('#code4').html('&nbsp;');
    $('#code5').html('&nbsp;');
    $('#code6').html('&nbsp;');
    $('#code7').html('// <b><a href="https://github.com/stevenhalim/cpbook-code/tree/master/ch2/nonlineards" target="_blank">priority_queue.cpp/py/java/ml</a></b>');
    switch (act) {
      case 0: // Insert
        $('#code1').html('A[A.length] = v');
        $('#code2').html('i = A.length-1');
        $('#code3').html('while ((i &gt; 1) &amp;&amp; (A[i] &gt; A[parent(i)]))');
        $('#code4').html('&nbsp&nbspswap(A[i], A[parent(i)]); i = parent(i)');
        break;
      case 1: // ExtractMax
        $('#code1').html('take out A[1]');
        $('#code2').html('A[1] = A[A.length-1]');
        $('#code3').html('i = 1; A.length--');
        $('#code4').html('while (i &lt; A.length)');
        $('#code5').html('&nbsp&nbspif A[i] < (L = the larger of i&#39;s children)');
        $('#code6').html('&nbsp&nbsp&nbsp&nbspswap(A[i], L); i = L&#39;s index');
        break;
      case 2: // HeapSort
        $('#code1').html('for (i = 0; i &lt; A.length; ++i)');
        $('#code2').html('&nbsp&nbspExtractMax()');
        $('#code3').html('&nbsp;');
        break;
      case 3: // Create, O(N log N)
        $('#code1').html('Start from an empty Binary Max Heap');
        $('#code2').html('for (i = 0; i &lt; A.length; ++i)');
        $('#code3').html('&nbsp&nbspInsert(A[i])');
        break;
      case 4: // Create, O(N)
        $('#code1').html('leave the input array A as it is');
        $('#code2').html('for (i = A.length/2; i &gt;= 1; --i)');
        $('#code3').html('&nbsp&nbspshiftDown(i)');
        break;
      case 5: // ToggleMode
        $('#code1').html('// Complete Binary Tree is for visualization');
        $('#code2').html('// Compact Array is the actual implementation');
        $('#code3').html('&nbsp;');
        break;
      case 6: // PartialSort
        $('#code1').html('for (i = 0; i &lt; K; ++i)');
        $('#code2').html('&nbsp&nbspExtractMax()');
        $('#code3').html('&nbsp;');
        break;
      case 7: // UpdateKey(i, newv)
        $('#code1').html('A[i] = newv; // let oldv = A[i]');
        $('#code2').html('shiftup(i); // if newv &gt; oldv');
        $('#code3').html('shiftdown(i); // if newv &lt; oldv');
        break;
      case 8: // Delete(i)
        $('#code1').html('A[i] = A[1]+1; shiftup(i); // new max/root');
        $('#code2').html('ExtractMax(); // now easy to delete');
        $('#code3').html('&nbsp;');
        break;
    }
  }
}



// Heap Actions
var actionsWidth = 150;
var statusCodetraceWidth = 370;

// local
$('#play').hide();
var hw = new Heap(), gw, complete_binary_tree_mode;

$(function() {
  gw = hw.getGraphWidget();
  gw.setAnimationDuration(700 / speedVal);
  complete_binary_tree_mode = true;
  var createHeap = getQueryVariable("create");
  if (createHeap.length > 0) {
    var newHeap = createHeap.split(",");
    if (hw.IsMaxHeap(newHeap)) // the input parameter is already a max heap
      hw.generate(newHeap); // just show
    else {
      $('#arrv2').val(createHeap);
      createN(); // not yet a max heap, build it fast
      stop();
    }
  }
  else
    hw.createRandomMaxHeap();

  $("#n1").val(6 + Math.floor(Math.random() * (limit-5))); // [6..77]
  $("#n2").val(6 + Math.floor(Math.random() * (limit-5))); // [6..77]
  $('#v').val(1 + Math.floor(Math.random()*89)); // never [90..99], to give room for more 2 digits insertion later
  $('#K').val(2 + Math.floor(Math.random()*3)); // [2..4], never 1
  $('#upd_i').val(1 + Math.floor(Math.random()*3)); // [1..3]
  $('#newv').val(1 + Math.floor(Math.random()*89)); // never [90..99]
  $('#del_i').val(2 + Math.floor(Math.random()*3)); // [2..4], never 1
  exploreModeData = hw.saveArray();
});

function toggleMode(callback) {
  complete_binary_tree_mode = !complete_binary_tree_mode;
  var previous_text = $('#toggleMode').text();
  $('#toggleMode').text(complete_binary_tree_mode ? "-> Compact Array Mode" : "-> Binary Tree Mode");
  commonAction(hw.toggleMode(complete_binary_tree_mode, callback), previous_text);
}

function createNlogNWithInput(input, callback) {
  commonAction(hw.createNlogN(input.split(","), callback), "Create(A) - O(N log N):<br>" + hw.shorten(input));
}

function createNlogN(callback) {
  if (isPlaying) stop();
  var input = $('#arrv1').val();
  createNlogNWithInput(input, callback);
}

function createNlogNSampleDes(callback) {
  if (isPlaying) stop();
  var input = "32";
  for (var i = 31; i >= 1; --i)
    input += "," + i.toString();
  setMediumScale(true);
  createNlogNWithInput(input, callback);
}

function createNlogNRandom(callback) {
  if (isPlaying) stop();
  var n = $('#n1').val();
  if (isNaN(n) || (n < 1) || (n > 99)) {
    $('#createNlogN-err').html('N must be &in; [1..99]');
    return;
  }

  if (n <= 31)
    setDefaultScale(true);
  else
    setMediumScale(true);

  var input = new Array();
  while (n > 0) {
    var newVal = 1 + Math.floor(98*Math.random());
    // if ($.inArray(newVal, input) == -1) {
      input.push(newVal);
      --n;
    // }
  }
  input = input.join(",");
  commonAction(hw.createNlogN(input.split(","), callback), "Create(A) - O(N log N):<br>" + hw.shorten(input));
  setTimeout(function() {
    $("#n1").val(6 + Math.floor(Math.random() * (limit-5))); // [6..77]
  }, 500);
}

function createNlogNSampleAsc(callback) {
  if (isPlaying) stop();
  var input = "1";
  for (var i = 2; i <= 32; ++i)
    input += "," + i.toString();
  setMediumScale(true);
  createNlogNWithInput(input, callback);
}

function createNWithInput(input, callback) {
  commonAction(hw.createN(input.split(","), false, callback), "Create(A) - O(N):<br>" + hw.shorten(input));
}

function createN(callback) {
  if (isPlaying) stop();
  var input = $('#arrv2').val();
  createNWithInput(input, callback);
}

function createNSampleDes(callback) {
  if (isPlaying) stop();
  var input = "32";
  for (var i = 31; i >= 1; --i)
    input += "," + i.toString();
  setMediumScale(true);
  createNWithInput(input, callback);
}

function createNRandom(callback) {
  if (isPlaying) stop();
  var n = $('#n2').val();
  if (isNaN(n) || (n < 1) || (n > limit)) {
    $('#createN-err').html('N must be &in; [1..' + limit + ']');
    return;
  }

  if (n <= 31)
    setDefaultScale(true);
  else
    setMediumScale(true);

  var input = new Array();
  while (n > 0) {
    var newVal = 1 + Math.floor(98*Math.random());
    // if ($.inArray(newVal, input) == -1) {
      input.push(newVal);
      --n;
    // }
  }
  input = input.join(",");
  commonAction(hw.createN(input.split(","), false, callback), "Create(A) - O(N):<br>" + hw.shorten(input));
  setTimeout(function() {
    $("#n2").val(6 + Math.floor(Math.random() * (limit-5))); // [6..77]
  }, 500);
}

function createNSampleDiagonal(callback) {
  if (isPlaying) stop();
  // var input = "1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18"; // not the hardest
  // var input = "12,13,5,14,9,6,2,15,11,10,8,7,4,3,1,16"; // hardest for N = 16
  var input = "27,28,12,29,20,13,5,30,24,21,17,14,9,6,2,31,26,25,23,22,19,18,16,15,11,10,8,7,4,3,1,32"; // hardest for N = 32
  setMediumScale(true);
  createNWithInput(input, callback);
}

function insert(callback) {
  if (isPlaying) stop();
  var input = parseInt($("#v").val());
  if (hw.getSize()+1 > 31)
    setMediumScale(true);
  commonAction(hw.insert(input, true, callback), "Insert " + input);
  setTimeout(function() {
    var existing = hw.saveArray();
    var next_num = 1 + Math.floor(Math.random()*88);
    $("#v").val(next_num); // randomized for next click between [1..89), duplicates are allowed
  }, 500);
}

function insert_top(callback) {
  if (isPlaying) stop();
  var input = hw.getMax()+1; // always increase the top value by 1
  commonAction(hw.insert(input, true, callback), "Insert " + input);
  setTimeout(function() { $("#v").val(1 + Math.floor(Math.random()*98)); }, 500); // randomized for next click between [1..99}
}

function extractmax(callback) {
  if (isPlaying) stop();
  if (hw.getSize()-1 <= 31)
    setDefaultScale(true);
  commonAction(hw.extractMax(true, callback), "ExtractMax");
}

function partialsort(callback) {
  if (isPlaying) stop();
  var input = parseInt($("#K").val());
  if (hw.getSize()-Math.min(32,input) <= 31)
    setDefaultScale(true);
  commonAction(hw.partialSort(input, callback), "PartialSort" + ", K = " + input);
  setTimeout(function() {
    var existing = hw.saveArray();
    $("#K").val(1 + Math.floor(Math.random()*(existing.length-1)));
  }, 500);
}

function heapsort(callback) {
  if (isPlaying) stop();
  commonAction(hw.heapSort(callback), "HeapSort");
}

function updatekey(callback) {
  if (isPlaying) stop();
  var idxi = parseInt($("#upd_i").val());
  var newv = parseInt($("#newv").val());
  commonAction(hw.updateKey(idxi, newv, callback), "UpdateKey(" + idxi + ", " + newv + ")");
  setTimeout(function() {
    var existing = hw.saveArray();
    $("#upd_i").val(1 + Math.floor(Math.random()*(existing.length-1)));
    var next_num = 1 + Math.floor(Math.random()*88);
    while (existing.includes(next_num)) next_num = 1 + Math.floor(Math.random()*88);
    $("#newv").val(next_num); // randomized for next click between [1..89}, and it won't exist before (allow for a few more insertion of 90-99, still two digits)
  }, 500);
}

function deletei(callback) {
  if (isPlaying) stop();
  var idxi = parseInt($("#del_i").val());
  if (hw.getSize()-1 <= 31)
    setDefaultScale(true);
  commonAction(hw.deletei(idxi, callback), "Delete(" + idxi + ")");
  setTimeout(function() {
    var existing = hw.saveArray();
    $("#del_i").val(1 + Math.floor(Math.random()*(existing.length-1)));
  }, 500);
}

var exploreModeData = [];

// This function will be called before entering e-Lecture Mode
function ENTER_LECTURE_MODE() {
  exploreModeData = hw.saveArray();
}

// This function will be called before returning to Explore Mode
function ENTER_EXPLORE_MODE() {
  hw.restoreArray(exploreModeData);
}

// Lecture action functions
function CUSTOM_ACTION(action, data, mode) {
  if (action == 'random_insert') {
    hideSlide(function() {
      insert(showSlide);
    });
  }
  else if (action == 'insert_top') {
    hideSlide(function() {
      insert_top(showSlide);
    });
  }
  else if (action == 'extractmax') {
    hideSlide(function() {
      extractmax(showSlide);
    });
  }
  else if (action == 'createN') {
    hideSlide(function() {
      createNWithInput(data, showSlide);
    });
  }
  else if (action == 'createNlogN') {
    hideSlide(function() {
      createNlogNWithInput(data, showSlide);
    });
  }
  else if (action == 'heapsort') {
    hideSlide(function() {
      heapsort(showSlide);
    });
  }
  else if (action == 'partialsort') {
    hideSlide(function() {
      partialsort(showSlide);
    });
  }
}
</script>
</body>

<!-- Mirrored from visualgo.net/en/heap by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 16 Dec 2023 15:17:03 GMT -->
</html>
